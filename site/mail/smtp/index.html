<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Professional penetration testing reference guides for systematic service discovery and exploitation"><meta name=author content="Security Professional"><link href=https://medTrigui.github.io/service-enumeration/mail/smtp/ rel=canonical><link href=../ rel=prev><link href=../imap-pop3/ rel=next><link rel=icon href=../../assets/favicon.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>SMTP - Service Enumeration Cheat Sheets</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#smtp-enumeration-cheat-sheet class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Service Enumeration Cheat Sheets" class="md-header__button md-logo" aria-label="Service Enumeration Cheat Sheets" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Service Enumeration Cheat Sheets </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> SMTP </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=deep-orange aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/medTrigui/service-enumeration title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> medTrigui/service-enumeration </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../quick-start/ class=md-tabs__link> Quick Start </a> </li> <li class=md-tabs__item> <a href=../../database/ class=md-tabs__link> Database Services </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Mail Services </a> </li> <li class=md-tabs__item> <a href=../../network/ class=md-tabs__link> Network Services </a> </li> <li class=md-tabs__item> <a href=../../file/ class=md-tabs__link> File Services </a> </li> <li class=md-tabs__item> <a href=../../resources/tools/ class=md-tabs__link> Resources </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Service Enumeration Cheat Sheets" class="md-nav__button md-logo" aria-label="Service Enumeration Cheat Sheets" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> Service Enumeration Cheat Sheets </label> <div class=md-nav__source> <a href=https://github.com/medTrigui/service-enumeration title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> medTrigui/service-enumeration </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../database/ class=md-nav__link> <span class=md-ellipsis> Database Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Mail Services </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Mail Services </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> SMTP </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> SMTP </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> <nav class=md-nav aria-label=Overview> <ul class=md-nav__list> <li class=md-nav__item> <a href=#key-functions class=md-nav__link> <span class=md-ellipsis> Key Functions </span> </a> </li> <li class=md-nav__item> <a href=#why-smtp-matters-in-pentesting class=md-nav__link> <span class=md-ellipsis> Why SMTP Matters in Pentesting </span> </a> </li> <li class=md-nav__item> <a href=#common-attack-vectors class=md-nav__link> <span class=md-ellipsis> Common Attack Vectors </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ports-protocols class=md-nav__link> <span class=md-ellipsis> Ports &amp; Protocols </span> </a> <nav class=md-nav aria-label="Ports & Protocols"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#protocol-variations class=md-nav__link> <span class=md-ellipsis> Protocol Variations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-discovery class=md-nav__link> <span class=md-ellipsis> Quick Discovery </span> </a> </li> <li class=md-nav__item> <a href=#essential-enumeration-workflow class=md-nav__link> <span class=md-ellipsis> Essential Enumeration Workflow </span> </a> <nav class=md-nav aria-label="Essential Enumeration Workflow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-banner-grabbing class=md-nav__link> <span class=md-ellipsis> 1. Banner Grabbing </span> </a> <nav class=md-nav aria-label="1. Banner Grabbing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manual-banner-collection class=md-nav__link> <span class=md-ellipsis> Manual Banner Collection </span> </a> </li> <li class=md-nav__item> <a href=#automated-banner-analysis class=md-nav__link> <span class=md-ellipsis> Automated Banner Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-command-discovery class=md-nav__link> <span class=md-ellipsis> 2. Command Discovery </span> </a> <nav class=md-nav aria-label="2. Command Discovery"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#supported-command-enumeration class=md-nav__link> <span class=md-ellipsis> Supported Command Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#nmap-command-discovery class=md-nav__link> <span class=md-ellipsis> Nmap Command Discovery </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-user-enumeration class=md-nav__link> <span class=md-ellipsis> 3. User Enumeration </span> </a> <nav class=md-nav aria-label="3. User Enumeration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vrfy-command-verify class=md-nav__link> <span class=md-ellipsis> VRFY Command (Verify) </span> </a> </li> <li class=md-nav__item> <a href=#expn-command-expand class=md-nav__link> <span class=md-ellipsis> EXPN Command (Expand) </span> </a> </li> <li class=md-nav__item> <a href=#rcpt-to-method class=md-nav__link> <span class=md-ellipsis> RCPT TO Method </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-open-relay-testing class=md-nav__link> <span class=md-ellipsis> 4. Open Relay Testing </span> </a> <nav class=md-nav aria-label="4. Open Relay Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-open-relay-test class=md-nav__link> <span class=md-ellipsis> Basic Open Relay Test </span> </a> </li> <li class=md-nav__item> <a href=#advanced-relay-testing class=md-nav__link> <span class=md-ellipsis> Advanced Relay Testing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#manual-interaction-techniques class=md-nav__link> <span class=md-ellipsis> Manual Interaction Techniques </span> </a> <nav class=md-nav aria-label="Manual Interaction Techniques"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#smtp-commands class=md-nav__link> <span class=md-ellipsis> SMTP Commands </span> </a> </li> <li class=md-nav__item> <a href=#user-verification-methods class=md-nav__link> <span class=md-ellipsis> User Verification Methods </span> </a> <nav class=md-nav aria-label="User Verification Methods"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vrfy-method class=md-nav__link> <span class=md-ellipsis> VRFY Method </span> </a> </li> <li class=md-nav__item> <a href=#expn-method class=md-nav__link> <span class=md-ellipsis> EXPN Method </span> </a> </li> <li class=md-nav__item> <a href=#rcpt-to-method_1 class=md-nav__link> <span class=md-ellipsis> RCPT TO Method </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#automated-enumeration class=md-nav__link> <span class=md-ellipsis> Automated Enumeration </span> </a> <nav class=md-nav aria-label="Automated Enumeration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#smtp-user-enum class=md-nav__link> <span class=md-ellipsis> smtp-user-enum </span> </a> </li> <li class=md-nav__item> <a href=#nmap-nse-scripts class=md-nav__link> <span class=md-ellipsis> Nmap NSE Scripts </span> </a> </li> <li class=md-nav__item> <a href=#python-automation-script class=md-nav__link> <span class=md-ellipsis> Python Automation Script </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#authentication-testing class=md-nav__link> <span class=md-ellipsis> Authentication Testing </span> </a> <nav class=md-nav aria-label="Authentication Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#smtp-auth-testing class=md-nav__link> <span class=md-ellipsis> SMTP AUTH Testing </span> </a> </li> <li class=md-nav__item> <a href=#brute-force-authentication class=md-nav__link> <span class=md-ellipsis> Brute Force Authentication </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-techniques class=md-nav__link> <span class=md-ellipsis> Advanced Techniques </span> </a> <nav class=md-nav aria-label="Advanced Techniques"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ssltls-testing class=md-nav__link> <span class=md-ellipsis> SSL/TLS Testing </span> </a> </li> <li class=md-nav__item> <a href=#information-disclosure class=md-nav__link> <span class=md-ellipsis> Information Disclosure </span> </a> </li> <li class=md-nav__item> <a href=#mail-header-injection-testing class=md-nav__link> <span class=md-ellipsis> Mail Header Injection Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-vulnerabilities class=md-nav__link> <span class=md-ellipsis> Common Vulnerabilities </span> </a> <nav class=md-nav aria-label="Common Vulnerabilities"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-enumeration-via-vrfyexpn class=md-nav__link> <span class=md-ellipsis> User Enumeration via VRFY/EXPN </span> </a> </li> <li class=md-nav__item> <a href=#open-mail-relay class=md-nav__link> <span class=md-ellipsis> Open Mail Relay </span> </a> </li> <li class=md-nav__item> <a href=#information-disclosure_1 class=md-nav__link> <span class=md-ellipsis> Information Disclosure </span> </a> </li> <li class=md-nav__item> <a href=#weak-authentication class=md-nav__link> <span class=md-ellipsis> Weak Authentication </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-commands class=md-nav__link> <span class=md-ellipsis> Quick Reference Commands </span> </a> <nav class=md-nav aria-label="Quick Reference Commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery class=md-nav__link> <span class=md-ellipsis> Discovery </span> </a> </li> <li class=md-nav__item> <a href=#user-enumeration class=md-nav__link> <span class=md-ellipsis> User Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#open-relay-testing class=md-nav__link> <span class=md-ellipsis> Open Relay Testing </span> </a> </li> <li class=md-nav__item> <a href=#ssltls-testing_1 class=md-nav__link> <span class=md-ellipsis> SSL/TLS Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-checklist class=md-nav__link> <span class=md-ellipsis> Testing Checklist </span> </a> <nav class=md-nav aria-label="Testing Checklist"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#discovery-detection class=md-nav__link> <span class=md-ellipsis> Discovery &amp; Detection </span> </a> </li> <li class=md-nav__item> <a href=#user-enumeration_1 class=md-nav__link> <span class=md-ellipsis> User Enumeration </span> </a> </li> <li class=md-nav__item> <a href=#configuration-testing class=md-nav__link> <span class=md-ellipsis> Configuration Testing </span> </a> </li> <li class=md-nav__item> <a href=#security-assessment class=md-nav__link> <span class=md-ellipsis> Security Assessment </span> </a> </li> <li class=md-nav__item> <a href=#authentication-testing_1 class=md-nav__link> <span class=md-ellipsis> Authentication Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#critical-security-issues class=md-nav__link> <span class=md-ellipsis> Critical Security Issues </span> </a> <nav class=md-nav aria-label="Critical Security Issues"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-enumeration-vulnerability class=md-nav__link> <span class=md-ellipsis> User Enumeration Vulnerability </span> </a> </li> <li class=md-nav__item> <a href=#open-mail-relay_1 class=md-nav__link> <span class=md-ellipsis> Open Mail Relay </span> </a> </li> <li class=md-nav__item> <a href=#information-disclosure_2 class=md-nav__link> <span class=md-ellipsis> Information Disclosure </span> </a> </li> <li class=md-nav__item> <a href=#weak-authentication_1 class=md-nav__link> <span class=md-ellipsis> Weak Authentication </span> </a> </li> <li class=md-nav__item> <a href=#ssltls-weaknesses class=md-nav__link> <span class=md-ellipsis> SSL/TLS Weaknesses </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-smtp-response-codes class=md-nav__link> <span class=md-ellipsis> Common SMTP Response Codes </span> </a> <nav class=md-nav aria-label="Common SMTP Response Codes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#success-codes class=md-nav__link> <span class=md-ellipsis> Success Codes </span> </a> </li> <li class=md-nav__item> <a href=#error-codes class=md-nav__link> <span class=md-ellipsis> Error Codes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#user-enumeration-wordlists class=md-nav__link> <span class=md-ellipsis> User Enumeration Wordlists </span> </a> <nav class=md-nav aria-label="User Enumeration Wordlists"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-usernames class=md-nav__link> <span class=md-ellipsis> Common Usernames </span> </a> </li> <li class=md-nav__item> <a href=#email-address-formats class=md-nav__link> <span class=md-ellipsis> Email Address Formats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-mail-server-testing class=md-nav__link> <span class=md-ellipsis> Advanced Mail Server Testing </span> </a> <nav class=md-nav aria-label="Advanced Mail Server Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mail-server-fingerprinting class=md-nav__link> <span class=md-ellipsis> Mail Server Fingerprinting </span> </a> </li> <li class=md-nav__item> <a href=#mail-routing-analysis class=md-nav__link> <span class=md-ellipsis> Mail Routing Analysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../imap-pop3/ class=md-nav__link> <span class=md-ellipsis> IMAP/POP3 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../network/ class=md-nav__link> <span class=md-ellipsis> Network Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../file/ class=md-nav__link> <span class=md-ellipsis> File Services </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../resources/tools/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/medTrigui/service-enumeration/edit/main/docs/mail/smtp.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/medTrigui/service-enumeration/raw/main/docs/mail/smtp.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=smtp-enumeration-cheat-sheet>SMTP Enumeration Cheat Sheet<a class=headerlink href=#smtp-enumeration-cheat-sheet title="Permanent link">&para;</a></h1> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#overview>Overview</a></li> <li><a href=#ports--protocols>Ports &amp; Protocols</a></li> <li><a href=#quick-discovery>Quick Discovery</a></li> <li><a href=#essential-enumeration-workflow>Essential Enumeration Workflow</a></li> <li><a href=#1-banner-grabbing>Banner Grabbing</a></li> <li><a href=#2-command-discovery>Command Discovery</a></li> <li><a href=#3-user-enumeration>User Enumeration</a></li> <li><a href=#4-open-relay-testing>Open Relay Testing</a></li> <li><a href=#manual-interaction-techniques>Manual Interaction Techniques</a></li> <li><a href=#smtp-commands>SMTP Commands</a></li> <li><a href=#user-verification-methods>User Verification Methods</a></li> <li><a href=#automated-enumeration>Automated Enumeration</a></li> <li><a href=#authentication-testing>Authentication Testing</a></li> <li><a href=#advanced-techniques>Advanced Techniques</a></li> <li><a href=#common-vulnerabilities>Common Vulnerabilities</a></li> <li><a href=#quick-reference-commands>Quick Reference Commands</a></li> <li><a href=#testing-checklist>Testing Checklist</a></li> <li><a href=#critical-security-issues>Critical Security Issues</a></li> </ol> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p><strong>SMTP (Simple Mail Transfer Protocol)</strong> is the standard protocol for sending emails between mail servers and from clients to servers. SMTP services often reveal extensive information about users, system configuration, and mail infrastructure, making them valuable targets for reconnaissance.</p> <h3 id=key-functions>Key Functions<a class=headerlink href=#key-functions title="Permanent link">&para;</a></h3> <ul> <li><strong>Mail Transfer</strong>: Send emails between mail servers</li> <li><strong>Mail Submission</strong>: Accept emails from clients for delivery</li> <li><strong>User Verification</strong>: Validate email addresses and users</li> <li><strong>Mail Routing</strong>: Forward emails to appropriate destinations</li> </ul> <h3 id=why-smtp-matters-in-pentesting>Why SMTP Matters in Pentesting<a class=headerlink href=#why-smtp-matters-in-pentesting title="Permanent link">&para;</a></h3> <ul> <li><strong>User Enumeration</strong>: VRFY and EXPN commands reveal valid users</li> <li><strong>Information Disclosure</strong>: Banners expose software versions and configuration</li> <li><strong>Open Relay Detection</strong>: Misconfigured servers allow mail abuse</li> <li><strong>Authentication Testing</strong>: Weak credentials for mail submission</li> <li><strong>Network Mapping</strong>: Mail server topology and routing information</li> </ul> <h3 id=common-attack-vectors>Common Attack Vectors<a class=headerlink href=#common-attack-vectors title="Permanent link">&para;</a></h3> <ul> <li><strong>User Enumeration</strong>: VRFY, EXPN, RCPT TO commands</li> <li><strong>Banner Grabbing</strong>: Version and software disclosure</li> <li><strong>Open Relay Abuse</strong>: Unauthorized mail sending</li> <li><strong>Authentication Attacks</strong>: Brute force mail submission</li> <li><strong>Information Gathering</strong>: Mail server configuration exposure</li> </ul> <hr> <h2 id=ports-protocols>Ports &amp; Protocols<a class=headerlink href=#ports-protocols title="Permanent link">&para;</a></h2> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>25/tcp   - SMTP (Simple Mail Transfer Protocol)
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>465/tcp  - SMTPS (SMTP over SSL/TLS - deprecated)
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>587/tcp  - SMTP Submission (STARTTLS preferred)
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>2525/tcp - Alternative SMTP (non-standard)
</span></code></pre></div> <h3 id=protocol-variations>Protocol Variations<a class=headerlink href=#protocol-variations title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Port</th> <th>Protocol</th> <th>Purpose</th> <th>Security</th> </tr> </thead> <tbody> <tr> <td><strong>25</strong></td> <td>SMTP</td> <td>Mail transfer between servers</td> <td>Usually plaintext</td> </tr> <tr> <td><strong>465</strong></td> <td>SMTPS</td> <td>SSL/TLS encrypted (deprecated)</td> <td>Encrypted</td> </tr> <tr> <td><strong>587</strong></td> <td>SMTP Submission</td> <td>Client mail submission</td> <td>STARTTLS</td> </tr> </tbody> </table> <hr> <h2 id=quick-discovery>Quick Discovery<a class=headerlink href=#quick-discovery title="Permanent link">&para;</a></h2> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Port scan for SMTP services</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,465,587,2525<span class=w> </span>--open<span class=w> </span>-sV<span class=w> </span>target
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># SMTP-specific scripts</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,465,587<span class=w> </span>--script<span class=o>=</span>smtp-enum-users,smtp-commands,smtp-open-relay<span class=w> </span>target
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1># Banner grabbing</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>telnet<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <hr> <h2 id=essential-enumeration-workflow>Essential Enumeration Workflow<a class=headerlink href=#essential-enumeration-workflow title="Permanent link">&para;</a></h2> <h3 id=1-banner-grabbing>1. Banner Grabbing<a class=headerlink href=#1-banner-grabbing title="Permanent link">&para;</a></h3> <h4 id=manual-banner-collection>Manual Banner Collection<a class=headerlink href=#manual-banner-collection title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Netcat connection</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>nc<span class=w> </span>-nv<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1># Telnet connection</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>telnet<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1># SSL/TLS connections</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:465
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:587<span class=w> </span>-starttls<span class=w> </span>smtp
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=c1># Look for information disclosure in banners:</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=c1># 220 mail.example.com ESMTP Postfix (Ubuntu)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=c1># 220 mail.company.com Microsoft ESMTP MAIL Service ready</span>
</span></code></pre></div> <h4 id=automated-banner-analysis>Automated Banner Analysis<a class=headerlink href=#automated-banner-analysis title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Nmap banner grabbing</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,465,587<span class=w> </span>-sV<span class=w> </span>--script<span class=o>=</span>banner<span class=w> </span>target
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># Service version detection</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>-sV<span class=w> </span>target
</span></code></pre></div> <h3 id=2-command-discovery>2. Command Discovery<a class=headerlink href=#2-command-discovery title="Permanent link">&para;</a></h3> <h4 id=supported-command-enumeration>Supported Command Enumeration<a class=headerlink href=#supported-command-enumeration title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Manual command discovery</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EHLO test.com&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;HELP&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1># Look for available commands:</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># 250-VRFY</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># 250-EXPN</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=c1># 250-AUTH LOGIN PLAIN</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=c1># 250-STARTTLS</span>
</span></code></pre></div> <h4 id=nmap-command-discovery>Nmap Command Discovery<a class=headerlink href=#nmap-command-discovery title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># SMTP commands script</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>--script<span class=o>=</span>smtp-commands<span class=w> </span>target
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Authentication methods</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,587<span class=w> </span>--script<span class=o>=</span>smtp-auth-methods<span class=w> </span>target
</span></code></pre></div> <h3 id=3-user-enumeration>3. User Enumeration<a class=headerlink href=#3-user-enumeration title="Permanent link">&para;</a></h3> <h4 id=vrfy-command-verify>VRFY Command (Verify)<a class=headerlink href=#vrfy-command-verify title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Manual VRFY testing</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY root&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY admin&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY user&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=c1># Automated VRFY enumeration</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=k>for</span><span class=w> </span>user<span class=w> </span><span class=k>in</span><span class=w> </span>root<span class=w> </span>admin<span class=w> </span>user<span class=w> </span>guest<span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY </span><span class=nv>$user</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=k>done</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=c1># Response analysis:</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=c1># 250 2.1.5 root &lt;root@target.com&gt;     # User exists</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=c1># 550 5.1.1 No such user               # User doesn&#39;t exist</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=c1># 252 2.1.5 Cannot verify user         # Inconclusive</span>
</span></code></pre></div> <h4 id=expn-command-expand>EXPN Command (Expand)<a class=headerlink href=#expn-command-expand title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Manual EXPN testing</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN root&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN admin&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1># Test common mailing lists</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN all&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN everyone&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <h4 id=rcpt-to-method>RCPT TO Method<a class=headerlink href=#rcpt-to-method title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># User enumeration via RCPT TO</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;test@test.com&gt;\nRCPT TO:&lt;root@target.com&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># Response analysis:</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=c1># 250 2.1.5 root@target.com... Recipient ok    # User exists</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=c1># 550 5.1.1 root@target.com... User unknown    # User doesn&#39;t exist</span>
</span></code></pre></div> <h3 id=4-open-relay-testing>4. Open Relay Testing<a class=headerlink href=#4-open-relay-testing title="Permanent link">&para;</a></h3> <h4 id=basic-open-relay-test>Basic Open Relay Test<a class=headerlink href=#basic-open-relay-test title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Test external to external relay</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;attacker@external.com&gt;\nRCPT TO:&lt;victim@external.com&gt;\nDATA\nSubject: Relay Test\n\nThis is a relay test.\n.\nQUIT&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=c1># Response analysis:</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1># 250 Message accepted for delivery     # VULNERABLE: Open relay</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=c1># 554 Relay access denied              # Protected against relay</span>
</span></code></pre></div> <h4 id=advanced-relay-testing>Advanced Relay Testing<a class=headerlink href=#advanced-relay-testing title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Multiple relay test scenarios</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=c1># Local to external</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;MAIL FROM:&lt;local@target.com&gt;\nRCPT TO:&lt;external@test.com&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1># External to local</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;MAIL FROM:&lt;external@test.com&gt;\nRCPT TO:&lt;local@target.com&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=c1># Localhost variations</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;MAIL FROM:&lt;test@localhost&gt;\nRCPT TO:&lt;external@test.com&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <hr> <h2 id=manual-interaction-techniques>Manual Interaction Techniques<a class=headerlink href=#manual-interaction-techniques title="Permanent link">&para;</a></h2> <h3 id=smtp-commands>SMTP Commands<a class=headerlink href=#smtp-commands title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Complete SMTP session example</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>telnet<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=m>220</span><span class=w> </span>mail.target.com<span class=w> </span>ESMTP<span class=w> </span>ready
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>EHLO<span class=w> </span>attacker.com
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=m>250</span>-mail.target.com<span class=w> </span>Hello<span class=w> </span>attacker.com
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=m>250</span>-SIZE<span class=w> </span><span class=m>10240000</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=m>250</span>-VRFY
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=m>250</span>-ETRN
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=m>250</span>-ENHANCEDSTATUSCODES
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=m>250</span><span class=w> </span>8BITMIME
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>  </span>VRFY<span class=w> </span>root
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=m>250</span><span class=w> </span><span class=m>2</span>.1.5<span class=w> </span>root<span class=w> </span>&lt;root@target.com&gt;
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>VRFY<span class=w> </span>admin
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=m>550</span><span class=w> </span><span class=m>5</span>.1.1<span class=w> </span>admin...<span class=w> </span>User<span class=w> </span>unknown
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>QUIT
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=m>221</span><span class=w> </span><span class=m>2</span>.0.0<span class=w> </span>Bye
</span></code></pre></div> <h3 id=user-verification-methods>User Verification Methods<a class=headerlink href=#user-verification-methods title="Permanent link">&para;</a></h3> <h4 id=vrfy-method>VRFY Method<a class=headerlink href=#vrfy-method title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Systematic user enumeration</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=nv>users</span><span class=o>=(</span><span class=s2>&quot;root&quot;</span><span class=w> </span><span class=s2>&quot;admin&quot;</span><span class=w> </span><span class=s2>&quot;administrator&quot;</span><span class=w> </span><span class=s2>&quot;user&quot;</span><span class=w> </span><span class=s2>&quot;guest&quot;</span><span class=w> </span><span class=s2>&quot;mail&quot;</span><span class=w> </span><span class=s2>&quot;postmaster&quot;</span><span class=w> </span><span class=s2>&quot;www-data&quot;</span><span class=w> </span><span class=s2>&quot;apache&quot;</span><span class=w> </span><span class=s2>&quot;nginx&quot;</span><span class=o>)</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=k>for</span><span class=w> </span>user<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>users</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY </span><span class=nv>$user</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span><span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s2>&quot;250|550&quot;</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=k>done</span>
</span></code></pre></div> <h4 id=expn-method>EXPN Method<a class=headerlink href=#expn-method title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># Mailing list expansion</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=nv>lists</span><span class=o>=(</span><span class=s2>&quot;all&quot;</span><span class=w> </span><span class=s2>&quot;everyone&quot;</span><span class=w> </span><span class=s2>&quot;staff&quot;</span><span class=w> </span><span class=s2>&quot;users&quot;</span><span class=w> </span><span class=s2>&quot;admin&quot;</span><span class=w> </span><span class=s2>&quot;root&quot;</span><span class=o>)</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>for</span><span class=w> </span>list<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>lists</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN </span><span class=nv>$list</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=k>done</span>
</span></code></pre></div> <h4 id=rcpt-to-method_1>RCPT TO Method<a class=headerlink href=#rcpt-to-method_1 title="Permanent link">&para;</a></h4> <div class="language-bash highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Email address validation</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=nv>domains</span><span class=o>=(</span><span class=s2>&quot;target.com&quot;</span><span class=w> </span><span class=s2>&quot;localhost&quot;</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=o>)</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=k>for</span><span class=w> </span>domain<span class=w> </span><span class=k>in</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>domains</span><span class=p>[@]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;test@test.com&gt;\nRCPT TO:&lt;root@</span><span class=nv>$domain</span><span class=s2>&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=k>done</span>
</span></code></pre></div> <hr> <h2 id=automated-enumeration>Automated Enumeration<a class=headerlink href=#automated-enumeration title="Permanent link">&para;</a></h2> <h3 id=smtp-user-enum>smtp-user-enum<a class=headerlink href=#smtp-user-enum title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># Install smtp-user-enum</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=c1># apt-get install smtp-user-enum</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=c1># VRFY method enumeration</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>smtp-user-enum<span class=w> </span>-M<span class=w> </span>VRFY<span class=w> </span>-U<span class=w> </span>users.txt<span class=w> </span>-t<span class=w> </span>target
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=c1># EXPN method enumeration</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>smtp-user-enum<span class=w> </span>-M<span class=w> </span>EXPN<span class=w> </span>-U<span class=w> </span>users.txt<span class=w> </span>-t<span class=w> </span>target
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=c1># RCPT method enumeration</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>smtp-user-enum<span class=w> </span>-M<span class=w> </span>RCPT<span class=w> </span>-U<span class=w> </span>users.txt<span class=w> </span>-t<span class=w> </span>target
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=c1># Specify custom port</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>smtp-user-enum<span class=w> </span>-M<span class=w> </span>VRFY<span class=w> </span>-U<span class=w> </span>users.txt<span class=w> </span>-t<span class=w> </span>target<span class=w> </span>-p<span class=w> </span><span class=m>587</span>
</span></code></pre></div> <h3 id=nmap-nse-scripts>Nmap NSE Scripts<a class=headerlink href=#nmap-nse-scripts title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># User enumeration script</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>--script<span class=o>=</span>smtp-enum-users<span class=w> </span>--script-args<span class=w> </span>smtp-enum-users.methods<span class=o>={</span>VRFY,EXPN,RCPT<span class=o>}</span><span class=w> </span>target
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=c1># Open relay detection</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>--script<span class=o>=</span>smtp-open-relay<span class=w> </span>target
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=c1># SMTP commands discovery</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>--script<span class=o>=</span>smtp-commands<span class=w> </span>target
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=c1># NTLM information disclosure</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,587<span class=w> </span>--script<span class=o>=</span>smtp-ntlm-info<span class=w> </span>target
</span></code></pre></div> <h3 id=python-automation-script>Python Automation Script<a class=headerlink href=#python-automation-script title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=ch>#!/usr/bin/env python3</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kn>import</span><span class=w> </span><span class=nn>socket</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>import</span><span class=w> </span><span class=nn>sys</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=k>def</span><span class=w> </span><span class=nf>smtp_vrfy</span><span class=p>(</span><span class=n>target</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>users</span><span class=p>):</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=k>for</span> <span class=n>user</span> <span class=ow>in</span> <span class=n>users</span><span class=p>:</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>            <span class=n>s</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>            <span class=n>s</span><span class=o>.</span><span class=n>settimeout</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>            <span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>target</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>            <span class=n>banner</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Banner: </span><span class=si>{</span><span class=n>banner</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>            <span class=n>s</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;VRFY </span><span class=si>{</span><span class=n>user</span><span class=si>}</span><span class=se>\r\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>            <span class=k>if</span> <span class=s2>&quot;250&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[+] User exists: </span><span class=si>{</span><span class=n>user</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>            <span class=k>elif</span> <span class=s2>&quot;550&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[-] User not found: </span><span class=si>{</span><span class=n>user</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[?] Uncertain: </span><span class=si>{</span><span class=n>user</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>        <span class=k>except</span><span class=p>:</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;[!] Error connecting to </span><span class=si>{</span><span class=n>target</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=c1># Usage</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=n>users</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;root&quot;</span><span class=p>,</span> <span class=s2>&quot;admin&quot;</span><span class=p>,</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span> <span class=s2>&quot;guest&quot;</span><span class=p>,</span> <span class=s2>&quot;postmaster&quot;</span><span class=p>]</span>
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=n>smtp_vrfy</span><span class=p>(</span><span class=s2>&quot;target&quot;</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=n>users</span><span class=p>)</span>
</span></code></pre></div> <hr> <h2 id=authentication-testing>Authentication Testing<a class=headerlink href=#authentication-testing title="Permanent link">&para;</a></h2> <h3 id=smtp-auth-testing>SMTP AUTH Testing<a class=headerlink href=#smtp-auth-testing title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># Check for authentication methods</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EHLO test.com&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>587</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=c1># Look for AUTH methods:</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=c1># 250-AUTH LOGIN PLAIN CRAM-MD5</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=c1># Manual authentication testing</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nAUTH LOGIN\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=s1>&#39;username&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=s1>&#39;password&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>587</span>
</span></code></pre></div> <h3 id=brute-force-authentication>Brute Force Authentication<a class=headerlink href=#brute-force-authentication title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Hydra SMTP brute force</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>hydra<span class=w> </span>-L<span class=w> </span>users.txt<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>smtp://target:587
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c1># Medusa SMTP brute force</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>medusa<span class=w> </span>-h<span class=w> </span>target<span class=w> </span>-u<span class=w> </span>admin<span class=w> </span>-P<span class=w> </span>passwords.txt<span class=w> </span>-M<span class=w> </span>smtp<span class=w> </span>-n<span class=w> </span><span class=m>587</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=c1># Custom authentication testing</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=k>for</span><span class=w> </span>user<span class=w> </span><span class=k>in</span><span class=w> </span>admin<span class=w> </span>user<span class=w> </span>root<span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=k>for</span><span class=w> </span>pass<span class=w> </span><span class=k>in</span><span class=w> </span>password<span class=w> </span>admin<span class=w> </span><span class=m>123456</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Testing </span><span class=nv>$user</span><span class=s2>:</span><span class=nv>$pass</span><span class=s2>&quot;</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nAUTH LOGIN\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=nv>$user</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=nv>$pass</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>587</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>    </span><span class=k>done</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=k>done</span>
</span></code></pre></div> <hr> <h2 id=advanced-techniques>Advanced Techniques<a class=headerlink href=#advanced-techniques title="Permanent link">&para;</a></h2> <h3 id=ssltls-testing>SSL/TLS Testing<a class=headerlink href=#ssltls-testing title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># SMTPS (port 465) connection</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:465
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=c1># STARTTLS (port 587) connection</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:587<span class=w> </span>-starttls<span class=w> </span>smtp
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=c1># Cipher enumeration</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a>nmap<span class=w> </span>--script<span class=w> </span>ssl-enum-ciphers<span class=w> </span>-p<span class=w> </span><span class=m>465</span>,587<span class=w> </span>target
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=c1># Certificate analysis</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=nb>echo</span><span class=w> </span><span class=p>|</span><span class=w> </span>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:465<span class=w> </span><span class=m>2</span>&gt;/dev/null<span class=w> </span><span class=p>|</span><span class=w> </span>openssl<span class=w> </span>x509<span class=w> </span>-noout<span class=w> </span>-text
</span></code></pre></div> <h3 id=information-disclosure>Information Disclosure<a class=headerlink href=#information-disclosure title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Extract detailed banner information</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EHLO test.com&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span><span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-E<span class=w> </span><span class=s2>&quot;220|250&quot;</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=c1># Check for information leakage</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;HELP&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=c1># Test for verbose error messages</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;INVALID_COMMAND&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <h3 id=mail-header-injection-testing>Mail Header Injection Testing<a class=headerlink href=#mail-header-injection-testing title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># Test for header injection vulnerabilities</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;test@test.com&gt;\nRCPT TO:&lt;user@target.com&gt;\nDATA\nSubject: Test\nCc: admin@target.com\n\nTest message\n.\nQUIT&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <hr> <h2 id=common-vulnerabilities>Common Vulnerabilities<a class=headerlink href=#common-vulnerabilities title="Permanent link">&para;</a></h2> <h3 id=user-enumeration-via-vrfyexpn>User Enumeration via VRFY/EXPN<a class=headerlink href=#user-enumeration-via-vrfyexpn title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1># VULNERABILITY: VRFY command enabled</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY root&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=c1># Response: 250 2.1.5 root &lt;root@target.com&gt;</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=c1># VULNERABILITY: EXPN command enabled</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN admin&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=c1># Response: 250 2.1.5 admin &lt;admin@target.com&gt;</span>
</span></code></pre></div> <h3 id=open-mail-relay>Open Mail Relay<a class=headerlink href=#open-mail-relay title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># VULNERABILITY: Open relay configuration</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;attacker@external.com&gt;\nRCPT TO:&lt;victim@external.com&gt;\nDATA\nRelay test\n.\nQUIT&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=c1># Response: 250 Message accepted for delivery</span>
</span></code></pre></div> <h3 id=information-disclosure_1>Information Disclosure<a class=headerlink href=#information-disclosure_1 title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1># VULNERABILITY: Verbose banner information</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=c1># Response: 220 mail.company.com ESMTP Postfix (Ubuntu) ready</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=c1># VULNERABILITY: Software version exposure</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EHLO test.com&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=c1># Response: 250-mail.company.com Hello, I am glad to meet you</span>
</span></code></pre></div> <h3 id=weak-authentication>Weak Authentication<a class=headerlink href=#weak-authentication title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># VULNERABILITY: Weak or default credentials</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nAUTH LOGIN\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=s1>&#39;admin&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>\n</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=s1>&#39;admin&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>base64<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>587</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=c1># Response: 235 2.7.0 Authentication successful</span>
</span></code></pre></div> <hr> <h2 id=quick-reference-commands>Quick Reference Commands<a class=headerlink href=#quick-reference-commands title="Permanent link">&para;</a></h2> <h3 id=discovery>Discovery<a class=headerlink href=#discovery title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span>,465,587<span class=w> </span>--script<span class=o>=</span>smtp-enum-users,smtp-commands<span class=w> </span>target
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>smtp-user-enum<span class=w> </span>-M<span class=w> </span>VRFY<span class=w> </span>-U<span class=w> </span>users.txt<span class=w> </span>-t<span class=w> </span>target
</span></code></pre></div> <h3 id=user-enumeration>User Enumeration<a class=headerlink href=#user-enumeration title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;VRFY root&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EXPN admin&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test\nMAIL FROM:&lt;test@test.com&gt;\nRCPT TO:&lt;user@target.com&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <h3 id=open-relay-testing>Open Relay Testing<a class=headerlink href=#open-relay-testing title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;ext@test.com&gt;\nRCPT TO:&lt;ext2@test.com&gt;\nDATA\nRelay test\n.\nQUIT&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span></code></pre></div> <h3 id=ssltls-testing_1>SSL/TLS Testing<a class=headerlink href=#ssltls-testing_1 title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:465
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>target:587<span class=w> </span>-starttls<span class=w> </span>smtp
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>nmap<span class=w> </span>--script<span class=w> </span>ssl-enum-ciphers<span class=w> </span>-p<span class=w> </span><span class=m>465</span>,587<span class=w> </span>target
</span></code></pre></div> <hr> <h2 id=testing-checklist>Testing Checklist<a class=headerlink href=#testing-checklist title="Permanent link">&para;</a></h2> <h4 id=discovery-detection>Discovery &amp; Detection<a class=headerlink href=#discovery-detection title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Port 25/465/587 open and responding</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SMTP service banner analysis</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Supported command enumeration</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SSL/TLS configuration assessment</li> </ul> <h4 id=user-enumeration_1>User Enumeration<a class=headerlink href=#user-enumeration_1 title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> VRFY command availability and testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> EXPN command functionality</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> RCPT TO method user validation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Automated user enumeration</li> </ul> <h4 id=configuration-testing>Configuration Testing<a class=headerlink href=#configuration-testing title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Open relay detection</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Authentication method identification</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> STARTTLS support verification</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Mail routing analysis</li> </ul> <h4 id=security-assessment>Security Assessment<a class=headerlink href=#security-assessment title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Banner information disclosure</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> User enumeration vulnerabilities</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Authentication mechanism strength</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SSL/TLS cipher analysis</li> </ul> <h4 id=authentication-testing_1>Authentication Testing<a class=headerlink href=#authentication-testing_1 title="Permanent link">&para;</a></h4> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Default credential testing</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> SMTP AUTH brute force</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Weak password identification</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Account lockout testing</li> </ul> <hr> <h2 id=critical-security-issues>Critical Security Issues<a class=headerlink href=#critical-security-issues title="Permanent link">&para;</a></h2> <h3 id=user-enumeration-vulnerability>User Enumeration Vulnerability<a class=headerlink href=#user-enumeration-vulnerability title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: User account discovery, reconnaissance data</li> <li><strong>Detection</strong>: Successful VRFY/EXPN commands</li> <li><strong>Exploitation</strong>: <code>echo "VRFY root" | nc target 25</code></li> </ul> <h3 id=open-mail-relay_1>Open Mail Relay<a class=headerlink href=#open-mail-relay_1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Mail abuse, reputation damage, blacklisting</li> <li><strong>Detection</strong>: Successful external-to-external mail relay</li> <li><strong>Exploitation</strong>: Spam distribution, phishing campaigns</li> </ul> <h3 id=information-disclosure_2>Information Disclosure<a class=headerlink href=#information-disclosure_2 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Software fingerprinting, version identification</li> <li><strong>Detection</strong>: Verbose banners, detailed error messages</li> <li><strong>Exploitation</strong>: Version-specific attack identification</li> </ul> <h3 id=weak-authentication_1>Weak Authentication<a class=headerlink href=#weak-authentication_1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Unauthorized mail access, account compromise</li> <li><strong>Detection</strong>: Successful authentication with weak credentials</li> <li><strong>Exploitation</strong>: Mail access, credential harvesting</li> </ul> <h3 id=ssltls-weaknesses>SSL/TLS Weaknesses<a class=headerlink href=#ssltls-weaknesses title="Permanent link">&para;</a></h3> <ul> <li><strong>Impact</strong>: Man-in-the-middle attacks, credential interception</li> <li><strong>Detection</strong>: Weak ciphers, outdated TLS versions</li> <li><strong>Exploitation</strong>: Traffic interception, credential theft</li> </ul> <hr> <h2 id=common-smtp-response-codes>Common SMTP Response Codes<a class=headerlink href=#common-smtp-response-codes title="Permanent link">&para;</a></h2> <h3 id=success-codes>Success Codes<a class=headerlink href=#success-codes title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>220 - Service ready
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>250 - Requested action completed
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>251 - User not local; will forward
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>252 - Cannot verify user; will attempt delivery
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>354 - Start mail input
</span></code></pre></div> <h3 id=error-codes>Error Codes<a class=headerlink href=#error-codes title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>421 - Service not available
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>450 - Mailbox unavailable (temporary)
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>550 - Mailbox unavailable (permanent)
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>551 - User not local
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>552 - Exceeded storage allocation
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>553 - Mailbox name not allowed
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>554 - Transaction failed
</span></code></pre></div> <hr> <h2 id=user-enumeration-wordlists>User Enumeration Wordlists<a class=headerlink href=#user-enumeration-wordlists title="Permanent link">&para;</a></h2> <h3 id=common-usernames>Common Usernames<a class=headerlink href=#common-usernames title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>root
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>admin
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>administrator
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>user
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>guest
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>postmaster
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>webmaster
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>mail
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>nobody
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>www-data
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>apache
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>nginx
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>ftp
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>ssh
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>test
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>demo
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>service
</span></code></pre></div> <h3 id=email-address-formats>Email Address Formats<a class=headerlink href=#email-address-formats title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>username@domain.com
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>username@localhost
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>username@target
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>admin@target.com
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>root@target.com
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>postmaster@target.com
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>webmaster@target.com
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>info@target.com
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>support@target.com
</span></code></pre></div> <hr> <h2 id=advanced-mail-server-testing>Advanced Mail Server Testing<a class=headerlink href=#advanced-mail-server-testing title="Permanent link">&para;</a></h2> <h3 id=mail-server-fingerprinting>Mail Server Fingerprinting<a class=headerlink href=#mail-server-fingerprinting title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=c1># Identify mail server software</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;EHLO test.com&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span><span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;postfix\|sendmail\|exchange\|exim&quot;</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=c1># Version detection</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>nmap<span class=w> </span>-p<span class=w> </span><span class=m>25</span><span class=w> </span>-sV<span class=w> </span>--script<span class=o>=</span>smtp-vuln-*<span class=w> </span>target
</span></code></pre></div> <h3 id=mail-routing-analysis>Mail Routing Analysis<a class=headerlink href=#mail-routing-analysis title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=c1># Trace mail routing</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;EHLO test.com\nMAIL FROM:&lt;test@test.com&gt;\nRCPT TO:&lt;user@target.com&gt;\nDATA\nReceived: trace\n.\nQUIT&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=c1># Multiple domain testing</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=k>for</span><span class=w> </span>domain<span class=w> </span><span class=k>in</span><span class=w> </span>target.com<span class=w> </span>localhost<span class=w> </span><span class=m>127</span>.0.0.1<span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;RCPT TO:&lt;test@</span><span class=nv>$domain</span><span class=s2>&gt;&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>target<span class=w> </span><span class=m>25</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=k>done</span>
</span></code></pre></div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Overview </div> </div> </a> <a href=../imap-pop3/ class="md-footer__link md-footer__link--next" aria-label="Next: IMAP/POP3"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> IMAP/POP3 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 - Service Enumeration Cheat Sheets </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/medTrigui target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://twitter.com/yourusername target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://linkedin.com/in/mo-trigui target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.50899def.min.js></script> </body> </html>